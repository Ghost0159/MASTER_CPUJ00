<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
<HEAD>
<META http-equiv="Content-Type" content="text/html; charset=Shift_JIS">
<META name="GENERATOR" content="IBM WebSphere Studio Homepage Builder Version 7.0.0.0 for Windows">
<META http-equiv="Content-Style-Type" content="text/css">
<TITLE>NITRO-SDK CHANGELOG OLD VERSION</TITLE>
</HEAD>
<BODY>
<HR>
<H1>過去の NITRO-SDK 変更履歴</H1>
<HR>
<DL>
  <DT><A href="changelog.html">→ 最近の変更履歴</A>
</DL>

<DL>
  <DT><A href="#sdk_2_01">■NITRO-SDK 2.1 正式版</A> (2005/05/09)
  <DD><A href="#note26-01">Note 26-01: (CARD) カードアクセス用DMAチャンネルの正当性判定追加</A>
  <DD><A href="#note26-02">Note 26-02: (DevEnv) 浮動小数点ライブラリ指定オプションの追加</A>
  <DD><A href="#note26-03">Note 26-03: (FS) FINALROMバージョンのオーバーレイ関数の内部修正</A>
  <DD><A href="#note26-04">Note 26-04: (MB) サンプルデモの追加</A>
  <DD><A href="#note26-05">Note 26-05: (OS) 拡張言語コードの追加</A>
  <DD><A href="#note26-06">Note 26-06: (SND) インストのリリース無効化機能の追加</A>
  <DD><A href="#note26-07">Note 26-07: (WBT) サンプルデモの修正</A>
  <DD><A href="#note26-08">Note 26-08: (WM) サンプルデモの修正</A>
  <DD><A href="#KnownIssues_2_01">SDK 2.1 正式版での既知の問題点</A>
</DL>
<DL>
  <DT><A href="#sdk_2_01_rc">■NITRO-SDK 2.1 RC</A> (2005/04/21)
  <DD><A href="#note25-01">Note 25-01: (CARD) CARD_Init関数で作成されるスレッドに関する記述の追加</A>
  <DD><A href="#note25-02">Note 25-02: (CTRDG) カートリッジデバイス抜け検出関数の追加</A>
  <DD><A href="#note25-03">Note 25-03: (CTRDG) カートリッジバスのロックと抜け検出処理に関するリファレンスの説明追加</A>
  <DD><A href="#note25-04">Note 25-04: (CTRDG) カートリッジ状態に関するリファレンスの記述修正</A>
  <DD><A href="#note25-05">Note 25-05: (DevEnv) メモリマップの変更(DTCMのアドレス変更)</A>
  <DD><A href="#note25-06">Note 25-06: (FS) 割り込みに関する正当性判定の強化</A>
  <DD><A href="#note25-07">Note 25-07: (GX) G3_FrustumW関数の修正</A>
  <DD><A href="#note25-08">Note 25-08: (MATH) クイックソート関数の追加</A>
  <DD><A href="#note25-09">Note 25-09: (MATH) checksum, CRC の計算関数の追加</A>
  <DD><A href="#note25-10">Note 25-10: (MIC) mic-2サンプルデモの修正</A>
  <DD><A href="#note25-11">Note 25-11: (MB) MB_Init関数のTGIDを自動生成するオプションの追加</A>
  <DD><A href="#note25-12">Note 25-12: (MB) 各種ワイヤレス駆動パラメータ設定関数の追加</A>
  <DD><A href="#note25-13">Note 25-13: (MB) MBP サンプルデモの修正</A>
  <DD><A href="#note25-14">Note 25-14: (OS) ランチャースレッドのスタックチェック処理修正</A>
  <DD><A href="#note25-15">Note 25-15: (OS) OS_Sleep関数の内部動作修正</A>
  <DD><A href="#note25-16">Note 25-16: (OS) キャッシュフラッシュ関数の内部動作の修正</A>
  <DD><A href="#note25-17">Note 25-17: (OS) サンプルデモの修正</A>
  <DD><A href="#note25-18">Note 25-18: (OS) 書式文字列関数のリファレンス訂正</A>
  <DD><A href="#note25-19">Note 25-19: (OS) 拡張言語コードの暫定対応</A>
  <DD><A href="#note25-20">Note 25-20: (SND) サウンドライブラリ配布の一元化</A>
  <DD><A href="#note25-21">Note 25-21: (SND) SND_PrepareSeq関数およびSND_StartPreparedSeq関数の追加</A>
  <DD><A href="#note25-22">Note 25-22: (WM) 内部動作の変更</A>
  <DD><A href="#note25-23">Note 25-23: (WM) TGIDを自動生成する関数の追加</A>
  <DD><A href="#KnownIssues_2_01_rc">SDK 2.1 RCでの既知の問題点</A>
</DL>
<DL>
  <DT><A href="#sdk_2_01_pr">■NITRO-SDK 2.1 PR</A> (2005/04/07)
  <DD><A href="#note24-01">Note 24-01: (CARD) CARDRomHeader 構造体の追加</A>
  <DD><A href="#note24-02">Note 24-02: (CARD) CARD_IdentifyBackup 関数の内部チェック追加</A>
  <DD><A href="#note24-03">Note 24-03: (CARD) ROMの種類を明示的に指定するサンプルデモの追加</A>
  <DD><A href="#note24-04">Note 24-04: (DevEnv) ワンタイムPROMビルドオプションのサポート</A>
  <DD><A href="#note24-05">Note 24-05: (DevEnv) SDKバージョンのフォーマット変更</A>
  <DD><A href="#note24-06">Note 24-06: (GX) G3_GetDLSize 関数の不具合修正</A>
  <DD><A href="#note24-07">Note 24-07: (MATH) メッセージダイジェスト値の計算関数の追加</A>
  <DD><A href="#note24-08">Note 24-08: (MB) MB_GetGameEntryBitmap 関数の追加</A>
  <DD><A href="#note24-09">Note 24-09: (OS) OS_ResetSystem 関数のカードロック内部処理修正</A>
  <DD><A href="#note24-10">Note 24-10: (OS) キャッシュフラッシュ関数の内部実装変更</A>
  <DD><A href="#note24-11">Note 24-11: (OS) サンプルデモの修正</A>
  <DD><A href="#note24-12">Note 24-12: (RTC) 日付書き込み関数の不具合修正</A>
  <DD><A href="#note24-13">Note 24-13: (Snd) サウンドドライバ情報取得関数追加</A>
  <DD><A href="#note24-14">Note 24-14: (Snd) SND_FlushCommand 関数のフラグ SND_COMMAND_IMMEDIATE 追加</A>
  <DD><A href="#note24-15">Note 24-15: (Snd) SNDInstType に SND_INST_NULL 追加</A>
  <DD><A href="#note24-16">Note 24-16: (WM) 「ワイヤレス通信ライブラリ解説」の更新</A>
  <DD><A href="#note24-17">Note 24-17: (WM) 切断タイミングによる不具合の修正</A>
  <DD><A href="#note24-18">Note 24-18: (WM) WM_StartScanEx関数の不具合修正</A>
  <DD><A href="#note24-19">Note 24-19: (WM) 切断処理に関する不具合の修正</A>
  <DD><A href="#note24-20">Note 24-20: (WM) DS ワイヤレスプレイで WEP Key を使用するデモの追加</A>
  <DD><A href="#KnownIssues_2_01_pr">SDK 2.1 PRでの既知の問題点</A>
</DL>
<DL>
  <DT><A href="#sdk_2_00">■NITRO-SDK 2.0 正式版</A> (2005/03/11)
  <DD><A href="#note23-01">Note 23-01: (CTRDG) カートリッジ状態に関するリファレンスへの記述追加</A>
  <DD><A href="#note23-02">Note 23-02: (DevEnv) ソースコードの書式統一</A>
  <DD><A href="#note23-03">Note 23-03: (DevEnv) ビルド済みDSプログラムのリファレンス追加</A>
  <DD><A href="#note23-04">Note 23-04: (DevEnv) 関数リファレンスでの引数範囲の明記</A>
  <DD><A href="#note23-05">Note 23-05: (DevEnv) 弱いシンボルの宣言用マクロ SDK_WEAK_SYMBOL を定義</A>
  <DD><A href="#note23-06">Note 23-06: (FS) 圧縮オーバーレイのロード時の不具合の修正</A>
  <DD><A href="#note23-07">Note 23-07: (MI) データ圧縮時のアラインメント調整オプションの追加</A>
  <DD><A href="#note23-08">Note 23-08: (PRC) 関数内部での正当性判定の修正</A>
  <DD><A href="#note23-09">Note 23-09: (PRC) 関数の返り値の型の変更</A>
  <DD><A href="#note23-10">Note 23-10: (WM) 切断タイミングによる不具合の修正</A>
  <DD><A href="#note23-11">Note 23-11: (WM) WM_StartMPEx 関数の minPollBmpMode を使用した場合の不具合修正</A>
  <DD><A href="#note23-12">Note 23-12: (WM) 通信内容が消えてしまう不具合の修正</A>
  <DD><A href="#note23-13">Note 23-13: (WM) port 通信用送信キューの段数の変更</A>
  <DD><A href="#note23-14">Note 23-14: (WM) WMPortSendCallback 構造体の変更</A>
  <DD><A href="#note23-15">Note 23-15: (WM) 状態チェックの修正と強化</A>
  <DD><A href="#note23-16">Note 23-16: (WM) WM_EndKeySharing 関数の返り値修正</A>
  <DD><A href="#note23-17">Note 23-17: (WM) WH サンプルデモの修正</A>
  <DD><A href="#KnownIssues_2_00">SDK 2.0 正式版での既知の問題点</A>
</DL>
<DL>
  <DT><A href="#sdk_2_00_rc5">■NITRO-SDK 2.0 RC5</A> (2005/02/25)
  <DD><A href="#note22-01">Note 22-01: (ARM7) コンポーネントの追加と廃止</A>
  <DD><A href="#note22-02">Note 22-02: (CHT) サンプルデモの修正</A>
  <DD><A href="#note22-03">Note 22-03: (DevEnv) 厳格な警告オプションへ対応するソースコード修正</A>
  <DD><A href="#note22-04">Note 22-04: (FS) overlay-staticinit サンプルデモの追加</A>
  <DD><A href="#note22-05">Note 22-05: (FS) アーカイブのサスペンド状態に関する内部異常の修正</A>
  <DD><A href="#note22-06">Note 22-06: (FS) FS_LoadOverlayImage 関数の内部エラー判定修正</A>
  <DD><A href="#note22-07">Note 22-07: (GX) GX_GetOBJVRamModeBmp 関数の返り値の型訂正</A>
  <DD><A href="#note22-08">Note 22-08: (GX) GXBg23ControlAffine 構造体の無効なメンバの削除</A>
  <DD><A href="#note22-09">Note 22-09: (GX) G2_GetBG3Control* 関数, G2S_GetBG3Control 関数の不具合修正</A>
  <DD><A href="#note22-10">Note 22-10: (GX) VRAM割り当てを試行する関数群の追加</A>
  <DD><A href="#note22-11">Note 22-11: (MATH) code32.h による MATH_CountLeadingZeros 関数の inline への切り替えの不具合修正</A>
  <DD><A href="#note22-12">Note 22-12: (MB) DSダウンロードプレイ親機のビーコンへユーザデータを設定するインターフェイスの追加</A>
  <DD><A href="#note22-13">Note 22-13: (MI) 圧縮関数の追加</A>
  <DD><A href="#note22-14">Note 22-14: (MI) AGBカートリッジ用のROMアクセスサイクル設定関数の追加</A>
  <DD><A href="#note22-15">Note 22-15: (MI) 起動時の多重DMAの不具合への対処</A>
  <DD><A href="#note22-16">Note 22-16: (MIC) 自動サンプリングエンジンの最適化</A>
  <DD><A href="#note22-17">Note 22-17: (OS) 割り込み概要ページへのリンク追加</A>
  <DD><A href="#note22-18">Note 22-18: (OS) スレッドのスケジューリング制御関数の追加</A>
  <DD><A href="#note22-19">Note 22-19: (OS) キャッシュのロックダウン関数の不具合修正</A>
  <DD><A href="#note22-20">Note 22-20: (OS) ロックダウンされたキャッシュの解放関数の追加</A>
  <DD><A href="#note22-21">Note 22-21: (OS) OS_ResetSystem 関数でのリセット時キャッシュ不具合の修正</A>
  <DD><A href="#note22-22">Note 22-22: (OS) OS_GetITCMAddress 関数の追加</A>
  <DD><A href="#note22-23">Note 22-23: (PM) LCDオフ状態からスリープモードに移行したあとの復帰処理の変更</A>
  <DD><A href="#note22-24">Note 22-24: (SND) サウンドライブラリの更新</A>
  <DD><A href="#note22-25">Note 22-25: (WM) Sequential 通信におけるパケット複製の不具合修正</A>
  <DD><A href="#note22-26">Note 22-26: (WM) minPollBmpMode 時の Sequential 通信における制限事項の明記</A>
  <DD><A href="#note22-27">Note 22-27: (WM) WM_PortSendCallback 構造体 restBitmap メンバに関する不具合修正</A>
  <DD><A href="#note22-28">Note 22-28: (WM) WM_Reset 関数に関する不具合修正</A>
  <DD><A href="#note22-29">Note 22-29: (WM) WM_IsBssidEqual 関数, WM_CopyBssid 関数の動作修正と16bit版の追加</A>
  <DD><A href="#note22-30">Note 22-30: (WM) WM非同期関数のコールバックと途中通知の順番についての注意書きの追加</A>
  <DD><A href="#note22-31">Note 22-31: (WM) 再送時に完了コールバックが来なくなる不具合の修正</A>
  <DD><A href="#note22-32">Note 22-32: (WM) WH サンプルデモの不具合修正</A>
  <DD><A href="#note22-33">Note 22-33: (WM) WFS サンプルデモの不具合修正</A>
  <DD><A href="#note22-34">Note 22-34: (WM) 新規関数の追加</A>
  <DD><A href="#note22-35">Note 22-35: (WM) MP通信開始時の内部動作の改善</A>
  <DD><A href="#note22-36">Note 22-36: (WM) 親機開始時の内部動作の不具合修正</A>
  <DD><A href="#note22-37">Note 22-37: (WM) WM_SetMPData* 関数のコールバックに関する変更</A>
  <DD><A href="#note22-38">Note 22-38: (WM) 接続許容台数の上限付近での新規接続時の不具合修正</A>
  <DD><A href="#note22-39">Note 22-39: (WM) 解説ドキュメントの正式公開</A>
  <DD><A href="#note22-40">Note 22-40: (WVR) 無線ドライバ駆動制御ライブラリの追加</A>
  <DD><A href="#KnownIssues_2_00_rc5">SDK 2.0 RC5 での既知の問題点</A>
</DL>
<DL>
  <DT><A href="#sdk_2_00_rc4">■NITRO-SDK 2.0 RC4</A> (2005/01/14)
  <DD><A href="#note21-01">Note 21-01: (CHT) ピクトチャット関連ライブラリの追加</A>
  <DD><A href="#note21-02">Note 21-02: (MATH) MATH カテゴリの新設</A>
  <DD><A href="#note21-03">Note 21-03: (MATH) 乱数用関数の追加</A>
  <DD><A href="#note21-04">Note 21-04: (MB) 擬似 DS ダウンロードプレイ子機の不具合修正</A>
  <DD><A href="#note21-05">Note 21-05: (MB) MBライブラリ終了時の内部スレッド不具合の修正</A>
  <DD><A href="#note21-06">Note 21-06: (MB) MBライブラリ終了時の内部動作修正</A>
  <DD><A href="#note21-07">Note 21-07: (MB) エントリー子機に対し随時データの先行配信するデモを追加</A>
  <DD><A href="#note21-08">Note 21-08: (WM) 無線ライブラリへの機能追加</A>
  <DD><A href="#note21-09">Note 21-09: (WM) WM非同期関数群へのより厳密な排他制御の追加</A>
  <DD><A href="#note21-10">Note 21-10: (WM) MP 通信のパワーマネージメント設定の修正</A>
  <DD><A href="#note21-11">Note 21-11: (WM) WFSサンプルの改善</A>
  <DD><A href="#note21-12">Note 21-12: (WM) 親機の使用するチャンネルを決定するデモの修正</A>
  <DD><A href="#note21-13">Note 21-13: (FS) ファイルシステムドキュメントの更新</A>
  <DD><A href="#note21-14">Note 21-14: (GX) 描画用レジスタのリード関数を追加</A>
  <DD><A href="#note21-15">Note 21-15: (GX) サブ2Dエンジン用ビットマップOBJのVRAM拡張フラグの定義を削除</A>
  <DD><A href="#note21-16">Note 21-16: (GX) データサイズによる転送方法の判別</A>
  <DD><A href="#note21-17">Note 21-17: (GX) GX_SetBankForBGEx使用時のASSERTの不具合修正</A>
  <DD><A href="#note21-18">Note 21-18: (GX) GX_ResetCapture関数を追加</A>
  <DD><A href="#note21-19">Note 21-19: (CARD,CTRDG) 強制停止処理の改良</A>
  <DD><A href="#note21-20">Note 21-20: (CARD) CARD_ReadRomID関数の廃止</A>
  <DD><A href="#note21-21">Note 21-21: (CARD) NITRO-CARDアクセス許可状態の設定関数の追加</A>
  <DD><A href="#note21-22">Note 21-22: (TP) TP_GetLatestRawPointInAuto関数の動作を修正</A>
  <DD><A href="#note21-23">Note 21-23: (TP) タッチパネルがLCDから受けるノイズへの対策を強化</A>
  <DD><A href="#note21-24">Note 21-24: (MIC) 自動サンプリング中にサンプリングレートを調整するAPIの追加</A>
  <DD><A href="#note21-25">Note 21-25: (OS) アプリケーション向けの割り込みチェックフラグの追加(再掲)</A>
  <DD><A href="#note21-26">Note 21-26: (OS) OS_DestroyThread() 関数の追加</A>
  <DD><A href="#note21-27">Note 21-27: (OS) OSデモ interrupt-key-1 の廃止と WaitIrq-2 の変更</A>
  <DD><A href="#note21-28">Note 21-28: (OS) OS_EnableMainExArena(), OS_DisableMainExArena() の追加</A>
  <DD><A href="#note21-29">Note 21-29: (OS) OS_DisableWriteBufferForProtectionRegion() の修正</A>
  <DD><A href="#note21-30">Note 21-30: (OS) ヒープ関数の追加と変更</A>
  <DD><A href="#note21-31">Note 21-31: (MI) 圧縮データのストリーミング展開</A>
  <DD><A href="#note21-32">Note 21-32: (MI) MI_SendGXCommandAsync*() の不具合修正</A>
  <DD><A href="#note21-33">Note 21-33: (MI) 多重DMAの不具合への対処</A>
  <DD><A href="#note21-34">Note 21-34: (PXI) PXI 初期化処理の変更</A>
  <DD><A href="#note21-35">Note 21-35: (DevEnv) makerom にクローンブート用のサイズチェックオプション追加</A>
  <DD><A href="#note21-36">Note 21-36: (DevEnv) ドキュメント形式の統一</A>
  <DD><A href="#note21-37">Note 21-37: (DEMO) tips/MyBuildMessage デモの追加</A>
  <DD><A href="#note21-38">Note 21-38: (TOOL) emuchildの出力ファイルを省サイズ化</A>
  <DD><A href="#note21-39">Note 21-39: (SND) サウンドライブラリの更新</A>
  <DD><A href="#KnownIssues_2_00_rc4">SDK 2.0 RC4 での既知の問題点</A>
</DL>
<DL>
  <DT><A href="#sdk_2_00_rc3">■NITRO-SDK 2.0 RC3</A> (2004/11/29)
  <DD><A href="#note20-01">Note 20-01: (MB) 擬似DSダウンロードプレイ子機機能の追加</A>
  <DD><A href="#note20-02">Note 20-02: (MB) MB_GetParentSystemBufSize( ) 関数の不具合修正</A>
  <DD><A href="#note20-03">Note 20-03: (MB) MB_ReadSegment( ) 関数の機能拡張</A>
  <DD><A href="#note20-04">Note 20-04: (MB) MB_StartParentEx( ) / MB_EndEx( ) 関数の名称変更</A>
  <DD><A href="#note20-05">Note 20-05: (MB) MB_DisconnectChild( ) の追加</A>
  <DD><A href="#note20-06">Note 20-06: (MB) 親機受信バッファサイズ変更の廃止</A>
  <DD><A href="#note20-07">Note 20-07: (MB) クローンブートサンプルの追加</A>
  <DD><A href="#note20-08">Note 20-08: (MB) multiboot-Model 親機への再接続時のリトライ不具合の修正</A>
  <DD><A href="#note20-09">Note 20-09: (MB) DSダウンロードプレイに関するドキュメントを追加</A>
  <DD><A href="#note20-10">Note 20-10: (WM) ARM7 側無線ライブラリの修正</A>
  <DD><A href="#note20-11">Note 20-11: (WM) MP 通信のライフタイムの導入</A>
  <DD><A href="#note20-12">Note 20-12: (WM) 「ワイヤレス通信チュートリアル」の追加</A>
  <DD><A href="#note20-13">Note 20-13: (FS) FS_LoadOverlayImageAsync( ) 関数の追加</A>
  <DD><A href="#note20-14">Note 20-14: (FS) FS_RegisterOverlayToDebugger( ) 関数の廃止</A>
  <DD><A href="#note20-15">Note 20-15: (GX) GX_GetVCountEqVal( ) 関数の追加、および他の VCOUNT 一致割り込み関連 API の名称変更</A>
  <DD><A href="#note20-16">Note 20-16: (GX) GX_SetBankForBGEx( ) 関数の追加</A>
  <DD><A href="#note20-17">Note 20-17: (CARD) カード抜け後処理関数 CARD_TerminateForPulledOut() の変更</A>
  <DD><A href="#note20-18">Note 20-18: (MI) 差分フィルタの復元関数を追加</A>
  <DD><A href="#note20-19">Note 20-19: (MI) 起動時専用のメモリクリア処理関数の追加</A>
  <DD><A href="#note20-20">Note 20-20: (OS) VAlarmについての不具合修正</A>
  <DD><A href="#note20-21">Note 20-21: (OS) デバッグ関数の weak シンボル化</A>
  <DD><A href="#note20-22">Note 20-22: (SND) SND_InvalidateWaveData( ) で関係ない発音が止まる不具合を修正</A>
  <DD><A href="#note20-23">Note 20-23: (MIC) MIC_GetLastSamplingAddress( ) が正確なアドレスを返さない不具合の修正</A>
  <DD><A href="#note20-24">Note 20-24: (PRC) 識別子名の変更</A>
  <DD><A href="#note20-25">Note 20-25: (WM) WM_SetMPDataToPort*( ) の引数チェックの強化</A>
  <DD><A href="#KnownIssues_2_00_rc3">SDK 2.0 RC3 での既知の問題点</A>
</DL>
<DL>
  <DT><A href="#sdk_2_00_rc2">■NITRO-SDK 2.0 RC2</A> (2004/11/04)
  <DD><A href="#note19-01">Note 19-01: (WM) WM_GetAllowedChannel( ) でのエラー発生時の返値の変更</A>
  <DD><A href="#note19-02">Note 19-02: (WM) WM_End ライブラリ終了関数の仕様を一部変更</A>
  <DD><A href="#note19-03">Note 19-03: (WM) WMDisconnectCallback 構造体の新設</A>
  <DD><A href="#note19-04">Note 19-04: (WM) WM_Reset( ) 関数の初期化動作の修正</A>
  <DD><A href="#note19-05">Note 19-05: (WM) データシェアリング終了時の処理の修正</A>
  <DD><A href="#note19-06">Note 19-06: (WM) データシェアリングにおけるデータサイズ上限変更</A>
  <DD><A href="#note19-07">Note 19-07: (MB) MBUserInfoのnameLengthが無効となる不具合を修正</A>
  <DD><A href="#note19-08">Note 19-08: (MB) MB_StartParentEx関数, MB_EndEx関数の追加</A>
  <DD><A href="#note19-09">Note 19-09: (MB) MB_UnregisterFile関数のリファレンスに注意事項を追加</A>
  <DD><A href="#note19-10">Note 19-10: (MB) チャンネル電波使用率を検出するデモを追加</A>
  <DD><A href="#note19-11">Note 19-11: (MB) multiboot デモにおける tgid 値の設定手法の変更</A>
  <DD><A href="#note19-12">Note 19-12: (MB) MB_End ライブラリ終了関数の仕様を一部変更</A>
  <DD><A href="#note19-13">Note 19-13: (WBT) wbt-fs サンプルデモの通信切断時エラー処理の修正</A>
  <DD><A href="#note19-14">Note 19-14: (WBT) wbt-fs サンプルデモの修正</A>
  <DD><A href="#note19-15">Note 19-15: (WBT) WBTライブラリの修正</A>
  <DD><A href="#note19-16">Note 19-16: (FS) FS_RegisterOverlayToDebugger関数の追加</A>
  <DD><A href="#note19-17">Note 19-17: (OS) Vカウントよるアラーム処理の変更</A>
  <DD><A href="#note19-18">Note 19-18: (OS) オーナー情報「お気に入りの色」取得関数の追加</A>
  <DD><A href="#note19-19">Note 19-19: (OS) 関数コスト計測プロファイラの修正</A>
  <DD><A href="#note19-20">Note 19-20: (OS) OS_SetTick() の修正</A>
  <DD><A href="#note19-21">Note 19-21: (OS) OS_ResetSystem() の修正</A>
  <DD><A href="#note19-22">Note 19-22: (OS) DTCM へのデータセクション転送処理の修正</A>
  <DD><A href="#note19-23">Note 19-23: (CARD) CARD_GetRomHeader 関数の追加</A>
  <DD><A href="#note19-24">Note 19-24: (CARD) CARDアクセス時の自動起動DMAチェック処理修正</A>
  <DD><A href="#note19-25">Note 19-25: (ARM7) ferret へのカードとカートリッジ抜き検出機能の追加</A>
  <DD><A href="#note19-26">Note 19-26: (PM) スリープ復帰時のLCD状態の修正</A>
  <DD><A href="#note19-27">Note 19-27: (MI) DMA 時のアドレスチェック処理の修正</A>
  <DD><A href="#note19-28">Note 19-28: (MI) MI_DmaFill*() の修正</A>
  <DD><A href="#note19-29">Note 19-29: (GX) G3X_IsLineBufferOverflow( ), G3X_ResetLineBufferOverflow( ) の改名</A>
  <DD><A href="#note19-30">Note 19-30: (GX) レジスタの定義誤りの修正</A>
  <DD><A href="#note19-31">Note 19-31: (GX) G3X_InitTableのテーブルクリア不具合の修正</A>
  <DD><A href="#note19-32">Note 19-32: (SND) サウンドライブラリの更新</A>
  <DD><A href="#note19-33">Note 19-33: (CTRDG) CTRDG_IsNumberID()、CTRDG_IsBitID() のリファレンス追加</A>
  <DD><A href="#note19-34">Note 19-34: (DevEnv) IPL GUI 版 mb_child, 無線接続チェック用ツール WMTestTool の収録</A>
  <DD><A href="#KnownIssues_2_00_rc2">SDK 2.0 RC2 での既知の問題点</A>
</DL>
<DL>
  <DT><A href="#sdk_2_00_rc1">■NITRO-SDK 2.0 RC1</A> (2004/10/07)
  <DD><A href="#note18-01">Note 18-01: (WM) WM ライブラリの変更</A>
  <DD><A href="#note18-02">Note 18-02: (MB) mb_child.srl プログラムが最大文字数処理で停止する問題の修正</A>
  <DD><A href="#note18-03">Note 18-03: (MB) multiboot-Model デモのダウンロードシーケンス変更</A>
  <DD><A href="#note18-04">Note 18-04: (MB) mb_child.srl プログラムの表示文字を英語へ変更</A>
  <DD><A href="#note18-05">Note 18-05: (WBT) WBT_CancelCurrentCommand( ) 関数の追加</A>
  <DD><A href="#note18-06">Note 18-06: (DEMO) WM デモ ball の警告対処</A>
  <DD><A href="#note18-07">Note 18-07: (DEMO) multiboot デモのユーザ名処理の変更</A>
  <DD><A href="#note18-08">Note 18-08: (DevEnv) NITRO-SDK のバージョンの表示ツールの収録</A>
  <DD><A href="#note18-09">Note 18-09: (DevEnv) バナー表示ツールの最終版の収録</A>
  <DD><A href="#note18-10">Note 18-10: (DevEnv) lsf ファイルの常駐領域名称の記述とモジュール圧縮処理のリンク</A>
  <DD><A href="#note18-11">Note 18-11: (OS) メインメモリ用プロテクションリージョン設定の変更</A>
  <DD><A href="#note18-12">Note 18-12: (OS) リセット時のサウンド停止処理</A>
  <DD><A href="#note18-13">Note 18-13: (OS) OS_CreateThread( ) の修正</A>
  <DD><A href="#note18-14">Note 18-14: (OS) 関数トレースプロファイラの修正</A>
  <DD><A href="#note18-15">Note 18-15: (PM) LCD 切り替え関数 PM_SetLCDPower( ) の修正</A>
  <DD><A href="#note18-16">Note 18-16: (PM) スリープ時の残像を避ける修正</A>
  <DD><A href="#note18-17">Note 18-17: (PM) スリープ時の IRQ マスク復帰処理の修正</A>
  <DD><A href="#note18-18">Note 18-18: (PM) スリープ時のコールバック呼び出し処理の追加</A>
  <DD><A href="#note18-19">Note 18-19: (CARD) 複数回のカード初期化呼び出し処理の修正</A>
  <DD><A href="#note18-20">Note 18-20: (CTRDG) カートリッジ関数の追加</A>
  <DD><A href="#note18-21">Note 18-21: (RTC) RTC アラーム監視方式の変更</A>
  <DD><A href="#note18-22">Note 18-22: (RTC) 日付と曜日の整合性に関する修正</A>
  <DD><A href="#note18-23">Note 18-23: (GX) クリアデプスイメージ単体でのクリアイメージの使用を追加。</A>
  <DD><A href="#KnownIssues_2_00_rc1">SDK 2.0 RC1 での既知の問題点</A>
</DL>
<DL>
  <DT><A href="#sdk_2_00_fc">■NITRO-SDK 2.0 FC</A> (2004/09/30)
  <DD><A href="#note17-01">Note 17-01: (WBT) 無線ブロック転送ライブラリの正式公開</A>
  <DD><A href="#note17-02">Note 17-02: (WM/TP) 無線処理によってタッチパネルのオートサンプリングが停止する不具合の修正</A>
  <DD><A href="#note17-03">Note 17-03: (WM) WMライブラリの変更</A>
  <DD><A href="#note17-04">Note 17-04: (DEMO) multiboot-Model デモの修正</A>
  <DD><A href="#note17-05">Note 17-05: (DevEnv) makebanner ツールの修正</A>
  <DD><A href="#note17-06">Note 17-06: (DevEnv) LIBSYSCALL 処理の修正、および libsyscall.a の格納位置の変更</A>
  <DD><A href="#note17-07">Note 17-07: (DevEnv) NITRO_COMPRESS におけるオーバーレイの圧縮処理修正</A>
  <DD><A href="#note17-08">Note 17-08: (DevEnv) バナーファイルのフォントセットの変更</A>
  <DD><A href="#note17-09">Note 17-09: (DevEnv) ROM スペックファイルにおけるバナーファイルの位置制限と対策</A>
  <DD><A href="#note17-10">Note 17-10: (GX)レジスタの定義不具合の修正</A>
  <DD><A href="#note17-11">Note 17-11: (MI) MI_SendGXCommandAsyncFast の修正</A>
  <DD><A href="#note17-12">Note 17-12: (MI) MI_SendGXCommand() の修正</A>
  <DD><A href="#note17-13">Note 17-13: (FS) FS_GetPathName()呼び出し時の不具合修正</A>
  <DD><A href="#note17-14">Note 17-14: (OS) OS_Init() で呼ばれる初期化関数の追加</A>
  <DD><A href="#note17-15">Note 17-15: (CARD) カード抜き検出処理の変更</A>
  <DD><A href="#note17-16">Note 17-16: (TP) validity条件の変更</A>
  <DD><A href="#KnownIssues_2_00_fc">SDK 2.0 FC での既知の問題点</A>
  <DD><A href="#Information_2_00_fc">SDK 2.0 FC での追加情報</A>
</DL>

<DL>
  <DT><A href="#sdk_2_00_pr7">■NITRO-SDK 2.0 PR7</A> (2004/09/21)
  <DD><A href="#note16-01">Note 16-01: (WM) WMライブラリの変更</A>
  <DD><A href="#note16-02">Note 16-02: (FS) 圧縮されたオーバーレイのロード時の不具合修正</A>
  <DD><A href="#note16-03">Note 16-03: (CTRDG) カートリッジ抜き検出APIの作成</A>
  <DD><A href="#note16-04">Note 16-04: (CARD) カード抜き検出APIの作成</A>
  <DD><A href="#note16-05">Note 16-05: (GX) G3Cでのディスプレイリスト生成時の不具合修正</A>
  <DD><A href="#note16-06">Note 16-06: (OS) RTC 割り込みの処理</A>
  <DD><A href="#note16-07">Note 16-07: (MIC) 自動サンプリング開始関数のI/F変更</A>
  <DD><A href="#note16-08">Note 16-08: (SND) サウンドライブラリの更新</A>
  <DD><A href="#note16-09">Note 16-09: (DevEnv) バナーファイルのテストビューア生成ツールの収録</A>
  <DD><A href="#note16-10">Note 16-10: (DEMO) 最終 ROM 作成のデモの追加</A>
  <DD><A href="#KnownIssues_2_00_pr7">SDK 2.0 PR7 での既知の問題点</A>
</DL>
<DL>
  <DT><A href="#sdk_2_00_pr6">■NITRO-SDK 2.0 PR6</A> (2004/09/13)
  <DD><A href="#note15-01">Note 15-01: (OS) 本体情報を取得する関数の追加</A>
  <DD><A href="#note15-02">Note 15-02: (OS) ソフトリセットの実装</A>
  <DD><A href="#note15-03">Note 15-03: (OS) メモリ割り当てシステムを破棄する OS_ClearAlloc() の追加</A>
  <DD><A href="#note15-04">Note 15-04: (OS) アラームセット時のエラー表示の変更</A>
  <DD><A href="#note15-05">Note 15-05: (MI) DMAレジスタに関する定義の追加</A>
  <DD><A href="#note15-06">Note 15-06: (WM) 無線コントロールライブラリの修正、機能追加</A>
  <DD><A href="#note15-07">Note 15-07: (WM) 無線強度のアイコンの収録</A>
  <DD><A href="#note15-08">Note 15-08: (WBT) ブロック転送ライブラリのテスト公開</A>
  <DD><A href="#note15-09">Note 15-09: (SND) サウンドライブラリの更新</A>
  <DD><A href="#note15-10">Note 15-10: (DevEnv) 圧縮された常駐モジュールへの対応</A>
  <DD><A href="#note15-11">Note 15-11: (DevEnv) make run による nitload の起動</A>
  <DD><A href="#note15-12">Note 15-12: (DevEnv) 各ハードウェアバージョンに対応する ferret コンポーネントの提供</A>
  <DD><A href="#note15-13">Note 15-13: (OS) OS_CheckHeap() の修正</A>
  <DD><A href="#note15-14">Note 15-14: (MI) ntrcomp.exe のランレングス圧縮時の不具合修正</A>
  <DD><A href="#note15-15">Note 15-15: (MI) DMA 処理の修正</A>
  <DD><A href="#note15-16">Note 15-16: (WM/SND) 無線とサウンド同時使用時の不具合対処</A>
  <DD><A href="#note15-17">Note 15-17: (MB) MB_GetSegmentLength 関数の返り値に関する不具合の修正</A>
  <DD><A href="#note15-18">Note 15-18: (MB) Multiboot サンプルの Debug 版における動作不具合の修正</A>
  <DD><A href="#note15-19">Note 15-19: (CARD) バックアップアクセス関数の初回呼び出し時の問題の修正</A>
  <DD><A href="#note15-20">Note 15-20: (PRC) CharacterRecognition-1 デモのスタック溢れの修正</A>
  <DD><A href="#note15-21">Note 15-21: (OS) OS_TPrintf(簡易版 printf) の追加</A>
  <DD><A href="#KnownIssues_2_00_pr6">SDK 2.0 PR6 での既知の問題点</A>
</DL>
<DL>
  <DT><A href="#sdk_2_00_pr5">■NITRO-SDK 2.0 PR5</A> (2004/08/30)
  <DD><A href="#note14-01">Note 14-01: (WM) [重要] 無線コントロールライブラリの修正、機能追加</A>
  <DD><A href="#note14-02">Note 14-02: (MI) [重要] 自動起動するDMAに関するハードウェア制限への対処</A>
  <DD><A href="#note14-03">Note 14-03: (DevEnv) [重要] ハードウェアのバージョンに対応したコンポーネント・ライブラリの収録</A>
  <DD><A href="#note14-04">Note 14-04: (DevEnv) mongoose の TEG 環境でのサポート停止</A>
  <DD><A href="#note14-05">Note 14-05: (DevEnv) makerom の Reject 指定の初期値に <CODE>&quot;.&quot;</CODE>(ドット) で始まるファイルを追加</A>
  <DD><A href="#note14-06">Note 14-06: (DevEnv) SDK をビルドする CodeWarrior のバージョンを 0.6.1
  に変更</A>
  <DD><A href="#note14-07">Note 14-07: (DevEnv) .itcm/.dtcm セクションのコードが ITCM/DTCM へ配置されない問題の修正</A>
  <DD><A href="#note14-08">Note 14-08: (GX) モザイクサイズ設定での不具合の修正</A>
  <DD><A href="#note14-09">Note 14-09: (GX) gx.h の GX_InitEx() などの定義における不具合の修正</A>
  <DD><A href="#note14-10">Note 14-10: (CARD) FLASH デバイスのサポート</A>
  <DD><A href="#note14-11">Note 14-11: (CARD) 割り込み禁止状態での CARD_Init() 呼び出し時の問題の修正</A>
  <DD><A href="#note14-12">Note 14-12: (CARD) CARD_IdentifyBackup() 呼び出し時の問題の修正</A>
  <DD><A href="#note14-13">Note 14-13: (MI) メインメモリ表示起動 DMA などにおけるメインメモリへのアクセス優先権</A>
  <DD><A href="#note14-14">Note 14-14: (OS) Tick 値取得関数の修正</A>
  <DD><A href="#note14-15">Note 14-15: (OS) VBlank 割り込み時における割り込みチェックフラグの自動設定処理を停止</A>
  <DD><A href="#note14-16">Note 14-16: (OS) TS環境におけるDTCMの位置変更</A>
  <DD><A href="#note14-17">Note 14-17: (OS) OS_Init() 内部からの PM_Init() の呼び出し</A>
  <DD><A href="#note14-18">Note 14-18: (OS) OS_GetConsoleType() による正確な動作環境判定</A>
  <DD><A href="#note14-19">Note 14-19: (TP) タッチパネル接触判定時の誤認識</A>
  <DD><A href="#note14-20">Note 14-20: (PM) スリープからの復帰要因に RTC アラームをサポート</A>
  <DD><A href="#note14-21">Note 14-21: (RTC) RTC の 24 時制固定による運用</A>
  <DD><A href="#note14-22">Note 14-22: (DEMO) アプリケーション起動時に A ボタンが押されている場合の対処</A>
  <DD><A href="#note14-23">Note 14-23: (Doc) ntrcomp などの補助ツールのリファレンスマニュアルの追加</A>
  <DD><A href="#KnownIssues_2_00_pr5">SDK 2.0 PR5 での既知の問題点</A>
</DL>
<DL>
  <DT><A href="#sdk_2_00_pr4">■NITRO-SDK 2.0 PR4</A> (2004/08/11)
  <DD><A href="#note13-01">Note 13-01: (WM) 無線コントロールライブラリの修正、機能追加</A>
  <DD><A href="#note13-02">Note 13-02: (MB) マルチブートライブラリの追加</A>
  <DD><A href="#note13-03">Note 13-03: (PM) PMライブラリの追加</A>
  <DD><A href="#note13-04">Note 13-04: (MIC/TP) マイクのサンプリングとタッチパネルとの並行動作</A>
  <DD><A href="#note13-05">Note 13-05: (MIC) IS-NITRO-DEBUGGER でのマイクサポートおよび前処理の追加</A>
  <DD><A href="#note13-06">Note 13-06: (MIC) mic2wav ツールの修正</A>
  <DD><A href="#note13-07">Note 13-07: (GX) LCDパワー制御関数の変更</A>
  <DD><A href="#note13-08">Note 13-08: (GX) G3*_MultTransMtx33の追加</A>
  <DD><A href="#note13-09">Note 13-09: (GX) GXの使用するDMA番号を設定する関数の追加</A>
  <DD><A href="#note13-10">Note 13-10: (GX) GX_PowerGeometry()／GX_Power3D() の不具合修正</A>
  <DD><A href="#note13-11">Note 13-11: (GX) GX_SetGraphicsMode()のレジスタへの書き込み制限変更</A>
  <DD><A href="#note13-12">Note 13-12: (CARD) NITRO-CARDアクセスAPIの正式公開</A>
  <DD><A href="#note13-13">Note 13-13: (FS) FS_ReadDir関数で得られるファイルIDがずれる不具合の修正</A>
  <DD><A href="#note13-14">Note 13-14: (DevEnv) makelcf/makerom の変数展開時における不具合と変数定義ファイルサポート</A>
  <DD><A href="#note13-15">Note 13-15: (DevEnv) autoload モジュールの情報をオーバーレイネームファイルへ出力</A>
  <DD><A href="#note13-16">Note 13-16: (DevEnv) mingw 環境での C++ ライブラリのリネームに失敗していた点の修正</A>
  <DD><A href="#note13-17">Note 13-17: (OS) Vブランクカウンタの設置</A>
  <DD><A href="#note13-18">Note 13-18: (PAD) PAD_SetIrq(), PAD_ClearIrq() の廃止</A>
  <DD><A href="#note13-19">Note 13-19: (MI) 同期DMA後の DMAビジーウェイトの追加</A>
  <DD><A href="#note13-20">Note 13-20: (SND) サウンドライブラリの更新</A>
  <DD><A href="#note13-21">Note 13-21: (Demo) GX デモ 3D_BoxTest の修正</A>
  <DD><A href="#note13-22">Note 13-22: (Demo) GX デモ LinesOver の修正</A>
  <DD><A href="#note13-23">Note 13-23: (Demo) SPI デモ spiMonkey の出力画面の修正</A>
  <DD><A href="#note13-24">Note 13-24: (DevEnv) char 型の符号設定の変更</A>
  <DD><A href="#KnownIssues_2_00_pr4">SDK 2.0 PR4 での既知の問題点</A>
</DL>
<DL>
  <DT><A href="#sdk_2_00_pr3_plus">■NITRO-SDK 2.0 PR3plus</A> (2004/07/29)
  <DD><A href="#note12-01">Note 12-01: (DOC) WM ライブラリリファレンスマニュアルの加筆、修正</A>
  <DD><A href="#KnownIssues_2_00_pr3_plus">SDK 2.0 PR3plus での既知の問題点</A>
</DL>
<DL>
  <DT><A href="#sdk_2_00_pr3">■NITRO-SDK 2.0 PR3</A> (2004/07/27) <FONT color="#ff0000">[緊急リリース版]</FONT>
  <DD><A href="#note11-01">Note 11-01: (OS) システム共有領域の定義ミスの修正</A>
  <DD><A href="#note11-02">Note 11-02: (DevEnv) 構造体のパディング警告設定の修正</A>
  <DD><A href="#KnownIssues_2_00_pr3">SDK 2.0 PR3 での既知の問題点</A>
</DL>
<DL>
  <DT><A href="#sdk_2_00_pr2">■NITRO-SDK 2.0 PR2</A> (2004/07/26)
  <DD><A href="#note10-01">Note 10-01: (WM) 無線コントロールライブラリの追加</A>
  <DD><A href="#note10-02">Note 10-02: (DevEnv) メモリマップの変更 (DTCMのアドレス変更) (TSのみ)</A>
  <DD><A href="#note10-03">Note 10-03: (DevEnv) DTCMの違いを吸収するパラメータの追加</A>
  <DD><A href="#note10-04">Note 10-04: (DevEnv) C++ 例外テーブルのリンクでエラー発生していたことの対処</A>
  <DD><A href="#note10-05">Note 10-05: (SVC) SVCライブラリ更新とリファレンスの追加</A>
  <DD><A href="#note10-06">Note 10-06: (OS) ロック関数の整備(1) ロックIDの型統一</A>
  <DD><A href="#note10-07">Note 10-07: (OS) ロック関数の整備(2) アンロック関数の名称変更</A>
  <DD><A href="#note10-08">Note 10-08: (MI) MI_GetCartridgeRomCycle* 関数の名称の変更 (再掲)</A>
  <DD><A href="#KnownIssues_2_00_pr2">SDK 2.0 PR2 での既知の問題点</A>
</DL>
<DL>
  <DT><A href="#sdk_2_00_pr1">■NITRO-SDK 2.0 PR1</A> (2004/07/20)
  <DD><A href="#note9-01">Note 9-01: (DevEnv) TS 版のライブラリサポートとデフォルトターゲット変更</A>
  <DD><A href="#note9-02">Note 9-02: (DevEnv) ROM バイナリファイルの拡張子の変更</A>
  <DD><A href="#note9-03">Note 9-03: (DevEnv) オーバーレイ手法の変更</A>
  <DD><A href="#note9-04">Note 9-04: (DevEnv) LCFファイル記述の変更</A>
  <DD><A href="#note9-05">Note 9-05: (DevEnv) makeルールの変更</A>
  <DD><A href="#note9-06">Note 9-06: (DevEnv) nef,srl ファイルの生成規則の修正</A>
  <DD><A href="#note9-07">Note 9-07: (DevEnv) コンパイルスイッチ NITRO_CODEGEN_ALL の追加</A>
  <DD><A href="#note9-08">Note 9-08: (SND) サウンドライブラリの更新</A>
  <DD><A href="#note9-09">Note 9-09: (FS) FS_RegisterArchiveName関数の不具合修正</A>
  <DD><A href="#note9-10">Note 9-10: (FS) async デモのスレッド内デバッグ表示の不具合の修正</A>
  <DD><A href="#note9-11">Note 9-11: (FS) FS_WaitAsync 関数が未完了で制御を返す不具合の修正</A>
  <DD><A href="#note9-12">Note 9-12: (GX) GX_SetBankForTex(), GX_LoadTexEx(), GX_LoadTex() の修正</A>
  <DD><A href="#note9-13">Note 9-13: (GX) GXデモ中のクリアカラーα値のデフォルト変更</A>
  <DD><A href="#note9-14">Note 9-14: (FX) FX_AtanIdx(), FX_Atan2Idx() の追加</A>
  <DD><A href="#note9-15">Note 9-15: (FX) ジオメトリエンジンへ値を送らない行列計算APIの追加</A>
  <DD><A href="#note9-16">Note 9-16: (OS) NITRO_MEMSIZE=8M 時のアリーナ設定の修正</A>
  <DD><A href="#note9-17">Note 9-17: (OS) alloc, free などメモリ割り当て関連関数のスレッドセーフ化</A>
  <DD><A href="#note9-18">Note 9-18: (OS) OS_JoinThread(), OS_IsThreadTerminated() の作成</A>
  <DD><A href="#note9-19">Note 9-19: (OS) DMAのアドレスチェックASSERTの修正</A>
  <DD><A href="#note9-20">Note 9-20: (OS) OS_SetProtectionRegion() の動作変更</A>
  <DD><A href="#note9-21">Note 9-21: (OS) 関数コスト計測プロファイラの変更</A>
  <DD><A href="#note9-22">Note 9-22: (MI) 圧縮データの圧縮タイプ・展開後サイズ取得関数の追加</A>
  <DD><A href="#note9-23">Note 9-23: (MI) MI_GetCartridgeRomCycle* 関数の名称の変更</A>
  <DD><A href="#note9-24">Note 9-24: (MI) MI_CpuCopyFast() のASSERTの修正</A>
  <DD><A href="#note9-25">Note 9-25: (MI) DMA パラメータ設定と停止処理の変更</A>
  <DD><A href="#note9-26">Note 9-26: (CP) 除算器の除数セット方法の変更</A>
  <DD><A href="#note9-27">Note 9-27: (MIC) サンプリング種別の拡張</A>
  <DD><A href="#note9-28">Note 9-28: (PRC) 図形認識API の追加(テスト公開)</A>
  <DD><A href="#note9-29">Note 9-29: (TP) タッチパネルの取得データ精度の変更</A>
  <DD><A href="#KnownIssues_2_00_pr1">SDK 2.0 PR1 での既知の問題点</A>
</DL>
<DL>
  <DT><A href="#sdk_1_02_rc2">■NITRO-SDK 1.2</A> (2004/6/16)
  <DD><A href="#note8-01">Note 8-01: (CP) IRQハンドラ内でのCPコンテキスト切り替え処理の追加</A>
  <DD><A href="#note8-02">Note 8-02: (FX) 定数定義の修正と追加</A>
  <DD><A href="#note8-03">Note 8-03: (OS) アイドルスレッド処理の修正</A>
  <DD><A href="#note8-04">Note 8-04: (SPI) spiMonkeyデモの修正</A>
  <DD><A href="#note8-05">Note 8-05: (DevEnv) makerom/makelcf 変数値読み込みバグの修正</A>
  <DD><A href="#KnownIssues_1_02_rc2">SDK 1.2 での既知の問題点</A>
</DL>
<DL>
  <DT><A href="#sdk_1_02_rc1">■NITRO-SDK 1.2 RC1</A> (2004/6/10)
  <DD><A href="#note7-01">Note 7-01: (GX) メイン LCD とサブ LCD 出力先切り替えの設定フラグの変更</A>
  <DD><A href="#note7-02">Note 7-02: (MIC) マイクAPIの追加</A>
  <DD><A href="#note7-03">Note 7-03: (TP) 最大サンプリングレートの変更</A>
  <DD><A href="#note7-04">Note 7-04: (TP) タッチパネルコマンド送信直後に割り込みが発生した場合の不具合修正</A>
  <DD><A href="#note7-05">Note 7-05: (TP) オートサンプリングインターフェイスの変更</A>
  <DD><A href="#note7-06">Note 7-06: (TP) TP_SetCallback()の引数の型変更</A>
  <DD><A href="#note7-07">Note 7-07: (FS) async デモの全読み込み完了サイズ表示の不具合の修正</A>
  <DD><A href="#note7-08">Note 7-08: (FS) オーバーレイのデータキャッシュが更新されない不具合の修正</A>
  <DD><A href="#note7-09">Note 7-09: (FS) FS_SetDefaultDMA()関数の不具合の修正</A>
  <DD><A href="#note7-10">Note 7-10: (OS) IRQハンドラの仕様変更</A>
  <DD><A href="#note7-11">Note 7-11: (OS) デフォルトの最大スレッド数の変更</A>
  <DD><A href="#note7-12">Note 7-12: (OS) OS_GetNumberOfThread() の作成</A>
  <DD><A href="#note7-13">Note 7-13: (OS) アリーナ設定の変更</A>
  <DD><A href="#note7-14">Note 7-14: (OS) プロテクションリージョン関数の変更</A>
  <DD><A href="#note7-15">Note 7-15: (OS) Profile機能のOSライブラリからの分割</A>
  <DD><A href="#note7-16">Note 7-16: (OS) 関数コールトレース表示の修正</A>
  <DD><A href="#note7-17">Note 7-17: (OS) OS_GetConsoleType() の作成</A>
  <DD><A href="#note7-18">Note 7-18: (OS) OS_Printf()等デバッグ用関数のFINALROMビルドでの扱い変更</A>
  <DD><A href="#note7-19">Note 7-19: (OS) TCM関数名の変更</A>
  <DD><A href="#note7-20">Note 7-20: (OS) OSデモ構成の変更</A>
  <DD><A href="#note7-21">Note 7-21: (GX) GXデモの修正</A>
  <DD><A href="#note7-22">Note 7-22: (GX) Ensataバージョンアップによるデモの制限解除</A>
  <DD><A href="#note7-23">Note 7-23: (GX) 拡張パレット用VRAM設定名称の変更</A>
  <DD><A href="#note7-24">Note 7-24: (GX) GX_Initの複数呼び出しの対策</A>
  <DD><A href="#note7-25">Note 7-25: (GX) GX_GetObj_* の作成</A>
  <DD><A href="#note7-26">Note 7-26: (FX) FX32_CONST()マクロの作成</A>
  <DD><A href="#note7-27">Note 7-27: (MI) MI_UncompressRL8() の修正</A>
  <DD><A href="#note7-28">Note 7-28: (DevEnv) makerom, makelcf の解説の追加</A>
  <DD><A href="#note7-29">Note 7-29: (DevEnv) 本体 NVRAM に保持されるデータの書き換えツール</A>
  <DD><A href="#note7-30">Note 7-30: (DevEnv) FINALROM 版のビルドで -g オプション追加</A>
  <DD><A href="#note7-31">Note 7-31: (DevEnv) makerom で誤まったエラーメッセージが出力される不具合の修正</A>
  <DD><A href="#KnownIssues_1_02_rc1">SDK 1.2 RC1 での既知の問題点</A>
</DL>
<DL>
  <DT><A href="#sdk_1_02_pr1">■NITRO-SDK 1.2 PR1</A> (2004/5/24)
  <DD><A href="#note6-01">Note 6-01: (DevEnv) CodeWarrior NITRO V0.5 への対応</A>
  <DD><A href="#note6-02">Note 6-02: (DevEnv) ROM バイナリ作成ツールを elftobin から makerom へ変更</A>
  <DD><A href="#note6-03">Note 6-03: (DevEnv) lcf の ALIGN(32) 追加</A>
  <DD><A href="#note6-04">Note 6-04: (DevEnv) 実行バイナリ生成規則の依存ファイルの追加手段のサポート</A>
  <DD><A href="#note6-05">Note 6-05: (DevEnv) CodeWarrior以外のコンパイラからのヘッダインクルードへの対応</A>
  <DD><A href="#note6-06">Note 6-06: (DevEnv) IDE デモサンプルの配布終了</A>
  <DD><A href="#note6-07">Note 6-07: (ARM7) 統合コンポーネントferretの追加</A>
  <DD><A href="#note6-08">Note 6-08: (FS) ファイルシステム、オーバーレイのサポート</A>
  <DD><A href="#note6-09">Note 6-09: (TP) タッチパネル関数のサポート</A>
  <DD><A href="#note6-10">Note 6-10: (CP) 除算器、平方根演算器の割り込み、マルチスレッドへの対応</A>
  <DD><A href="#note6-11">Note 6-11: (GX) MtxFx22 用の API 作成</A>
  <DD><A href="#note6-12">Note 6-12: (GX) TEG ボードにおけるコマンド FIFO の動作不良の対策</A>
  <DD><A href="#note6-13">Note 6-13: (GX) GX_SetBankForARM7() への GX_VRAM_ARM7_128_C の追加 </A>
  <DD><A href="#note6-14">Note 6-14: (GX) BG拡張パレットへの GX_VRAM_BGEXTPLTT_01_F の指定時の不具合の修正</A>
  <DD><A href="#note6-15">Note 6-15: (GX) ジオメトリエンジンの処理落ちと同期を取るデモの追加</A>
  <DD><A href="#note6-16">Note 6-16: (GX) scaleW を調整できる透視変換行列関連 API 作成</A>
  <DD><A href="#note6-17">Note 6-17: (GX) GX_Init 関数によるコマンド FIFO リセット処理の変更</A>
  <DD><A href="#note6-18">Note 6-18: (GX) フォグモードの制御の不具合の修正</A>
  <DD><A href="#note6-19">Note 6-19: (OS)スレッドシステムの扱いの変更</A>
  <DD><A href="#note6-20">Note 6-20: (OS) OS_SPrintf() の追加</A>
  <DD><A href="#note6-21">Note 6-21: (OS) TEG ボードメモリバイトアクセス対策</A>
  <DD><A href="#note6-22">Note 6-22: (OS) OS_WaitIrq()、OS_WaitAnyIrq() の作成</A>
  <DD><A href="#note6-23">Note 6-23: (OS) ATTRIBUTE_ALIGN(x) の作成</A>
  <DD><A href="#note6-24">Note 6-24: (OS) IDLEスレッドスタックの拡張</A>
  <DD><A href="#note6-25">Note 6-25: (OS) OS_GetLockID(), OS_ReleaseLockID() の作成</A>
  <DD><A href="#note6-26">Note 6-26: (OS) OS_SetSwitchThreadCallback() の作成</A>
  <DD><A href="#note6-27">Note 6-27: (OS) OS_ExitThread() 時の Mutex 開放</A>
  <DD><A href="#note6-28">Note 6-28: (OS) ARM7 コンポーネントのループ処理の変更</A>
  <DD><A href="#note6-29">Note 6-29: (OS) OS_SetProtectionRegion7(), OS_SetProtectionRegion7 の修正</A>
  <DD><A href="#note6-30">Note 6-30: (OS) システムクロックの定義</A>
  <DD><A href="#note6-31">Note 6-31: (OS) OS_Panic() の停止動作変更</A>
  <DD><A href="#note6-32">Note 6-32: (OS) OSのデモ構成の変更</A>
  <DD><A href="#note6-33">Note 6-33: (OS) IRQハンドラの変更</A>
  <DD><A href="#note6-34">Note 6-34: (OS) 関数コールトレース、関数コスト計測機構の作成</A>
  <DD><A href="#note6-35">Note 6-35: (OS) アプリケーション向けの割り込みチェックフラグの追加</A>
  <DD><A href="#note6-36">Note 6-36: (SND) サウンドライブラリの更新</A>
  <DD><A href="#KnownIssues_1_02_pr1">SDK 1.2 PR1 での既知の問題点</A>
</DL>

<DL>
  <DT><A href="#sdk_1_00_rc2">■NITRO-SDK 1.0</A> (2004/4/5)
  <DD><A href="#note5-01">Note 5-01: CodeWarrior NITRO V0.4 への対応</A>
  <DD><A href="#note5-02">Note 5-02: GX_HBlankOBJProc() / GXS_HBlankOBJProc() の修正</A>
  <DD><A href="#note5-03">Note 5-03: G2_SetOBJAttr() / G2S_SetOBJAttr() の修正</A>
  <DD><A href="#note5-04">Note 5-04: GX_DisableBankFor*() の修正</A>
  <DD><A href="#note5-05">Note 5-05: NitroPostLinker.bat の修正</A>
  <DD><A href="#note5-06">Note 5-06: fs/file-1 デモのリンク不具合の修正</A>
  <DD><A href="#note5-07">Note 5-07: makerom(β版)の修正</A>
  <DD><A href="#note5-08">Note 5-08: makelcf(β版) 用 lcf テンプレートの修正</A>
  <DD><A href="#KnownIssues_1_00_rc2">SDK 1.0 での既知の問題点</A>
</DL>
<DL>
  <DT><A href="#sdk_1_00_rc1">■NITRO-SDK 1.0 RC1</A> (2004/3/30)
  <DD><A href="#note4-01">Note 4-01: G3_Frustum() の不具合修正</A>
  <DD><A href="#note4-02">Note 4-02: GX_LoadTex() での転送エラー修正</A>
  <DD><A href="#note4-03">Note 4-03: GX_RegionCheck_Obj() の修正</A>
  <DD><A href="#note4-04">Note 4-04: GX3_GetCommandFifoStatus() の修正</A>
  <DD><A href="#note4-05">Note 4-05: DTCMの位置変更のサポート</A>
  <DD><A href="#note4-06">Note 4-06: codereset.h の修正</A>
  <DD><A href="#note4-07">Note 4-07: 例外ベクタ設定不具合</A>
  <DD><A href="#note4-08">Note 4-08: 周期アラームのハンドル内自己キャンセル追加</A>
  <DD><A href="#note4-09">Note 4-09: OS_IsThreadAvailable() の追加</A>
  <DD><A href="#note4-10">Note 4-10: 定数やアドレス代入アセンブラ表記の統一</A>
  <DD><A href="#note4-11">Note 4-11: G2_SetBG3ControlDCBmp() 不具合の修正</A>
  <DD><A href="#note4-12">Note 4-12: 固定小数定義の追加</A>
  <DD><A href="#note4-13">Note 4-13: マクロ FX_MUL32x64C とインライン関数 FX_Mul32x64c の丸め処理の統一</A>
  <DD><A href="#KnownIssues_1_00_rc1">SDK 1.0 RC1 での既知の問題点</A>
</DL>
<DL>
  <DT><A href="#sdk_1_00_pr2">■NITRO-SDK 1.0 PR2</A> (2004/3/17)
  <DD><A href="#note3-01">Note 3-01: PXI ライブラリの追加</A>
  <DD><A href="#note3-02">Note 3-02: グラフィックサンプルの追加</A>
  <DD><A href="#note3-03">Note 3-03: MIのファイル展開API に対応する圧縮ツールの追加</A>
  <DD><A href="#note3-04">Note 3-04: NITRO-SDK と AGBSDK 両環境の共存についてのドキュメント追加</A>
  <DD><A href="#note3-05">Note 3-05: OBJ と BG のバンク EFG の設定</A>
  <DD><A href="#note3-06">Note 3-06: G3X_InitMtxStack() の問題の修正</A>
  <DD><A href="#note3-07">Note 3-07: man のジオメトリコマンドサイクルの一覧のリンク追加</A>
  <DD><A href="#note3-08">Note 3-08: OS_Sleep() の作成</A>
  <DD><A href="#note3-09">Note 3-09: スレッド切り替えに関する不具合修正</A>
  <DD><A href="#note3-10">Note 3-10: OS_ReadMessage() の作成</A>
  <DD><A href="#note3-11">Note 3-11: IRQチェックフラグセットに関する修正</A>
  <DD><A href="#note3-12">Note 3-12: 複数のVカウントアラームに関する修正</A>
  <DD><A href="#note3-13">Note 3-13: チックの不具合修正</A>
  <DD><A href="#note3-14">Note 3-14: 時間とチックの変換マクロ追加</A>
  <DD><A href="#note3-15">Note 3-15: タイマー割り込みコールバックからの復帰不具合の修正</A>
  <DD><A href="#note3-16">Note 3-16: OS_DisableInterrupts() 等におけるFIQの扱いの変更</A>
  <DD><A href="#note3-17">Note 3-17: デバッガの例外ハンドラ呼び出しに関する仕様変更</A>
  <DD><A href="#note3-18">Note 3-18: ARM7 のレジスタ名の変更</A>
  <DD><A href="#note3-19">Note 3-19: レジスタ表の修正</A>
  <DD><A href="#note3-20">Note 3-20: マニュアルの修正</A>
  <DD><A href="#note3-21">Note 3-21: IRQテーブルの修正</A>
  <DD><A href="#KnownIssues_1_00_pr2">SDK 1.0 PR2での既知の問題点</A>
</DL>
<DL>
  <DT><A href="#sdk_1_00_pr1">■NITRO-SDK 1.0 PR1</A> (2004/2/27)
  <DD><A href="#note2-01">Note 2-01: NITRO-SDK への改称</A>
  <DD><A href="#note2-02">Note 2-02: ソースのプロセッサ別の分類</A>
  <DD><A href="#note2-03">Note 2-03: サブ LCD 対応 API およびデモの追加</A>
  <DD><A href="#note2-04">Note 2-04: ELF ファイルの拡張子の変更</A>
  <DD><A href="#note2-05">Note 2-05: サンプルコードのディレクトリの移動および自動テスト用コードの追加</A>
  <DD><A href="#note2-06">Note 2-06: SDK の Thumb コードコンパイル</A>
  <DD><A href="#note2-07">Note 2-07: 関数単位で ARM コード/ Thumb コード生成の切替手段の提供</A>
  <DD><A href="#note2-08">Note 2-08: SDK ライブラリでの C++ サポート</A>
  <DD><A href="#note2-09">Note 2-09: X,Y ボタンのサポート</A>
  <DD><A href="#note2-10">Note 2-10: make 関連ファイルに関する修正</A>
  <DD><A href="#note2-11">Note 2-11: マクロの複文表記の修正</A>
  <DD><A href="#note2-12">Note 2-12: ヘッダファイル内のインラインアセンブラ関数を C ソースへ移動</A>
  <DD><A href="#note2-13">Note 2-13: マクロ CODEGEN_PROC を NITRO_PROC へ名称変更</A>
  <DD><A href="#note2-14">Note 2-14: elftobin での結合用 ARM7 バイナリの変更</A>
  <DD><A href="#note2-15">Note 2-15: IRQ スタックサイズ設定機構の追加</A>
  <DD><A href="#note2-16">Note 2-16: 例外発生時のコンテキスト表示機構の追加</A>
  <DD><A href="#note2-17">Note 2-17: MI_Dma*Async() での NULL コールバック設定時の不具合修正</A>
  <DD><A href="#note2-18">Note 2-18: TCM 領域にかかる DMA の警告の追加</A>
  <DD><A href="#note2-19">Note 2-19: 起動時のメモリクリア処理の追加</A>
  <DD><A href="#note2-20">Note 2-20: キャッシュ関連の関数の引数のアドレス丸め</A>
  <DD><A href="#note2-21">Note 2-21: OS_CreateThread() の引数追加、スレッド優先制御の自由度向上</A>
  <DD><A href="#note2-22">Note 2-22: スレッドのスタック溢れのチェック機構のサポート</A>
  <DD><A href="#note2-23">Note 2-23: アラームおよび 64bit 計時カウンタの実装</A>
  <DD><A href="#note2-24">Note 2-24: V カウントアラームの実装</A>
  <DD><A href="#note2-25">Note 2-25: MI_DmaSend*() , MI_CpuSend*() の追加</A>
  <DD><A href="#note2-26">Note 2-26: OS_StartTimer*() のアサート判定の修正</A>
  <DD><A href="#note2-27">Note 2-27: CPUメモリ関数の追加</A>
  <DD><A href="#note2-28">Note 2-28: TEG ボードの VBLANK 中のメインバスへのアクセスに伴うハードバグ対策</A>
  <DD><A href="#note2-29">Note 2-29: Light パラメータの調整</A>
  <DD><A href="#note2-30">Note 2-30: 動的 DL 作成関数群のオーバーフローチェックの実装</A>
  <DD><A href="#note2-31">Note 2-31: G3_Ortho() のバグ修正</A>
  <DD><A href="#note2-32">Note 2-32: G3_EndMakeDL() が正しいサイズを返さないバグの修正</A>
  <DD><A href="#note2-33">Note 2-33: G2_SetBG*Control256x16Pltt() の引数の追加</A>
  <DD><A href="#note2-34">Note 2-34: G3CS_LoadTexMtxEnv(), G3CS_LoadTexMtxTexCoord() の不具合修正</A>
  <DD><A href="#note2-35">Note 2-35: 追加された半透明テクスチャの API サポート</A>
  <DD><A href="#note2-36">Note 2-36: VecFx16 型と関連 API のサポート</A>
  <DD><A href="#note2-37">Note 2-37: DEMO ライブラリのヘッダファイルに C のリンケージ指定追加</A>
  <DD><A href="#KnownIssues_1_00">SDK 1.0 での既知の問題点</A>
</DL>
<DL>
  <DT><A href="#20040120p1">■2004年1月20日 irisSDK snapshot patch1</A> (2004/2/4)
  <DD><A href="#note1-01">Note 1-01: 3D 関連の test コードの実行速度が遅いことの修正</A>
  <DD><A href="#note1-02">Note 1-02: VEC Mag のオーバーフロー対応</A>
  <DD><A href="#note1-03">Note 1-03: MTX_Concat43() の修正</A>
  <DD><A href="#note1-04">Note 1-04: G2_SetBGxControl() 系の関数の定義修正</A>
  <DD><A href="#note1-05">Note 1-05: MTX_Inverse43() の平行移動計算の修正</A>
  <DD><A href="#note1-06">Note 1-06: GX_SetOBJVRamModeBmp() の定義修正</A>
  <DD><A href="#note1-07">Note 1-07: バイトアクセス対策版ライブラリへの対応</A>
  <DD><A href="#note1-08">Note 1-08: G2_SetBG3Priority() の定義修正</A>
  <DD><A href="#note1-09">Note 1-09: マクロ GX_FX16PAIR の定義修正</A>
  <DD><A href="#note1-10">Note 1-10: パッケージ収録のライブラリファイルの IS_IRIS_EMULATOR 対応</A>
  <DD><A href="#note1-11">Note 1-11: ARM7 版の libstubsisd.a ファイルの追加収録</A>
  <DD><A href="#note1-12">Note 1-12: システム予約領域のサイズの定義修正</A>
  <DD><A href="#note1-13">Note 1-13: GX サンプルプログラムで G3_LightVector() 設定のコマンド位置の修正</A>
  <DD><A href="#note1-14">Note 1-14: MI_DmaCopy16Async() でコールバックが呼ばれない不具合の修正</A>
  <DD><A href="#20040120p1_KnownIssues">snapshot 20040120+Path1 の既知の問題点</A>
</DL>

<HR>
<H2 style="line-height: 0"><A name="sdk_2_01" id="sdk_2_01">■ NITRO-SDK Version 2.1 正式版</A></H2>
<DIV style="text-align: right">
<P style="line-height: 0">(2005/05/09)</P>
</DIV>

<HR>
<H3><A name="note26-01" id="note26-01">Note 26-01: (CARD) カードアクセス用DMAチャンネルの正当性判定追加</A></H3>
<P><a href="changelog-oldver.html#note21-33">Note 21-33</a>にてMIライブラリ内でDMAチャンネルの正当性判定が追加されましたが、
CARDライブラリおよびFSライブラリではチャンネルが指定される箇所と実際に使用される箇所が離れていてこの制限に気付きにくかったため、
これらのライブラリでもDMAチャンネルを要求する関数の冒頭に正当性判定を追加しました。<br>
また、この点についての注意も関数リファレンスに追記しました。
</P>

<HR>
<H3><A name="note26-02" id="note26-02">Note 26-02: (DevEnv) 浮動小数点ライブラリ指定オプションの追加</A></H3>
<P>浮動小数点ライブラリを指定するビルドスイッチCW_LIBFPを用意し、Makefile 側で再定義可能なように変更しました。<br>
また、デフォルトで指定されるライブラリを従来の FP_fullI_v5t_LE.a から FP_fastI_v5t_LE.a へ変更しました。
</P>

<HR>
<H3><A name="note26-03" id="note26-03">Note 26-03: (FS) FINALROMバージョンのオーバーレイ関数の内部修正</A></H3>
<P>FINALROMバージョンのオーバーレイ関数が不必要なデバッグ用関数を呼び出してリンク時のコードサイズを増加させていましたので、これを修正しました。
</P>

<HR>
<H3><A name="note26-04" id="note26-04">Note 26-04: (MB) サンプルデモの追加</A></H3>
<P>DSダウンロードプレイ親機の省電力モード設定を切り替える MB_SetPowerSaveMode 関数を使用したサンプルデモとして multiboot-PowerSave を追加しました。
</P>

<HR>
<H3><A name="note26-05" id="note26-05">Note 26-05: (OS) 拡張言語コードの追加</A></H3>
<P>
言語コードを新規に追加するための仕組みを導入し、拡張言語コードとして中国語を追加しました。<br>
中国語対応アプリケーションを作成するためのガイドラインについては、現在準備中ですのでお待ちください。</P>

<HR>
<H3><A name="note26-06" id="note26-06">Note 26-06: (SND) インストのリリース無効化機能の追加</A></H3>
<P>
SNDInstData構造体のreleaseフィールドにSND_BANK_DISABLE_RELEASE(=255)を指定した場合、
そのインストはノート長の指定を無視して波形データ終端まで再生するよう機能を追加しました。

<HR>
<H3><A name="note26-07" id="note26-07">Note 26-07: (WBT) サンプルデモの修正</A></H3>
<P>
$NitroSDK/build/demos/wireless_shared/wfs サンプルモジュールおよび<br>
$NitroSDK/build/demos/wbt/wbt-fs サンプルデモに以下の修正を行いました。<br>

<ul>
<li>
WFS_End 関数が割り込みハンドラから呼び出されることによってプログラムが停止してしまう不具合があり、これを修正しました。<br>
また、WFS サンプルモジュールのヘッダファイルにも、割り込みハンドラから呼び出せない旨の記述を追加しました。<br>
<li>
すでに WM ライブラリが終了した状態で WFS_End 関数を呼び出したときに内部でポートコールバックの解放に失敗してエラー停止する仕様でしたが、
この部分を単に無視するよう変更しました。
<li>
WFS サンプルモジュールがスレッドシステムを必須とするため、ビルド時に SDK_NO_THREAD が定義された場合にはメッセージを出力してコンパイルエラーで停止するようチェックコードを追加しました。</P>
</ul>

<HR>
<H3><A name="note26-08" id="note26-08">Note 26-08: (WM) サンプルデモの修正</A></H3>
<P>
WC サンプルモジュールの WcInit 関数を複数回呼び出しうるにもかかわらず WcFinish 関数を呼び出していないサンプルについて、
この２つの関数が正しく対応して呼び出されるよう修正しました。<br>
以下のサンプルデモが修正されています。
<ul>
<li>$NitroSDK/build/demos/wbt/wbt-fs
<li>$NitroSDK/build/demos/wvr/switchover
</ul>

<HR>
<H3><A name="KnownIssues_2_01" id="KnownIssues_2_01">SDK 2.1 正式版での既知の問題点</A></H3>
<P>　ありません。</P>

<HR>
<H2 style="line-height: 0"><A name="sdk_2_01_rc" id="sdk_2_01_rc">■ NITRO-SDK Version 2.1 RC</A></H2>
<DIV style="text-align: right">
<P style="line-height: 0">(2005/04/21)</P>
</DIV>

<HR>
<H3><A name="note25-01" id="note25-01">Note 25-01: (CARD) CARD_Init関数で作成されるスレッドに関する記述の追加</A></H3>
<P>CARD_Init関数のリファレンスにおいて、内部で生成される非同期処理用スレッドに関する記述がありませんでしたので、この説明を追加しました。
</P>

<HR>
<H3><A name="note25-02" id="note25-02">Note 25-02: (CTRDG) カートリッジデバイス抜け検出関数の追加</A></H3>
<P>カートリッジデバイスの抜け検出に使用する、CTRDG_IsAgbCartridgePulledOut関数およびCTRDG_IsOptionCartridgePulledOut関数を追加しました。<br>
NITRO-SDK2.0RCの更新(<a href="changelog-oldver.html#note18-20">Note18-20</a>)では、リファレンスの説明のみを追加しており、対応する関数の実装がありませんでした。
</P>

<HR>
<H3><A name="note25-03" id="note25-03">Note 25-03: (CTRDG) カートリッジバスのロックと抜け検出処理に関するリファレンスの説明追加</A></H3>
<P>カートリッジバスをロックしたままの状態では ARM7 による自動抜け検出が行われないため
CTRDG_IsExisting関数を定期的に呼び出す必要があることを、リファレンスの各関数に明記しました。
</P>

<HR>
<H3><A name="note25-04" id="note25-04">Note 25-04: (CTRDG) カートリッジ状態に関するリファレンスの記述修正</A></H3>
<P>NITRO-SDK 2.0 正式版で公開された<a href="changelog-oldver.html#note23-01">Note 23-01</a>のリファレンス記述追加に関して、
メーカーコードおよびゲームコードの取得が初期化時のみ行われるという内容が誤っていましたので、この記述を修正しました。
</P>

<HR>
<H3><A name="note25-05" id="note25-05">Note 25-05: (DevEnv) メモリマップの変更(DTCMのアドレス変更)</A></H3>
<P>メモリマップの見直しを行い、デフォルトでARM9に割り当てるMainRAM領域の大きさを増やしました。<br>
具体的には、これまで0x27C0000からの領域に配置していたDTCMを、0x27E0000 からとしました。
あわせて、ARM9に割り当てられるMainRAM領域は 0x2000000〜0x23BFFFF から 0x2000000〜0x23DFFFF となります。(128KByte 増加したことになります。) 
また、ARM7に割り当てられるMainRAM 領域は 0x27E0000〜0x27FEFFF となります。<br>
また、メインメモリのサイズを4Mとした場合にデフォルトのプロテクションリージョン設定では 0x23E0000〜0x23FFFFF までの
ARM7側プログラム配置領域がARM9からは読み書き可能であったので、プロテクションユニット2 の位置を変更して領域を保護するように修正しました。<br>
メインメモリのサイズを8Mとした場合のメインメモリ上の拡張アリーナの開始アドレスを 0x2400000 から 0x23E0000 に変更し、サイズを128Kバイト拡張しました。
</P>

<HR>
<H3><A name="note25-06" id="note25-06">Note 25-06: (FS) 割り込みに関する正当性判定の強化</A></H3>
<P>FSライブラリの関数のうち割り込みハンドラ内から呼び出すことのできないものについて、関数内に正当性判定コードを追加しました。
</P>

<HR>
<H3><A name="note25-07" id="note25-07">Note 25-07: (GX) G3_FrustumW関数の修正</A></H3>
<P>G3_FrustumW関数において、結果を格納する行列の要素 _23 の値が間違っているという不具合があり、これを修正しました。
</P>

<HR>
<H3><A name="note25-08" id="note25-08">Note 25-08: (MATH) クイックソート関数の追加</A></H3>
<P>再帰を使用しないクイックソート関数を MATH_QSort としてMATHカテゴリ以下に追加しました。
</P>

<HR>
<H3><A name="note25-09" id="note25-09">Note 25-09: (MATH) checksum, CRC の計算関数の追加</A></H3>
<P>データの checksum や CRC を求める関数とそのリファレンス、デモを追加しました。
</P>

<HR>
<H3><A name="note25-10" id="note25-10">Note 25-10: (MIC) mic-2サンプルデモの修正</A></H3>
<P>demos/spi/mic-2 サンプルについて以下の修正を行いました。 
<ul>
<li>サンプリングデータの参照時にキャッシュの無効化処理がありませんでしたので、これを行うように修正しました。
</ul>
</P>

<HR>
<H3><A name="note25-11" id="note25-11">Note 25-11: (MB) MB_Init関数のTGIDを自動生成するオプションの追加</A></H3>
<P>MB_Init関数へ引数として与えるTGIDについて、新規に定義された定数MB_TGID_AUTOを指定することによってこれを内部で自動生成させるオプションを追加しました。
これに伴い tgid 引数の型が u16 から u32 へ拡張されましたが、このオプション以外の仕様はすべて従来と同様です。
</P>

<HR>
<H3><A name="note25-12" id="note25-12">Note 25-12: (MB) 各種ワイヤレス駆動パラメータ設定関数の追加</A></H3>
<P>MBライブラリの内部で駆動しているWMライブラリへ各種パラメータを外部から明示的に指定するため、以下の関数を追加しました。
<ul>
<li>MB_SetLifeTime関数
<li>MB_SetPowerSaveMode関数
</ul>
</P>

<HR>
<H3><A name="note25-13" id="note25-13">Note 25-13: (MB) MBP サンプルデモの修正</A></H3>
<P>$NitroSDK/build/demos/wireless_shared/mbp 以下のサンプルソースコードに対し、以下の修正を行いました。 
<ul>
<li>接続されていない子機AIDに対して MBP_GetChildMacAddress 関数あるいは MBP_GetChildInfo 関数を呼び出した場合に NULL を返さないという不具合があり、これを修正しました。
</ul>
</P>

<HR>
<H3><A name="note25-14" id="note25-14">Note 25-14: (OS) ランチャースレッドのスタックチェック処理修正</A></H3>
<P>OS_InitThread関数で初期化されるランチャースレッドのスタックアンダーフロー検出用コードの挿入位置が、
本来のスタックメモリ下端より64バイト下方にあるという不具合があり、これを修正しました。
</P>

<HR>
<H3><A name="note25-15" id="note25-15">Note 25-15: (OS) OS_Sleep関数の内部動作修正</A></H3>
<P>OS_Sleep関数の内部実装において、アラーム設定からスレッド待機までの期間がスレッドセーフでありませんでしたので、これを修正しました。
</P>

<HR>
<H3><A name="note25-16" id="note25-16">Note 25-16: (OS) キャッシュフラッシュ関数の内部動作の修正</A></H3>
<P><A href="changelog-oldver.html#note24-10">Note 24-10</A>で行った内部実装の変更にともないDC_FlushAll関数の動作がスレッドセーフでなくなっていましたので、これを修正しました。<br>
また、領域を指定する形式のキャッシュ操作関数が領域サイズに比例した処理時間を要する旨を関数リファレンスに明記しました。
</P>

<HR>
<H3><A name="note25-17" id="note25-17">Note 25-17: (OS) サンプルデモの修正</A></H3>
<P>OSライブラリのいくつかのサンプルデモにてチックシステムを使用しつつ割り込みを禁止していましたので、
これについてOS_EnableIrq関数を正しく呼び出すように修正しました。
</P>

<HR>
<H3><A name="note25-18" id="note25-18">Note 25-18: (OS) 書式文字列関数のリファレンス訂正</A></H3>
<P>以下の書式文字列関数のリファレンスにて、最終ROM版(FINALROM)ライブラリで出力動作を行なわないという誤った説明がありましたが、この記述を削除しました。
<ul>
<li>OS_SPrintf関数
<li>OS_VSPrintf関数
<li>OS_SNPrintf関数
<li>OS_VSNPrintf関数
</ul>
</P>

<HR>
<H3><A name="note25-19" id="note25-19">Note 25-19: (OS) 拡張言語コードの暫定対応</A></H3>
<P>拡張言語コードへ暫定的に対応しました。
一部のツールに変更が加えられていますが、現状のアプリケーションには影響はありません。
次回リリースには正式対応となる予定です。
</P>


<HR>
<H3><A name="note25-20" id="note25-20">Note 25-20: (SND) サウンドライブラリ配布の一元化</A></H3>
<P>
サウンドライブラリについて、従来 NITRO-SDK にはライブラリファイルのみを収録し、
NITRO-System にはライブラリファイルとドキュメントおよびサンプルを収録していましたが、
本バージョンからこれらの全てをNITRO-SDK に収録しました。<br>
$NitroSDK/build/libraries/snd ディレクトリ以下にサウンドライブラリのソースファイルを公開し、<br>
$NitroSDK/build/demos/snd ディレクトリ以下にサウンドライブラリのサンプルデモを追加しました。<br>
あわせて、サウンドライブラリの関数リファレンスも追加しました。<br>
</P>

<HR>
<H3><A name="note25-21" id="note25-21">Note 25-21: (SND) SND_PrepareSeq関数およびSND_StartPreparedSeq関数の追加</A></H3>
<P>
SND_StartSeq関数呼び出し直後にシーケンスのパラメータを変更した場合、シーケンス開始とパラメータ反映が同一フレームで処理されない可能性があり、
この様な場合に対応する関数としてSND_PrepareSeq関数とSND_StartPreparedSeq関数を追加しました。<br>
SND_PrepareSeq関数とSND_StartPreparedSeq関数の間で行ったパラメータ変更は、シーケンス開始と同時に処理されることが保証されます。
</P>

<HR>
<H3><A name="note25-22" id="note25-22">Note 25-22: (WM) 内部動作の変更</A></H3>
<P>ワイヤレスライブラリ内にて、親機が子機の異常を検知した場合の切断処理を強化しました。
また、WM_Disconnect関数を用いて親機が子機を切断しようとして失敗した場合に規定回数切断処理をリトライするように内部動作を変更しました。
</P>

<HR>
<H3><A name="note25-23" id="note25-23">Note 25-23: (WM) TGIDを自動生成する関数の追加</A></H3>
<P>RTC の時刻設定をもとにして TGID を自動生成する WM_GetNextTgid 関数を追加しました。
</P>

<HR>
<H3><A name="KnownIssues_2_01_rc" id="KnownIssues_2_01_rc">SDK 2.1 RCでの既知の問題点</A></H3>
<P>
<ul>
<li><A href="changelog-oldver.html#note25-18">Note 25-18</A>の記述のとおり、現バージョンでは拡張言語コードへの対応が暫定のものとなっています。
<li>thumbビルド版のichneumonコンポーネントを使用するとプログラムが動作しないことが確認されており、現在対応中です。
</ul>
</P>

<HR>
<H2 style="line-height: 0"><A name="sdk_2_01_pr" id="sdk_2_01_pr">■ NITRO-SDK Version 2.1 PR</A></H2>
<DIV style="text-align: right">
<P style="line-height: 0">(2005/04/07)</P>
</DIV>

<HR>
<H3><A name="note24-01" id="note24-01">Note 24-01: (CARD) CARDRomHeader 構造体の追加</A></H3>
<P>ROM 内登録データの情報を表す構造体として CARDRomHeader 構造体を CARD ライブラリに追加しました。
</P>

<HR>
<H3><A name="note24-02" id="note24-02">Note 24-02: (CARD) CARD_IdentifyBackup 関数の内部チェック追加</A></H3>
<P>CARD_IdentifyBackup 関数の内部で1バイトのテスト読み出しを行う処理を追加しました。このテスト読み出しの結果値は CARD_GetResultCode 関数で取得することができます。<br>
これに伴って返り値の型が BOOL へ変更され、呼び出しの際には CARD_LockBackup 関数によるアクセスバスのロックが必要になりました。
</P>

<HR>
<H3><A name="note24-03" id="note24-03">Note 24-03: (CARD) ROMの種類を明示的に指定するサンプルデモの追加</A></H3>
<P>ワンタイムPROMビルドオプションのサポート(<A href="changelog-oldver.html#note24-04">Note 24-04</A> で後述)に伴い、マスクROMおよびワンタイムPROMを指定するサンプルとしてcard/card-1tromデモ、card/card-mromデモを追加しました。<br>
</P>

<HR>
<H3><A name="note24-04" id="note24-04">Note 24-04: (DevEnv) ワンタイムPROMビルドオプションのサポート</A></H3>
<P>プログラムに採用するROMの種類として、従来のマスクROM以外にワンタイムPROMを指定するためのビルドオプションがサポートされました。
makerom.exeツールのセクションパラメータにRomSpeedTypeが追加され、MROM、1TROM、UNDEFINEDのいずれかを指定できるようになりました。<br>
また、NITRO-SDKのmake環境用においては、NITRO_ROMSPEEDビルドスイッチが追加され、ビルド時にRomSpeedTypeを直接指定可能になりました。
（特に指定しなければUNDEFINEDが設定されます）<br>
詳細については、<A href="changelog-oldver.html#note24-03">Note 24-03</A> のサンプルデモを参照して下さい。
<br>
</P>

<HR>
<H3><A name="note24-05" id="note24-05">Note 24-05: (DevEnv) SDKバージョンのフォーマット変更</A></H3>
<P>version.hヘッダーファイルで定義されているSDKのバージョン情報について、常に0であったSDK_VERSION_PATCH定数の定義が廃止されました。<br>
これに関連して、プログラムの常駐コードに含まれる4バイトのバージョン情報値フォーマットも変更され、<br>
SDK_VERSION_PATCHフィールドの4ビットが廃止されSDK_VERSION_MINORフィールドが8ビットに拡張されました。<br>
下位ビット方向に拡張されています。<br>
<br>
この修正に対応して showversion ツールが変更されています。<br>
SDK のバージョン情報を読み出すツールなどを制作されている方は、ご注意ください。<br>
</P>

<HR>
<H3><A name="note24-06" id="note24-06">Note 24-06: (GX) G3_GetDLSize 関数の不具合修正</A></H3>
<P>G3_GetDLSize 関数の不具合で実際のディスプレイリストサイズよりも4バイト分大きな値を返す場合があり、この不具合を修正しました。
</P>

<HR>
<H3><A name="note24-07" id="note24-07">Note 24-07: (MATH) メッセージダイジェスト値の計算関数の追加</A></H3>
<P>標準的なメッセージダイジェストのアルゴリズムである MD5 と SHA-1 を使用したメッセージダイジェスト値の計算関数を MATH カテゴリ以下に追加しました。
また、鍵付ハッシングのアルゴリズムである HMAC-MD5 と HMAC-SHA-1 の計算関数も同時に追加しています。
</P>

<HR>
<H3><A name="note24-08" id="note24-08">Note 24-08: (MB) MB_GetGameEntryBitmap 関数の追加</A></H3>
<P>配信中のゲーム情報に対してエントリーしている子機群のAIDビットマップを取得するMB_GetGameEntryBitmap関数を追加しました。
</P>

<HR>
<H3><A name="note24-09" id="note24-09">Note 24-09: (OS) OS_ResetSystem 関数のカードロック内部処理修正</A></H3>
<P>あるスレッドがカードバスをロックした状態で動作している時に、それよりも優先度の低いスレッドがOS_ResetSystem関数を呼び出すと、
リセット内部処理がデッドロックする不具合がありましたので、これを修正しました。
</P>

<HR>
<H3><A name="note24-10" id="note24-10">Note 24-10: (OS) キャッシュフラッシュ関数の内部実装変更</A></H3>
<P>キャッシュラインの管理状態が valid かつ dirty の際に CPU の flush 命令がごくまれに動作しない場合があることが確認されましたので、
 SDK でこれらの機能を提供している DC_FlushRange 関数および DC_FlushAll 関数の内部実装を、
 CPU の store 命令と invalidate 命令の組み合わせで実現するように変更しました。<br>
関数仕様に変更はありません。
</P>

<HR>
<H3><A name="note24-11" id="note24-11">Note 24-11: (OS) サンプルデモの修正</A></H3>
<P>demos/os/favorite-color サンプルについて以下の修正を行いました。
<UL>
<LI>ポリゴンの描画処理についてensata環境で正しく動作しないという不具合があり、これを修正しました。
</UL>
</P>

<HR>
<H3><A name="note24-12" id="note24-12">Note 24-12: (RTC) 日付書き込み関数の不具合修正</A></H3>
<P>日付のみを書き換えるRTC_SetDate関数およびRTC_SetDateAsync関数が正常に動作せず日付が書き換わらないという不具合があり、これを修正しました。
</P>

<HR>
<H3><A name="note24-13" id="note24-13">Note 24-13: (Snd) サウンドドライバ情報取得関数追加</A></H3>
<P>サウンドドライバの情報を取得するための関数が追加されました。追加された関数は以下の通りです。
<UL>
<LI>SND_ReadDriverInfo 関数
<LI>SND_ReadChannelInfo 関数
<LI>SND_ReadPlayerInfo 関数
<LI>SND_ReadTrackInfo 関数
</UL>
</P>

<HR>
<H3><A name="note24-14" id="note24-14">Note 24-14: (Snd) SND_FlushCommand 関数のフラグ SND_COMMAND_IMMEDIATE 追加</A></H3>
<P>SND_FlushCommand 関数の引数フラグに、SND_COMMAND_IMMEDIATE を追加で指定できるようになりました。<br>
SND_COMMAND_IMMEDIATE を指定すると、発行したコマンドが、次のサウンドフレームを待たずに処理されるようになります。
</P>

<HR>
<H3><A name="note24-15" id="note24-15">Note 24-15: (Snd) SNDInstType に SND_INST_NULL 追加</A></H3>
<P>SND_ReadInstData 関数などで使用する SNDInstData 構造体の type メンバが取りうる値に、SND_INST_NULL が追加されました。<br>
なお、SND_INST_NULL が設定されているインストデータは、発音されません。
</P>

<HR>
<H3><A name="note24-16" id="note24-16">Note 24-16: (WM) 「ワイヤレス通信ライブラリ解説」の更新</A></H3>
<P>「ワイヤレス通信ライブラリ解説」(AboutWirelessManager.pdf) に内部状態の CLASS1 ステートに関する記述を加筆しました。
</P>

<HR>
<H3><A name="note24-17" id="note24-17">Note 24-17: (WM) 切断タイミングによる不具合の修正</A></H3>
<P>NITRO-SDK 2.0 RC5 での修正により、WM_StartMP 関数を呼び出す前に子機が接続・切断した場合に親機の ARM7 が不正な処理を行う、
という不具合を NITRO-SDK 2.0 で修正しましたが、不十分でしたので、これを正しく修正しました。
</P>

<HR>
<H3><A name="note24-18" id="note24-18">Note 24-18: (WM) WM_StartScanEx関数の不具合修正</A></H3>
<P>WM_StartScanEx関数で指定されたコールバック関数に渡される引数のAPIIDが、WM_StartScan関数の場合のAPIIDと同一だったため、
両者の判別ができないという問題がありました。（結果として2つのAPIを使い分ける事ができませんでした）<br>
この不具合を修正しました。
</P>

<HR>
<H3><A name="note24-19" id="note24-19">Note 24-19: (WM) 切断処理に関する不具合の修正</A></H3>
<P>NITRO-SDK 2.0 正式版から発生している不具合として、切断時に切断する相手が通信不能な状態になっていると、
切断に失敗して無線ライブラリの内部状態が不整合を起こすという問題があり、これに関係して、
通信中にデバッガでブレークした際に通信相手に正常にタイムアウトによる切断の通知が行われないという不具合がありましたが、
これらの不具合を修正しました。
</P>

<HR>
<H3><A name="note24-20" id="note24-20">Note 24-20: (WM) DS ワイヤレスプレイで WEP Key を使用するデモの追加</A></H3>
<P>DS ワイヤレスプレイにおいては、接続時の通信だけは WEP Key で暗号化することが可能となっています。<br>
これを行うデモを wm/wep-1 として追加しました。
</P>


<HR>
<H3><A name="KnownIssues_2_01_pr" id="KnownIssues_2_01_pr">SDK 2.1 PRでの既知の問題点</A></H3>
<P>　ありません。</P>



<HR>
<H2 style="line-height: 0"><A name="sdk_2_00" id="sdk_2_00">■ NITRO-SDK Version 2.0 正式版</A></H2>
<DIV style="text-align: right">
<P style="line-height: 0">(2005/03/11)</P>
</DIV>

<HR>
<H3><A name="note23-01" id="note23-01">Note 23-01: (CTRDG) カートリッジ状態に関するリファレンスへの記述追加</A></H3>
<P>CTRDG_GetAgbMakerCode 関数および CTRDG_GetAgbGameCode 関数で返される値は
 CTRDG_Init 関数の呼び出し時に取得されたものであるという点を各関数リファレンスに明記しました。<br>
関連して、開発機材などでカートリッジを使用するにあたってはCTRDG_Init
関数の呼び出しより前にカートリッジ電源をONにしておく必要があるという点についても補足しました。
</P>

<HR>
<H3><A name="note23-02" id="note23-02">Note 23-02: (DevEnv) ソースコードの書式統一</A></H3>
<P>ライブラリおよびサンプルデモのソースコード全体で、インデントや改行に関する構文上の書式を統一しました。
</P>

<HR>
<H3><A name="note23-03" id="note23-03">Note 23-03: (DevEnv) ビルド済みDSプログラムのリファレンス追加</A></H3>
<P>$NitroSDK/bin 以下に収録されている各種DSプログラムのリファレンスを $NitroSDK/man/ja_JP/romfiles 以下に
 [ビルド済みDSプログラム] のカテゴリとして追加しました。
</P>

<HR>
<H3><A name="note23-04" id="note23-04">Note 23-04: (DevEnv) 関数リファレンスでの引数範囲の明記</A></H3>
<P>関数リファレンスにおいて、引数に与えることのできる値の範囲が不明瞭なものについて適宜記述を追加しました。
</P>

<HR>
<H3><A name="note23-05" id="note23-05">Note 23-05: (DevEnv) 弱いシンボルの宣言用マクロ SDK_WEAK_SYMBOL を定義</A></H3>
<P>弱いシンボル(weak symbol)を宣言するための修飾子としてマクロ SDK_WEAK_SYMBOL を定義しました。CodeWarrior を使用する場合は<br>
<br>
#define SDK_WEAK_SYMBOL __declspec(weak)<br>
<br>
と定義されています。
</P>

<HR>
<H3><A name="note23-06" id="note23-06">Note 23-06: (FS) 圧縮オーバーレイのロード時の不具合の修正</A></H3>
<P>RC5 での修正により、NITRO_COMPRESS を指定してビルドしたアプリケーションでオーバーレイをロードする関数を呼び出した際に
内部判定のミスで正しく処理が完了しないという不具合があり、これを修正しました。
</P>

<HR>
<H3><A name="note23-07" id="note23-07">Note 23-07: (MI) データ圧縮時のアラインメント調整オプションの追加</A></H3>
<P>ntrcompでデータを圧縮する際に、出力ファイルサイズが4の倍数になるよう末尾を
 0 で調整するオプション '-A4' が追加されました。
</P>

<HR>
<H3><A name="note23-08" id="note23-08">Note 23-08: (PRC) 関数内部での正当性判定の修正</A></H3>
<P>PRC_GetRecognizedEntriesEx_Superfine 関数において一部の SDK_ASSERT の正当性判定条件が厳しすぎましたので、
これを適正な条件に修正しました。</P>

<HR>
<H3><A name="note23-09" id="note23-09">Note 23-09: (PRC) 関数の返り値の型の変更</A></H3>
<P>以下の関数群の返り値の型を void から BOOL に変更し、成功・失敗を返すように変更しました。
<UL>
<LI>PRC_InitPrototypeDB* 関数
<LI>PRC_InitInputPattern* 関数
<LI>PRC_ResampleStrokes_* 関数
</UL>
</P>

<HR>
<H3><A name="note23-10" id="note23-10">Note 23-10: (WM) 切断タイミングによる不具合の修正</A></H3>
<P>RC5 での修正により、WM_StartMP 関数を呼び出す前に子機が接続・切断した場合に親機の ARM7 が不正な処理を行う、
という不具合が発生していましたが、これを修正しました。
なお、WM_StartParent 関数が成功してから直ちに WM_StartMP 関数を呼んでいるアプリケーションでは、この問題はまず発生しません。
</P>

<HR>
<H3><A name="note23-11" id="note23-11">Note 23-11: (WM) WM_StartMPEx 関数の minPollBmpMode を使用した場合の不具合修正</A></H3>
<P>RC5 での変更で、WM_StartMPEx 関数の minPollBmpMode を TRUE に設定した場合に
正常に送信が出来ないという不具合が発生していましたが、これを修正しました。</P>

<HR>
<H3><A name="note23-12" id="note23-12">Note 23-12: (WM) 通信内容が消えてしまう不具合の修正</A></H3>
<P>電波状態によって、ごく稀に通信内容が消えてしまう不具合がありましたが、これを修正しました。
</P>

<HR>
<H3><A name="note23-13" id="note23-13">Note 23-13: (WM) port 通信用送信キューの段数の変更</A></H3>
<P>従来は port 通信用の送信キューを 64 段用意していましたが、使用状況から考えて過剰な量と判断し、
ワイヤレス通信ライブラリの使用メモリを削減するために 32 段へと変更しました。<br>
なお、Data Sharing 1 組につき、送信キューは高々 2 段しか使用しません。
</P>

<HR>
<H3><A name="note23-14" id="note23-14">Note 23-14: (WM) WMPortSendCallback 構造体の変更</A></H3>
<P>WM_SetMPData* 関数のコールバックに渡される構造体を変更しました。<br>
従来は destBitmap に指定されていたものの、接続が切れている AID に関しては restBitmap フィールドの対応するビットの値が不定でしたが、
これを必ず 0 になるように変更しました。<br>
これに伴い、送信できた相手の AID のビットマップを格納する sentBitmap フィールドを新設しました。
未接続または切断されたために送信しなかった相手がいるかを確認するには、
destBitmap フィールドと sentBitmap フィールドを比較するようにしてください。</P>

<HR>
<H3><A name="note23-15" id="note23-15">Note 23-15: (WM) 状態チェックの修正と強化</A></H3>
<P>ARM7 のワイヤレス通信ドライバでの状態チェックを強化しました。<br>
これにより、以下の関数のコールバックに WM_ERRCODE_ILLEGAL_STATE のエラーが返りうるようになりました。<br>
<UL>
<LI>WM_MeasureChannel 関数
<LI>WM_StartParent 関数
<LI>WM_StartScan 関数
<LI>WM_StartConnect 関数
<LI>WM_EndMP 関数
<LI>WM_EndParent 関数
</UL>
また、WM_SetWEPKeyEx 関数内部でのの wepkeyid の範囲チェックを修正しました。
</P>

<HR>
<H3><A name="note23-16" id="note23-16">Note 23-16: (WM) WM_EndKeySharing 関数の返り値修正</A></H3>
<P>WM_EndKeySharing 関数が返り値として常にエラーを返していましたが、これを修正しました。</P>

<HR>
<H3><A name="note23-17" id="note23-17">Note 23-17: (WM) WH サンプルデモの修正</A></H3>
<P>$NitroSDK/build/demos/wireless_shared/wh 以下のサンプルソースコードに対し、以下の修正を行いました。
<UL>
<LI>ガイドラインに準拠し、起動時ごとにTGIDの初期値がばらつくよう処理を追加しました。
<LI>受信ビーコンに対するMBフラグ有無の判定を追加しました。
<LI>親機ビーコンのユーザーゲーム情報を設定する WH_SetUserGameInfo 関数を追加しました。
</UL>
</P>

<HR>
<H3><A name="KnownIssues_2_00" id="KnownIssues_2_00">SDK 2.0 正式版での既知の問題点</A></H3>
<P>　ありません。</P>




<HR>
<H2 style="line-height: 0"><A name="sdk_2_00_rc5" id="sdk_2_00_rc5">■ NITRO-SDK Version 2.0 RC5</A></H2>
<DIV style="text-align: right">
<P style="line-height: 0">(2005/02/25)</P>
</DIV>

<HR>
<H3><A name="note22-01" id="note22-01">Note 22-01: (ARM7) コンポーネントの追加と廃止</A></H3>
<P>VRAM上に無線通信機能の実行コードを配置する特殊コンポーネントとして ichneumon が新規に追加されました。
詳細については同時に追加されましたドキュメント AboutComponents.pdf を参照して下さい。
また、NITRO-SDK 2.0 RC4 までに提供しておりました idle、ferret コンポーネントについては今後のサポートを廃止します。</P>


<HR>
<H3><A name="note22-02" id="note22-02">Note 22-02: (CHT) サンプルデモの修正</A></H3>
<P>ピクトチャットサーチ機能を用いる例として提供しておりますサンプルにて、このサンプルが用いる<br>
"無線制御部共通モジュールであるWC内のピクトチャットサーチ機能を有効/無効にする関数"の名称の綴り間違いを修正しました。</P>

<HR>
<H3><A name="note22-03" id="note22-03">Note 22-03: (DevEnv) 厳格な警告オプションへ対応するソースコード修正</A></H3>
<P>ライブラリおよび各種サンプルデモにおいて、一部の厳格な警告オプションへも対応できるようにコードを修正しました。<br>
サイズが等しく符号の有無が異なる整数型同士での変換を暗黙に行っていた個所などについて改善がなされています。
</P>

<HR>
<H3><A name="note22-04" id="note22-04">Note 22-04: (FS) overlay-staticinitサンプルデモの追加</A></H3>
<P>C/C++言語のソース内で static initializer を明示的に追加するサンプルとして、overlay-staticinit サンプルデモを追加しました。</P>

<HR>
<H3><A name="note22-05" id="note22-05">Note 22-05: (FS) アーカイブのサスペンド状態に関する内部異常の修正</A></H3>
<P>アーカイブが一度アンロードされ再びロードされる際に内部状態が部分的にサスペンド状態へ変更されてしまい、<br>
連続発行して保留された非同期コマンドが処理されないという不具合があり、この問題を修正しました。</P>

<HR>
<H3><A name="note22-06" id="note22-06">Note 22-06: (FS) FS_LoadOverlayImage 関数の内部エラー判定修正</A></H3>
<P>FS_LoadOverlayImage 関数および FS_LoadOverlayImageAsync 関数の内部処理において、
指定したオーバーレイに対応するファイルが正しく開けた場合にはその後の FS_ReadFile
関数の結果を反映せず常にTRUE を返すという動作でしたが、これを反映するよう修正しました。
</P>

<HR>
<H3><A name="note22-07" id="note22-07">Note 22-07: (GX) GX_GetOBJVRamModeBmp 関数の返り値の型訂正</A></H3>
<P>GX_GetOBJVRamModeBmp関数の返り値がGXOBJVRamModeChar型でしたが、これをGXOBJVRamModeBmp型に訂正しました。</P>

<HR>
<H3><A name="note22-08" id="note22-08">Note 22-08: (GX) GXBg23ControlAffine 構造体の無効なメンバの削除</A></H3>
<P>GXBg23ControlAffine 構造体に無効なメンバ colorMode が含まれている不具合がありました。
アフィンBGでは256色固定でありこのメンバは無効なため、GXBg23ControlAffine 構造体 から colorMode の定義を削除しました。</P>

<HR>
<H3><A name="note22-09" id="note22-09">Note 22-09: (GX) G2_GetBG3Control* 関数, G2S_GetBG3Control* 関数の不具合修正</A></H3>
<P>G2_GetBG3Control* 関数, G2S_GetBG3Control* 関数を使用した際に不正なアドレスへのアクセスが発生する不具合があり、この不具合を修正しました。</P>


<HR>
<H3><A name="note22-10" id="note22-10">Note 22-10: (GX) VRAM割り当てを試行する関数群の追加</A></H3>
<P>新設された<A href="#note22-40">WVRライブラリ</a>(詳細はNote 22-40)及び <A href="#note22-01">ichneumon コンポーネント</a>(詳細はNote 22-01)により、
VRAM上でARM7側無線ライブラリを駆動する機能が提供されましたが、
無線ライブラリが駆動している際にそのVRAMバンクを別用途に使用することはできません。
これまでに提供しております GX_SetBankFor* 関数群はWVRライブラリによってロックされているVRAMバンクの割り当て直しを行うと
OS_Panic 関数を呼び出して停止するように修正されました。また、別途VRAMバンク割り当てを試行する GX_TrySetBankFor* 関数群が新規追加されました。<br>
なお、この追加に関連して、GX_Init 関数の呼び出しより前に OS_Init 関数が呼び出されていることが必要となりましたので、この点に注意してください。</P>

<HR>
<H3><A name="note22-11" id="note22-11">Note 22-11: (MATH) code32.h による MATH_CountLeadingZeros 関数の inline への切り替えの不具合修正</A></H3>
<P>MATH_CountLeadingZeros 関数は ARM コード出力時には ARM プロセッサのclz 命令を使った inline 関数に、また、
THUMB コード出力時には clz と同等の動作をする関数に置き換わりますが、
NITRO_CODEGEN=THUMB でデフォルトのコードを THUMB コードにした状態で #include &lt;nitro/code32.h&gt; 
による出力コードの切り替えを行なっても、MATH_CountLeadingZeros 関数は inline 関数に切り替わりませんでした。<br>
この不具合を修正しました。
</P>

<HR>
<H3><A name="note22-12" id="note22-12">Note 22-12: (MB) DSダウンロードプレイ親機のビーコンへユーザデータを設定するインターフェイスの追加</A></H3>
<P>DSダウンロードプレイ親機の配信するビーコン中にユーザアプリがデータを設定する為のインターフェイスとして、以下の関数を追加しました。<br>
MB_FakeInit 関数を使用する擬似マルチブート子機は、このインタフェースを通して接続前の親機からユーザ固有の付随情報を受信することが出来ます。<br>
このデータの有無は、IPLのDSダウンロード子機の動作には一切影響を与えません。</P>
<UL>
<LI>MB_SetSendVolatCallback 関数
<LI>MB_SetUserVolatData 関数
<LI>MB_GetUserVolatData 関数
</UL>
<P>
</P>
<HR>
<H3><A name="note22-13" id="note22-13">Note 22-13: (MI) 圧縮関数の追加</A></H3>
<P>DS アプリケーション上でデータを実行時に圧縮するための、以下の関数を追加しました。</P>
<UL>
<LI>MI_CompressRL 関数
<LI>MI_CompressLZ 関数
<LI>MI_CompressHuffman 関数
</UL>
<P>
</P>

<HR>
<H3><A name="note22-14" id="note22-14">Note 22-14: (MI) AGBカートリッジ用のROMアクセスサイクル設定関数の追加</A></H3>
<P>AGBカートリッジ用のROMアクセスサイクル設定関数 MI_SetAgbCartridgeFastestRomCycle 関数を追加しました。<br>
これは DS での 8-4アクセスの設定を行なう関数で、AGB での 3-1 ウェイトに相当します。</P>

<HR>
<H3><A name="note22-15" id="note22-15">Note 22-15: (MI) 起動時の多重DMAの不具合への対処</A></H3>
<P><A href="#note21-33">「Note 21-33: (MI) 多重DMAの不具合への対処」</a>に示したように DMA0 を使用した後はダミーの空 DMA 転送を行なっていますが、
DMA0 を使う初回のDMA転送に対処するために、OS_Init 関数の時点でもダミーの空DMA転送を行なうよう処理を追加しました。</P>

<HR>
<H3><A name="note22-16" id="note22-16">Note 22-16: (MIC) 自動サンプリングエンジンの最適化</A></H3>
<P>マイクの自動サンプリングについて、ARM7内で行われる処理を最適化しました。<br>
このことにより、mic-1サンプルデモでサンプリングレートを32kHzにした場合にフリーズするという不具合が修正されました。</P>

<HR>
<H3><A name="note22-17" id="note22-17">Note 22-17: (OS) 割り込み概要ページへのリンク追加</A></H3>
<P>リファレンスの、OSの概要ページに「割り込み概要」ページへのリンクを追加しました。<br>
割り込み概要ページ自体は NITRO-SDK2.0 RC4 の時点で追加されていましたが、そのページへのリンクがありませんでした。</P>

<HR>
<H3><A name="note22-18" id="note22-18">Note 22-18: (OS) スレッドのスケジューリング制御関数の追加</A></H3>
<P>OS ライブラリに、スレッドのリスケジューリングを一時停止および再開を制御する関数 OS_DisableScheduler 関数と OS_EnableScheduler 関数を追加しました。</P>

<HR>
<H3><A name="note22-19" id="note22-19">Note 22-19: (OS) キャッシュのロックダウン関数の不具合修正</A></H3>
<P>キャッシュが破棄されないようにロックする DC_LockdownRange 関数, IC_LockdownRange 関数に、
一部ロックされない領域が残る可能性があるという不具合があり、この不具合を修正しました。</P>

<HR>
<H3><A name="note22-20" id="note22-20">Note 22-20: (OS) ロックダウンされたキャッシュの解放関数を追加</A></H3>
<P>キャッシュのロックダウンされたブロックを解放し、再びキャッシュの置き換えを発生可能にする為、以下の関数を追加しました。</P>
<UL>
<LI>DC_UnlockdownAll 関数
<LI>DC_Unlockdown 関数
<LI>IC_UnlockdownAll 関数
<LI>IC_Unlockdown 関数
</UL>
<P>
</P>

<HR>
<H3><A name="note22-21" id="note22-21">Note 22-21: (OS) OS_ResetSystem 関数でのリセット時キャッシュ不具合の修正</A></H3>
<P>OS_ResetSystem 関数内の、DC_FlushAll 関数を呼び出している個所の後で DC_WaitWriteBufferEmpty 関数を呼ぶように処理を追加しました。<br>
これは、リセット以前に残っていたキャッシュが、OS_ResetSystem　関数で読み込んだプログラムデータを後から上書きしてしまうという可能性があったためです。</P>

<HR>
<H3><A name="note22-22" id="note22-22">Note 22-22: (OS) OS_GetITCMAddress 関数の追加</A></H3>
<P>命令TCMのベースアドレスを取得するOS_GetITCMAddress 関数を追加しました。この関数の返り値は常に定数 0x01FF8000 を返します。</P>


<HR>
<H3><A name="note22-23" id="note22-23">Note 22-23: (PM) LCDオフ状態からスリープモードに移行したあとの復帰処理の変更</A></H3>
<P>LCDオフ状態からスリープモードに移行し、その後スリープモードから抜けた時にグラフィックモードの状態復帰処理に不具合があり、
画面が表示されない場合がありました。これを、LCDオフの状態に戻るようにしました。<br>
アクティブモードからスリープモードに遷移した場合の復帰には影響はありません。</P>

<HR>
<H3><A name="note22-24" id="note22-24">Note 22-24: (SND) サウンドライブラリの更新</A></H3>
<P>NITRO-SDK で配布するサウンドライブラリが2005年02月22日版となりました。</P>

<HR>
<H3><A name="note22-25" id="note22-25">Note 22-25: (WM) Sequential 通信におけるパケット複製の不具合修正</A></H3>
<P>MP 通信の 8 〜 15 番 port を使用して行う Sequential 通信において、特定の状況でパケットが複製されてしまう不具合があり、これを修正しました。</P>
<UL>
<LI>1. Sequential 通信を使用している
<LI>2. port 番号が等しい複数のパケットがパックされて 1 回のMP通信で送信される
<LI>3. 上記 2. の通信にて、行きは成功したが帰りが失敗した
</UL>
<P>
上記すべてを満たす場合に、次の再送で同一のパケットを新規パケットとして受信してしまいます。<br>
DataSharing においては、停止や同期ずれなどの形で顕在化します。<br>
<br>
なお、複数のパケットが1つのペイロードにパックされないとこの問題は発生しませんので、double mode を使用していない場合もしくは
 WM_SetParentParam 関数で設定した最大送信サイズが DataSharing のパケットを同時に1つしか送れないサイズであった場合には、
 この問題が発生することはありません。</P>

<HR>
<H3><A name="note22-26" id="note22-26">Note 22-26: (WM) minPollBmpMode 時の Sequential 通信における制限事項の明記</A></H3>
<P>WM_StartMPEx 関数のリファレンスに制限事項の記載を追加しました。<br>
この関数で minPollBmpMode 引数を TRUE にした状態で Sequential 通信を行う場合は、使用中の全ての Sequential 通信の port において、
60 フレーム以上データを受け取らない子機が存在しないよう、定期的に全子機に対して keep alive データを送信するなどの対応を行ってください。</P>

<HR>
<H3><A name="note22-27" id="note22-27">Note 22-27: (WM) WM_PortSendCallback 構造体 restBitmap メンバに関する不具合修正</A></H3>
<P>WM_SetMPDataToPort* 関数が送信に失敗した場合に発生する WM_ERRCODE_SEND_FAILED の通知コールバックにおいて、
引数に与えられる restBitmap メンバに正しい値が入っていない不具合があり、これを修正しました。</P>

<HR>
<H3><A name="note22-28" id="note22-28">Note 22-28: (WM) WM_Reset 関数に関する不具合修正</A></H3>
<P>無線通信中の親機が子機と接続している状態でWM_Reset関数を呼び出すと、呼び出した状況によっては長い時間(通常 4 秒、
WM_SetLifeTime 関数によって改変可能)処理が完了しない場合があるという不具合があり、これを修正しました。</P>

<HR>
<H3><A name="note22-29" id="note22-29">Note 22-29: (WM) WM_IsBssidEqual 関数, WM_CopyBssid 関数の動作修正と16bit版の追加</A></H3>
<P>WM_IsBssidEqual 関数および WM_CopyBssid 関数の引数が暗黙的に16bit境界整合されたアドレスを要求し、
そのため奇数のアドレスに対して正しく動作しないという不具合があり、これを修正しました。<br>
また、従来と同等の機能を持つ WM_IsBssidEqual16 関数および WM_CopyBssid16 関数を新たに追加しました。</P>

<HR>
<H3><A name="note22-30" id="note22-30">Note 22-30: (WM) WM非同期関数のコールバックと途中通知の順番についての注意書きの追加</A></H3>
<P>WM_StartParent 関数および WM_StartConnect 関数について、
非同期処理が正常に完了したことを示すコールバックより先に接続完了後に起こるイベントの通知がコールバックされることがあり得る、
という点について注意書きをリファレンスマニュアルに追記しました。</P>

<HR>
<H3><A name="note22-31" id="note22-31">Note 22-31: (WM) 再送時に完了コールバックが来なくなる不具合の修正</A></H3>
<P>特定のパターンでデータを送信しようとした場合に再送が発生すると、送信すべきデータが消失し、
送信完了コールバックも返ってこなくなる不具合があり、これを修正しました。<br>
この問題は、ブロードキャスト通信と特定の子機相手の通信を同時に行っている場合に発生することがあります。</P>

<HR>
<H3><A name="note22-32" id="note22-32">Note 22-32: (WM) WH サンプルデモの不具合修正</A></H3>
<P>$NitroSDK/build/demos/wireless_shared/wh 以下のサンプルソースコードに対し、以下の修正を行いました。</P>
<UL>
<LI>WH_SetReceiver 関数内でのWM_SetPortCallback 関数呼び出しで返り値の比較に WM_ERRCODE_SUCCESS を使用するよう修正しました。
</UL>

<HR>
<H3><A name="note22-33" id="note22-33">Note 22-33: (WM) WFS サンプルデモの不具合修正</A></H3>
<P>$NitroSDK/build/demos/wireless_shared/wfs 以下のサンプルソースコードに対し、以下の修正を行いました。</P>
<UL>
<LI>WFS_InitParent 関数および WFS_InitChild 関数において、初期化処理完了より前に内部状態が更新されることによって
  MP通信コールバック時に不正動作するという不具合あり、これを修正しました。<br>
  なお、この問題は WM ステートの READY 以降かつ PARENT/CHILD 以前の状態で WFS の初期化を行っている場合には発生しません。<br>
<LI>子機からの異なる内容のReadFile要求が複数発生する場合に、タイミングによっては親機が任意の子機への応答を行わなくなることがあり、これを修正しました。
</UL>

<HR>
<H3><A name="note22-34" id="note22-34">Note 22-34: (WM) 新規関数の追加</A></H3>
<P>より詳細な設定の元に処理を行う以下のAPIが追加されました。</P>
<UL>
<LI>WM_StartScanEx 関数
<LI>WM_StartConnectEx 関数
<LI>WM_SetWEPKeyEx 関数
</UL>
なお、WM_StartConnectEx 関数の追加にともない従来の WM_StartConnect 関数はインライン化されました。<br>
以前のバージョンの NITRO-SDK でビルドされつつその内部で WM_StartConnect 関数を呼び出しているオブジェクトファイルまたはライブラリファイルは、
プログラムへのリンク時に関数未定義のエラーとなりますので再ビルドする必要がある点に注意してください。<br>
<HR>
<H3><A name="note22-35" id="note22-35">Note 22-35: (WM) MP通信開始時の内部動作の改善</A></H3>
<P>WM_StartMP(Ex)関数によってMP通信を開始した際、この関数のコールバックが呼ばれる前にMP通信の途中通知がコールバックされる場合がありました。
これを修正し、WM_StartMP(Ex)関数のコールバックが発生する前にはMP関連の途中通知が一切行われないよう内部動作を変更しました。
この変更により、子機が接続・切断を繰り返した際に、まれにARM7の動作が停止するという不具合が修正されました。
また、WM_StartMP(Ex)関数を呼び出してコールバックが呼び出される前の状態の時に、子機が親機から切断されると、
その後ライブラリが正常に動作しなくなる可能性が発見されました。この問題を修正しました。</P>

<HR>
<H3><A name="note22-36" id="note22-36">Note 22-36: (WM) 親機開始時の内部動作の不具合修正</A></H3>
<P>無線通信の親機になる際、正常に親機になったにも関わらずビーコンが送信されない現象がまれに発生するという不具合があり、この問題を修正しました。</P>

<HR>
<H3><A name="note22-37" id="note22-37">Note 22-37: (WM) WM_SetMPData* 関数のコールバックに関する変更</A></H3>
<P>従来は、通信終了時に送信キューに溜まっていた送信データに関しては対応する WM_SetMPData* 関数にコールバックを返していませんでしたが、
必ずコールバックが返るように変更しました。これにより、WM の全ての非同期 API はコールバックを最低一度は返すようになりました。</P>

<HR>
<H3><A name="note22-38" id="note22-38">Note 22-38: (WM) 接続許容台数の上限付近での新規接続時の不具合修正</A></H3>
<P>無線親機が接続許容台数に近い子機と接続している状態で新たに複数の子機に接続された際に許容台数を越える子機と接続してしまい、
その後のライブラリの動作に不具合が生じる可能性がある、という問題が確認されました。この問題を修正しました。
</P>

<HR>
<H3><A name="note22-39" id="note22-39">Note 22-39: (WM) 解説ドキュメントの正式公開</A></H3>
<P>ワイヤレス通信ライブラリの解説ドキュメントが、正式版として docs/TechnicalNotes/AboutWirelessManager.pdf に公開されました。
</P>

<HR>
<H3><A name="note22-40" id="note22-40">Note 22-40: (WVR) 無線ドライバ駆動制御ライブラリの追加</A></H3>
<P><A href="#note22-01">ichneumon コンポーネント</a>(詳細はNote 22-01)の追加に伴い、
このコンポーネント使用時にVRAM上への無線関連実行コードの配置及び起動・停止及び実行コードの退避を制御するライブラリとして、
WVRライブラリが新規に追加されました。</P>


<HR>
<H3><A name="KnownIssues_2_00_rc5" id="KnownIssues_2_00_rc5">SDK 2.0 RC5 での既知の問題点</A></H3>
<P>　ありません。</P>


<HR>
<H2 style="line-height: 0"><A name="sdk_2_00_rc4" id="sdk_2_00_rc4">■ NITRO-SDK Version 2.0 RC4</A></H2>
<DIV style="text-align: right">
<P style="line-height: 0">(2005/01/14)</P>
</DIV>
<HR>
<H3><A name="note21-01" id="note21-01">Note 21-01: (CHT) ピクトチャット関連ライブラリの追加</A></H3>
<P>　ピクトチャットに関連したAPI群を扱うライブラリとして、CHTライブラリを新設しました。CHTライブラリには以下の関数が含まれます。</P>
<UL>
<LI>CHT_IsPictochatParent
<LI>CHT_GetPictochatRoomNumber
<LI>CHT_GetPictochatClientNum
</UL>
<P><FONT color="#ff0033">　なお、2004年1月13日現在、DSプログラムガイドラインには、ピクトチャット関連ライブラリの使用についての記述が含まれていません。本ライブラリの使用を検討される場合、まずは弊社業務技術部までご連絡下さい。
</FONT></P>
<HR>
<H3><A name="note21-02" id="note21-02">Note 21-02: (MATH) MATH カテゴリの新設</A></H3>
<P>
　数学関数用のカテゴリとして MATH が新設されました。
min, max といったユーティリティ関数のほかに、ARM9 で高速に整数範囲での log2(x) を求める MATH_ILog2 などが含まれます。
</P>

<HR>
<H3><A name="note21-03" id="note21-03">Note 21-03: (MATH) 乱数用関数の追加</A></H3>
<P>
　線形合同法による乱数ライブラリとして、以下の関数が追加されました。
</P>
<UL>
<LI>MATH_InitRand16
<LI>MATH_InitRand32
<LI>MATH_Rand16
<LI>MATH_Rand32
</UL>
<P>
またデモとして、$NitroSDK/build/demos/math/rand_lc が追加されています。
</P>

<HR>
<H3><A name="note21-04" id="note21-04">Note 21-04: (MB) 擬似 DS ダウンロードプレイ子機の不具合修正</A></H3>
<P>　擬似 DS ダウンロードプレイ子機ライブラリ MB_FakeChild において、リトライ可能な
MP 通信エラーが発生した際に、FATAL なエラーとして通信を切断してしまう不具合がありました。
この不具合は修正されました。</P>

<HR>
<H3><A name="note21-05" id="note21-05">Note 21-05: (MB) MBライブラリ終了時の内部スレッド不具合の修正</A></H3>
<P>　MB_ReadSegment 関数の呼び出しで内部スレッドを使用するように設定された場合、
MB_End 関数によるライブラリ終了時に内部スレッドの状態管理が正しく行われず、
再初期化後の動作が異常になるという不具合があり、この問題を修正しました。</P>

<HR>
<H3><A name="note21-06" id="note21-06">Note 21-06: (MB) MBライブラリ終了時の内部動作修正</A></H3>
<P>
　MB_End 関数またはMB_EndToIdle関数でMBライブラリを終了させる際、終了処理中に発生する
MB 内部イベントとそのタイミングによっては MB ライブラリ終了後に不正な動作をしてしまう場合があり、
この問題を修正しました。
</P>

<HR>
<H3><A name="note21-07" id="note21-07">Note 21-07: (MB) エントリー子機に対し随時データの先行配信するデモを追加</A></H3>
<P>　マルチブートデモで使用している以下のソースの中に MBP_USING_PREVIOUS_DOWNLOAD
スイッチを追加しました。</P>
<UL>
<LI>$NitroSDK/build/demos/wirelessShared/mbp 
</UL>
<P>　このスイッチがONの場合には、エントリーした子機に対して随時先行してデータのダウンロードを開始します。
このスイッチがONの場合のシーケンスでは、子機の接続タイミングによっては、
ダウンロードの待ち時間を少なく抑えられる可能性があります。</P>

<HR>
<H3><A name="note21-08" id="note21-08">Note 21-08: (WM) 無線ライブラリへの機能追加</A></H3>
<P>　無線通信における使用許可チャンネルの有無を確認する関数、WM_IsExistAllowedChannel を追加しました。 この関数は WM ライブラリの内部状態に依存せずに、許可チャンネルの有無のみを判定します。</P>

<HR>
<H3><A name="note21-09" id="note21-09">Note 21-09: (WM) WM非同期関数群へのより厳密な排他制御の追加</A></H3>
<P>　WM非同期関数群は通常は非同期処理中に他の関数を呼び出すことは基本的に動作が保証されませんが、
WM_SetMPData( ToPort(Ex) ) 関数のみは連続した呼び出しによる送信データの予約が可能な仕様となっています。
この際、10回を越える連続呼び出しを行うと実際に送信されるデータが壊れる可能性がありました。
この為、より厳密な排他処理を行うように修正しました。 修正の結果、データが壊れるような送信要求を行った場合に
WM_SetMPData( ToPort(Ex) ) 関数にはWM_ERRCODE_FIFO_ERROR が明示的に返されるように仕様が変更されました。</P>

<HR>
<H3><A name="note21-10" id="note21-10">Note 21-10: (WM) MP 通信のパワーマネージメント設定の修正</A></H3>
<P>
　MP 通信において、ごく稀なタイミングで、子機のパワーセーブの時間が通常より長くなることがありましたが、
これを修正しました。
</P>

<HR>
<H3><A name="note21-11" id="note21-11">Note 21-11: (WM) WFSサンプルの改善</A></H3>
<P>
　無線を使用してFSを実現するサンプルデモにおいて、
内部で設定した受信コールバック関数がWFS_Endを呼び出した際にクリアされず、
意図しないタイミングで内部コールバック関数が呼び出されてしまう問題がありました。
この問題点を修正しました。
</P>

<HR>
<H3><A name="note21-12" id="note21-12">Note 21-12: (WM) 親機の使用するチャンネルを決定するデモの修正</A></H3>
<P>
　無線デモ中で親機がチャンネルを決定する際に、使用チャンネルをより分散させるため、
電波使用率が同じチャンネルが複数あった場合に、乱数を使用してチャンネルを決定するように修正されました。

この処理は以下のデモに反映されています。
</P>

<UL>

<LI>$NitroSDK/build/demos/mb/mbm
<LI>$NitroSDK/build/demos/wireless_shared/wh
</UL>

<HR>
<H3><A name="note21-13" id="note21-13">Note 21-13: (FS)ファイルシステムドキュメントの更新</A></H3>
<P>
ファイルシステムライブラリについて解説したドキュメント AboutFileSystem.rtf の内容が全面的に更新され、
AboutFileSystem.pdf として追加されました。
</P>

<HR>
<H3><A name="note21-14" id="note21-14">Note 21-14: (GX) 描画用レジスタのリード関数を追加</A></H3>
<P>
　描画用レジスタをリードするGet関数が追加されました。追加された関数は以下の通りです。
</P>
<UL>
<LI>GX*_GetVisibleWnd
<LI>GX*_GetVisiblePlane
<LI>GX*_GetOBJVRamModeChar
<LI>GX*_GetOBJVRamModeBmp
<LI>GX*_GetMasterBrightness
<LI>GX*_GetDispCnt
<LI>G2*_GetWndOutsidePlane
<LI>G2*_GetWndOBJInsidePlane
<LI>G2*_GetWnd1InsidePlane
<LI>G2*_GetWnd0InsidePlane
<LI>G2*_GetOBJAffine
<LI>G2*_GetBG0Control
<LI>G2*_GetBG1Control
<LI>G2*_GetBG2ExtMode
<LI>G2*_GetBG2Control*
<LI>G2*_GetBG3Control*
</UL>
<HR>
<H3><A name="note21-15" id="note21-15">Note 21-15: (GX) サブ2Dエンジン用ビットマップOBJのVRAM拡張フラグの定義を削除</A></H3>
<P>
　サブ2Dエンジンには存在しないビットマップOBJのVRAM拡張フラグが define 値として定義されているという不具合があり、
以下の定義が削除されました。
</P>
<UL>
<LI>REG_GXS_DB_DISPCNT_EXOBJ_BM_MASK
<LI>REG_GXS_DB_DISPCNT_EXOBJ_BM_SHIFT
</UL>
<P>
　またGXS_SetOBJVRamModeBmp関数にて、このフラグを使用するような引数を ASSERT でチェックするよう修正されました。
</P>

<HR>
<H3><A name="note21-16" id="note21-16">Note 21-16: (GX) データサイズによる転送方法の判別</A></H3>
<P>　GX でのデータ転送において、データサイズが小さい場合には DMA を使用せず
CPU でコピーするよう修正されました。 32bit コピーでは48バイト以下、16bit
コピーでは 28バイト以下の同期処理での転送は常に CPU で処理されます。</P>

<HR>
<H3><A name="note21-17" id="note21-17">Note 21-17: (GX) GX_SetBankForBGEx使用時のASSERTの不具合修正</A></H3>
<P>　GX_SetBankForBGEx 関数を使用して VRAM のバンク設定を行なった場合、 DEBUG
ビルド時不正なアドレスにデータをロードした際にも ASSERT による警告が出ないという不具合がありました。
この不具合は修正されました。</P>

<HR>
<H3><A name="note21-18" id="note21-18">Note 21-18: (GX) GX_ResetCapture関数を追加</A></H3>
<P>
　GX_SetCapture 関数で設定したキャプチャイネーブルフラグは通常キャプチャ完了後に自動的にリセットされますが、
それとは別に即リセットできる解除関数としてGX_ResetCapture関数が追加されました。
ただしキャプチャ途中に途中中断することはできませんので注意してください。
</P>

<HR>
<H3><A name="note21-19" id="note21-19">Note 21-19: (CARD,CTRDG) 強制停止処理の改良</A></H3>
<P>　DS カード及びカートリッジの活線挿抜を検知した際に行われる強制停止処理において、無線通信中であった場合に電波送信が完全に停止しない場合がありました。 また、LED　の点灯状態が不定となる場合がありました。これらの問題を修正しました。</P>

<HR>
<H3><A name="note21-20" id="note21-20">Note 21-20: (CARD) CARD_ReadRomID関数の廃止</A></H3>
<P>
　ユーザアプリケーションから使用する用途が無いため、CARD_ReadRomID 関数は廃止されました。
</P>

<HR>
<H3><A name="note21-21" id="note21-21">Note 21-21: (CARD) NITRO-CARDアクセス許可状態の設定関数の追加</A></H3>
<P>　ワイヤレスダウンロードで起動した子機プログラムなどが不用意に NITRO-CARD
へアクセスすることを防止するため、 アクセス許可状態の取得・設定関数を追加しました。
NITRO-CARDから起動していないアプリケーションが NITRO-CARD へアクセスする場合には、プログラミングガイドラインでの規定に従って判定したのちに
CARD_Enable 関数を呼び出す必要があります。</P>

<HR>
<H3><A name="note21-22" id="note21-22">Note 21-22: (TP) TP_GetLatestRawPointInAuto 関数の動作を修正</A></H3>
<P>　TP_GetLatestRawPointInAuto 関数において、 過去１フレームの間にサンプリングされたすべての値がタッチ
ON かつ INVALID であった場合にタッチ OFF として扱われていましたが、 この場合にも
validity の値を設定してタッチ ON として返されるよう 修正されました。</P>

<HR>
<H3><A name="note21-23" id="note21-23">Note 21-23: (TP) タッチパネルが LCD から受けるノイズへの対策を強化</A></H3>
<P>
　特定のタイミングでタッチパネルのサンプリングをおこなった場合に、ハードウェアによっては LCD からのノイズの影響を強く受け
る組み合わせがあったため、サンプリング時のノイズ対策の強化をおこないました。
</P>

<HR>
<H3><A name="note21-24" id="note21-24">Note 21-24: (MIC) 自動サンプリング中にサンプリングレートを調整するAPIの追加</A></H3>
<P>
　自動サンプリング実行中に、サンプリングを停止することなく動的にサンプリングレートを変更する以下の API を追加しました。
</P>
<UL>
<LI>MIC_AdjustAutoSampling
<LI>MIC_AdjustAutoSamplingAsync
</UL>
<P>　また、サンプルデモ mic-1 を一部修正し、このAPIも使用するサンプルとしました。</P>

<HR>
<H3><A name="note21-25" id="note21-25">Note 21-25: (OS) アプリケーション向けの割り込みチェックフラグの追加(再掲)</A></H3>
<P>
　「Note 6-35: (OS) アプリケーション向けの割り込みチェックフラグの追加」
(NITRO-SDK Version 1.2 PR1) で追加した、割り込み用チェックフラグ
 OS_IE_USER_FLAG0, OS_IE_USER_FLAG1 が ARM7 でのみ有効になっていました。
これを ARM9 でも有効となるようにしました。
</P>

<HR>
<H3><A name="note21-26" id="note21-26">Note 21-26: (OS) OS_DestroyThread() 関数の追加</A></H3>
<P>　スレッドを指定して終了させる OS_DestroyThread() を追加しました。 (この関数は元々内部関数として用意されていました。)
</P>
<P>　他のスレッドを予告なく終了させるという少々危険な関数なので使用する際は十分注意してください。</P>

<HR>
<H3><A name="note21-27" id="note21-27">Note 21-27: (OS) OSデモ interrupt-key-1 の廃止と WaitIrq-2 の変更</A></H3>
<P>
　以前(NitroSDK2.0PR4 のリリース時)、「Note 13-18: (PAD) PAD_SetIrq(), PAD_ClearIrq() の廃止」にあるように
キー割り込みの使用が禁止されました。
そこで、OSデモの中の interrupt-key-1 (キー割り込みデモ) を廃止しました。
さらに、キー割り込みを使用していた WaitIrq-2 をタイマ割り込みを使うように変更しました。
</P>

<HR>
<H3><A name="note21-28" id="note21-28">Note 21-28: (OS) OS_EnableMainExArena(), OS_DisableMainExArena() の追加</A></H3>
<P>
　これまで拡張メインメモリアリーナを使用するためには、OS ライブラリを NITRO_MEMSIZE=8M の指定で make する必要が
ありましたが、OS_Init() (OS_Init() を使用していない場合は OS_InitArena()) の前に
OS_EnableMainExArena() や OS_DisableMainExArena() を指定することで拡張メインメモリアリーナを使用する／しないの宣言をすることが出来るようになりました。

ただしメインメモリを 4MB しか搭載していない環境(実機を含む)で動作させた場合は常に拡張メインメモリアリーナは使用できません。
</P>

<HR>
<H3><A name="note21-29" id="note21-29">Note 21-29: (OS) OS_DisableWriteBufferForProtectionRegion() の修正</A></H3>
<P>
　OS_DisableWriteBufferForProtectionRegion() 関数に間違いがあり、
OS_EnableWriteBufferForProtectionRegion() 関数と同様に機能する関数となっていました。これを修正しました。
</P>

<HR>
<H3><A name="note21-30" id="note21-30">Note 21-30: (OS) ヒープ関数の追加と変更</A></H3>
<P>
　ヒープに関する以下の関数を追加しました。
</P>
<UL>
<LI>OS_GetAllocatedSize
<LI>OS_GetTotalFreeSize
<LI>OS_GetMaxFreeSize
<LI>OS_ClearHeap
<LI>OS_FreeAllToHeap
</UL>
<P>また、OS_CheckHeap() の型を long から s32 にしました。</P>

<HR>
<H3><A name="note21-31" id="note21-31">Note 21-31: (MI) 圧縮データのストリーミング展開</A></H3>
<P>　圧縮データのストリーミング展開がサポートされました。この機能を使用すると、カードから圧縮データを読みながらより少ないバッファで
LZ 圧縮、ランレングス圧縮、ハフマン圧縮されたデータの展開を行なうことが可能となります。
実際にデータのストリーミング展開をおこなうサンプルとして以下のデモが追加されました。</P>
<UL>
<LI>$(NITROSDK_ROOT)/demos/mi/UnComp_Stream_BmpBG
</UL>

<HR>
<H3><A name="note21-32" id="note21-32">Note 21-32: (MI) MI_SendGXCommandAsync*() の不具合修正</A></H3>
<P>
　MI_SendGXCommandAsyncFast() と MI_SendGXCommandAsync() で、すでに指定のDMAを使用していたときに終了待ちを行なう個所で、
volatile 指定が適切でなく終了をうまく待てていませんでした。これを修正しました。
</P>

<HR>
<H3><A name="note21-33" id="note21-33">Note 21-33: (MI) 多重DMAの不具合への対処</A></H3>
<P>　多重DMA時のハードウェアの不具合対処として、DMA0 を使用したときのソースアドレスに制限を設けました。
具体的には、DMA0 のソースアドレスに 0xmmnnnnnn (mm=0x04,08〜ff　nnnnnnは任意)
は指定できないようにしました。転送終了時のソースアドレスもこの制限が適用されます。</P>
<P>　また、DMA0 を使用した後はダミーの空 DMA 転送を行なうようにしました。</P>
<P>　なお、DMA1 〜 DMA3 には制限はありません。</P>

<HR>
<H3><A name="note21-34" id="note21-34">Note 21-34: (PXI) PXI 初期化処理の変更</A></H3>
<P>　PXIのコントロールレジスタのクリアと PXI 割り込み設定の順序を、 「割り込み設定→レジスタクリア」
から、「レジスタクリア→割り込み設定」 となるように変更しました。</P>
<P>　これは、以前の順序だと、割り込みを設定したときに PXIの FIFOレジスタにデータた残ったままだとその時点で割り込みが発生して
しまうためです。</P>

<HR>
<H3><A name="note21-35" id="note21-35">Note 21-35: (DevEnv) makerom にクローンブート用のサイズチェックオプション追加</A></H3>
<P>　クローンブート機能を使用するアプリケーションにおいて、 attachsign ツールによって認証コードを追加するための領域がROM
イメージ上に確保できるかどうかを、ROM イメージ生成時点で判定する機能を
makerom に追加しました。</P>
<P> この機能は makerom の起動オプションとして -A を追加することで有効になります。
Makefile を使用している場合は以下のように MAKEROM_FLAGS にオプション -A
を設定すると良いでしょう。</P>
<BLOCKQUOTE>
MAKEROM_FLAGS = -A</BLOCKQUOTE>
<HR>
<H3><A name="note21-36" id="note21-36">Note 21-36: (DevEnv) ドキュメント形式の統一</A></H3>
<P> これまで $NitroSDK/docs/TecnicalNotes 以下のドキュメントは doc や rtf
など 様々な形式で置かれていましたが、これを pdf 変換した pdf形式ドキュメントに統一しました。
</P>
<HR>

<H3><A name="note21-37" id="note21-37">Note 21-37: (DEMO) tips/MyBuildMessage デモの追加</A></H3>
<P>　make -s 時のコンパイルおよびリンクメッセージを変更するデモを
$NitroSDK/build/demos/tips/MyBuildMessages に用意しました。
</P>

<HR>
<H3><A name="note21-38" id="note21-38">Note 21-38: (TOOL) emuchildの出力ファイルを省サイズ化</A></H3>
<P>　クローンブート使用時にバイナリへの署名の前準備を行なう emuchild.exe は常にフルサイズのファイルを出力していましたが、
出力ファイルサイズを小さくする為、ARM9,7のstatic領域以降のデータを除外するように変更されました。
これまで通りのフルサイズのバイナリを出力するためには追加された -f オプションを使用してください。</P>

<HR>
<H3><A name="note21-39" id="note21-39">Note 21-39: (SND) サウンドライブラリの更新</A></H3>
<P>
　NITRO-SDK で配布するサウンドライブラリが2004年12月27日版となりました。
</P>
<HR>
<H3><A name="KnownIssues_2_00_rc4" id="KnownIssues_2_00_rc4">SDK 2.0 RC4 での既知の問題点</A></H3>
<P>　ありません。</P>



<HR>
<H2 style="line-height: 0"><A name="sdk_2_00_rc3" id="sdk_2_00_rc3">■ NITRO-SDK Version 2.0 RC3</A></H2>
<DIV style="text-align: right">
<P style="line-height: 0">(2004/11/29)</P>
</DIV>
<HR>
<H3><A name="note20-01" id="note20-01">Note 20-01: (MB)擬似DSダウンロードプレイ子機機能の追加</A></H3>
<P>　DSカードから起動したアプリケーションがDSダウンロードプレイの 親機に対して、擬似的にDSダウンロードプレイ子機としてエントリーを行なう為の機能が追加されました。 この機能を利用すると、ワイヤレス対戦において DS ダウンロード子機とマルチカード子機を共存させることが 可能になります。</P>
<P>　また、デモプログラムとして、 multiboo-Model の親機サンプルに対してエントリーをおこなう
fake_child デモが以下のフォルダに追加されました。</P>
<BLOCKQUOTE>$NitroSDK/build/demos/mb/fake_child</BLOCKQUOTE>
<HR>
<H3><A name="note20-02" id="note20-02">Note 20-02: (MB) MB_GetParentSystemBufSize( ) 関数の不具合修正</A></H3>
<P>　NITRO-SDK2.0RC2にて、MB_GetParentSystemBufSize( ) 関数が返す バッファサイズが実際の値よりも
WM_SYSTEM_BUF_SIZE バイトだけ小さい値になってしまうという不具合があり、修正しました。
なお、同義のバッファサイズとして nitro/mb.h で定義されている MB_SYSTEM_BUF_SIZE
はこの不具合の影響を受けません。</P>
<HR>
<H3><A name="note20-03" id="note20-03">Note 20-03: (MB) MB_ReadSegment( ) 関数の機能拡張</A></H3>
<P>　MB_ReadSegment( ) 関数に引数として与えるバッファ長について、 MB_GetSegmentLength(
) 関数の返り値を下回るサイズでも 指定可能なように機能を拡張しました。 この最低サイズは
MB_SEGMENT_BUFFER_MIN として定義されます。 この拡張機能を使用した場合の詳細については、　MB_ReadSegment(
) 関数のリファレンスを参照下さい。</P>
<HR>
<H3><A name="note20-04" id="note20-04">Note 20-04: (MB) MB_StartParentEx( ) / MB_EndEx( ) 関数の名称変更</A></H3>
<P>
　他カテゴリとの統一のため、現行の MB_StartParentEx( ) 関数および 
MB_EndEx( ) 関数の名称をそれぞれ MB_StartParentFromIdle( ), 
MB_EndToIdle( ) へと変更し、古い名称は廃止されました。

</P>
<HR>
<H3><A name="note20-05" id="note20-05">Note 20-05: (MB) MB_DisconnectChild( ) の追加</A></H3>
<P>　DSダウンロードプレイデータの配信時に、WM_Disconnect( ) を使用して親機側から子機を切断した場合に、MBライブラリの内部状態に不整合が発生する不具合がありました。
MB通信中にも安全に子機を切断することのできる, MB_DisconnectChild( ) 関数を追加しました。</P>
<HR>
<H3><A name="note20-06" id="note20-06">Note 20-06: (MB) 親機受信バッファサイズ変更の廃止</A></H3>
<P>　DSダウンロードプレイの親機で、受信バッファサイズの設定を変更した 場合に以下の不具合が発見されました。</P>
<UL>
<LI>MBUserInfoの子機ニックネームが正しく受信できない。
<LI>１台の親機で複数のファイルを配信している場合に２つ目以降に登録したファイルが正常にダウンロードできない。
</UL>
<P>　このため仕様を変更し、MB 親機での受信バッファサイズは変更不可としました。
これにともない、以下の関数における受信バッファサイズを設定する引数を廃止しました。</P>
<UL>
<LI>MB_SetParentCommSize( )
<LI>MB_SetParentCommParam( )
</UL>
<HR>
<H3><A name="note20-07" id="note20-07">Note 20-07: (MB) クローンブートサンプルの追加</A></H3>
<P>　クローンブートのプログラム作成手順を例示するサンプル cloneboot が追加されました。</P>
<HR>
<H3><A name="note20-08" id="note20-08">Note 20-08: (MB) multiboot-Model 親機への再接続時のリトライ不具合の修正</A></H3>
<P>multiboot-Modelデモで子機がブートした後に親機に再接続する際、一度でも親機への接続に失敗するとリトライができないという不具合がありました。</P>
<P>この不具合は以下のように修正されました。</P>
<UL>
<LI>wireless-shared/wh/wh.c で、親機への接続が失敗した場合に WH_SYSSTATE_CONNECT_FAIL 状態に正しく遷移するように修正しました。
<LI>接続に失敗した場合にリトライ接続前に必ず WM_Reset( ) によって状態をリセットするように修正しました。
</UL>
<P>本デモを参考にアプリケーションを作成されておられる場合は、上記の修正点をご確認ください。</P>
<HR>
<H3><A name="note20-09" id="note20-09">Note 20-09: (MB) DSダウンロードプレイに関するドキュメントを追加</A></H3>
<P>　$NitroSDK/docs/TecnicalNotes/AboutMultiBoot.doc に DS ダウンロードプレイの手順や
DS ダウンロード親機との再接続、 クローンブート等に関するドキュメントが追加されました。</P>
<HR>
<H3><A name="note20-10" id="note20-10">Note 20-10: (WM) ARM7 側無線ライブラリの修正</A></H3>
<P>　Release 版、Debug 版の mongoose コンポーネントにおいてドライバを動作させる のに必要とされる量のワークエリアを確保できない場合がありました。また、全てのバージョンで mongoose のワークエリアを再利用する際の処理に問題があり、特定の順番で API を呼び出して接続・切断を繰り返した場合にワークエリアが 足りなくなり、接続処理が正常に動作しなくなる可能性がありました。これらの問題を修正しました。</P>
<HR>
<H3><A name="note20-11" id="note20-11">Note 20-11: (WM) MP 通信のライフタイムの導入</A></H3>
<P>　通信中の子機の ARM7 が halt 状態に遷移するなどしてフリーズした場合、
子機の無線ハードウェアが自動的に Null 応答を返しつづけるため、親機アプリケーションからは、異常の発生を検出できませんでした。これに対処するため、子機が
Null 応答を一定時間返しつづけた場合には、その接続を切断するように内部処理を変更しました。</P>
<P>　また、通信中の親機の ARM7 が halt 状態に遷移するなどしてフリーズした場合も同様に、親機の無線ハードウェアが自動的にビーコンを送信し続けるため、子機アプリケーションからは異常を検出することができませんでした。そこで、親機からMPフレームを一定時間受信できない場合に自動的に切断 するように変更しました。親子共に切断までのデフォルト値は 4 秒となっています。</P>
<P>　また、これに伴い WM_SetLifeTime( ) に mpLifeTime 引数が追加になりました。
</P>
<P>　なお、通常は Null 応答や MPフレーム送信のスキップ は一時的に ARM7 の負荷が高くなった場合に発生するものであり、連続して発生するものではありません。</P>
<HR>
<H3><A name="note20-12" id="note20-12">Note 20-12: (WM) 「ワイヤレス通信チュートリアル」の追加</A></H3>
<P>　WMライブラリを使用した無線通信プログラムサンプル dataShare-Model を例に取った、無線通信プログラムを作成する為のチュートリアルとなるドキュメント、「ワイヤレス通信チュートリアル」を追加公開しました。</P>
<HR>
<H3><A name="note20-13" id="note20-13">Note 20-13: (FS) FS_LoadOverlayImageAsync( ) 関数の追加</A></H3>
<P>　オーバーレイを非同期にロードする関数として FS_LoadOverlayImageAsync( ) 関数を追加しました。</P>
<HR>
<H3><A name="note20-14" id="note20-14">Note 20-14: (FS) FS_RegisterOverlayToDebugger( ) 関数の廃止</A></H3>
<P>　非同期にロードしたオーバーレイをデバッガへ登録するための関数FS_RegisterOverlayToDebugger(
) の機能は FS_StartOverlay( ) に統合されました。 このため、ユーザプログラムからの
FS_RegisterOverlayToDebugger( ) の明示的な呼び出しは不要となりました。
互換性のため、この API は何もしない空の関数として残っています。</P>
<HR>
<H3><A name="note20-15" id="note20-15">Note 20-15: (GX) GX_GetVCountEqVal( ) 関数の追加、および他の VCOUNT 一致割り込み関連
API の名称変更</A></H3>
<P>　VCOUNT 一致割り込みの現在の設定を取得するための API GX_GetVCountEqVal(
) を 用意しました。また、関連する API の GX_SetVCounterEqVal( ), GX_IsVCounterEq(
) は、それぞれ GX_SetVCountEqVal( ), GX_IsVCountEq( ) に名称を変更しました。ただし、以前の
API 名称もマクロによる別名定義により使用可能となっています。</P>
<HR>
<H3><A name="note20-16" id="note20-16">Note 20-16: (GX) GX_SetBankForBGEx( ) 関数の追加</A></H3>
<P>　BG用のVRAMバンク設定でVRAM-AとVRAM-Eなど連続したアドレスを確保できない組み合わせを使用するための関数として、
GX_SetBankForBGEx() を追加しました。 この関数を使用することによって、0x6000000-0x6017FFFには
VRAM-EFG が割り当てられ 0x6020000-0x607FFFF には VRAM-ABCD のうち最大３つのバンクが割り当てられます。</P>
<P>　また、この関数を使用したデモとして、 demo/gx/UnitTours/2D_CharBg_BankEx が追加されました。</P>
<HR>
<H3><A name="note20-17" id="note20-17">Note 20-17: (CARD) カード抜け後処理関数 CARD_TerminateForPulledOut() の変更</A></H3>
<P>　カード抜けを検出した後にデフォルトで呼ばれる CARD_TerminateForPulledOut( ) を 必ず OS_Terminate( ) で停止するという処理から、蓋が開いていればこれまで通りの停止で、 蓋が閉まっていれば強制的に電源をオフにするようにしました。</P>
<HR>
<H3><A name="note20-18" id="note20-18">Note 20-18: (MI) 差分フィルタの復元関数を追加</A></H3>
<P>　ntrcompを使用して差分フィルタをかけられたデータをランタイムで復元する以下の関数が追加されました。</P>
<UL>
<LI>MI_UnfilterDiff8( )
<LI>MI_UnfilterDiff16( )
</UL>
<P>　また、MI_GetCompressionType( ) 関数で得られるデータタイプに MI_COMPRESSION_DIFFが追加されました。</P>
<HR>
<H3><A name="note20-19" id="note20-19">Note 20-19: (MI) 起動時専用のメモリクリア処理関数の追加</A></H3>
<P>　CPUによるメモリクリア関数は crt0.c で定義し、他のライブラリ(OS, MI) はそれを利用していましたが、マルチブート子機となったDSがデータ受信キャンセルした場合、この領域が破壊されることがありました。
そこで、crt0 で使用するメモリクリア関数と他ライブラリのメモリ クリア関数を互いに独立させるようにしました。</P>
<HR>
<H3><A name="note20-20" id="note20-20">Note 20-20: (OS) VAlarm についての不具合修正</A></H3>
<P>　VAlarmに複数のアラームを設定すると、設定したVカウントや遅延許可ライン数、割り込みの発生するタイミングなどによってアラームが発動する順番が正しく制御されない場合があるという不具合がありました。この不具合に起因して、無線通信中にタッチパネルの自動サンプリングが正常に行われない可能性があるという問題がありました。
この不具合を修正しました。</P>
<HR>
<H3><A name="note20-21" id="note20-21">Note 20-21: (OS) デバッグ関数の weak シンボル化</A></H3>
<P>　以下の デバッグに関係した OS 関数を weak シンボルとしました。 ユーザが同名の関数を定義した場合、そちらが優先されます。</P>
<UL>
<LI>OS_PutChar( )
<LI>OS_SPrintf( )
<LI>OS_VSPrintf( )
<LI>OS_SNPrintf( )
<LI>OS_VSNPrintf( )
<LI>OS_VPrintf( )
<LI>OS_TVPrintf( )
<LI>OS_Printf( )
<LI>OS_TPrintf( )
<LI>OS_Terminate( )
<LI>OS_Halt( )
</UL>
<P>
　また、OS_Panic( ), OS_Warning( ), OS_TPanic( ), OS_TWarning( ) の実体である
OSi_Panic(), OSi_Warning(), OSi_TPanic( ), OSi_TWarning( ) も weak シンボルとしました。</P>
<HR>
<H3><A name="note20-22" id="note20-22">Note 20-22: (SND) SND_InvalidateWaveData( ) で関係ない発音が止まる不具合を修正</A></H3>
<P>　SND_InvalidateWaveData( ) 関数で、関係のない発音も止められてしまうことがある不具合がありました。この不具合により、サラウンドモード中にメモリ上のサウンドデータを破棄すると、以後サラウンドモードを停止させるまで 発音が行われなくなることがありました。 この不具合は修正されました。</P>
<HR>
<H3><A name="note20-23" id="note20-23">Note 20-23: (MIC) MIC_GetLastSamplingAddress( ) が正確なアドレスを返さない不具合の修正</A></H3>
<P>
　MIC_GetLastSamplingAddress( ) に以下の不具合がありました。</P>
<UL>
<LI>16 ビットサンプリングにおいて、返値が 2 バイトずれる
<LI>MIC_StartAutoSampling( ) の直後に呼び出すと不定値が返るときがある
</UL>
<P>
　これらの不具合は修正され、MIC_GetLastSamplingAddress( ) 関数は「最後にサンプリングしたデータを格納したメモリ位置を返すが、一度もサンプリングしていない場合はNULLを返す」という仕様に変更されました。
</P>
<HR>
<H3><A name="note20-24" id="note20-24">Note 20-24: (PRC) 識別子名の変更</A></H3>
<P>　図形認識 API のうち、regularize という綴りを持った識別子は 全て normalize
と変更されました。</P>
<BLOCKQUOTE>PRCInputPatternParam<BR>
PRCPrototypeDBParam<BR>
PRCPrototypeList</BLOCKQUOTE>
<P>の各構造体のメンバ変数に変更があります。 また、$NitroSDK/tools/bin/pdic2c.pl の出力する
C プログラムの定数値も PDIC_NORMALIZE_SIZE に変更されました。</P>
<HR>
<H3><A name="note20-25" id="note20-25">Note 20-25: (WM) WM_SetMPDataToPort*( ) の引数チェックの強化</A></H3>
<P>　WM_StartMP*( ) の引数 sendBuf と WM_SetMPDataToPort*( ) の引数 sendData とに
誤って同一のバッファを割り当ててしまわないよう、
この二つのバッファが同一だった場合はエラーとなるように変更しました。</P>
<HR>
<H3><A name="KnownIssues_2_00_rc3" id="KnownIssues_2_00_rc3">SDK 2.0 RC3 での既知の問題点</A></H3>
<P>　「Note 20-15: (GX) GX_SetBankForBGEx( ) 関数の追加」の、 GX_SetBankForBGEx(
) 関数を使用すると、現状では DEBUG ビルド時のリージョンチェックが行なわれず、
不正なアドレスに書き込んだ場合にもASSERTに引っかかりません。この不具合は次以降のリリースで修正されます。</P>

<HR>
<H2 style="line-height: 0"><A name="sdk_2_00_rc2" id="sdk_2_00_rc2">■ NITRO-SDK Version 2.0 RC2</A></H2>
<DIV style="text-align: right">
<P style="line-height: 0">(2004/11/04)</P>
</DIV>
<HR>
<H3><A name="note19-01" id="note19-01">Note 19-01: (WM) WM_GetAllowedChannel() でのエラー発生時の返値の変更</A></H3>
<P>　WM_GetAllowedChannel() においてエラーが発生したとき(WM_Init() が先に呼ばれていない)の返値を
0 から 0x8000 に変更しました。</P>
<P>　これは許可されているチャネルがなかった場合(返値が 0x0000)とエラー発生とを区別するためです。</P>
<HR>
<H3><A name="note19-02" id="note19-02">Note 19-02: (WM) WM_End ライブラリ終了関数の内部仕様を一部変更</A></H3>
<P>　WM_End( ) 関数において、ユーザーコールバックが呼び出された後にメモリの解放などライブラリの強制終了処理を行う仕様でしたが、コールバックが呼び出された時点で全ての終了処理が完了している状態になるよう仕様を変更しました。</P>
<P>　この変更は WM_End( ) 関数に対するコールバック内で、次の WM_Initialize(
) 関数を呼び出したいとのご要望に対応したものです。</P>
<HR>
<H3><A name="note19-03" id="note19-03">Note 19-03: (WM) WMDisconnectCallback 構造体の新設</A></H3>
<P>　WM_Disconnect( ) 関数、及び WM_DisconnectChildren( ) 関数に対するコールバックに渡される構造体を新規に追加しました。WMCallback
構造体に切断を要求した機器の AID ビットマップ及び結果として切断された機器の
AID ビットマップを示すメンバを追加した構造体です。</P>
<P>　新設された WMDisconnectCallback 構造体の先頭のメンバー変数は、これまでの
WMCallback 構造体と互換性を保っているので、WMCallback 構造体として取り扱っても問題はありません。</P>
<HR>
<H3><A name="note19-04" id="note19-04">Note 19-04: (WM) WM_Reset( ) 関数の初期化動作の修正</A></H3>
<P>　WM_Reset( ) 関数を、MP 通信接続確立後に呼び出すと MP 通信用の自動処理がリセットされずに残るという不具合がありました。</P>
<P>　この不具合を修正し、自動処理部分も確実にリセットされるようにしました。これにより処理の負荷が下がる可能性があります。</P>

<HR>
<H3><A name="note19-05" id="note19-05">Note 19-05: (WM) データシェアリング終了時の処理の修正</A></H3>
<P>　WM_EndDataSharing( ) 関数とWM_EndMP( ) 関数の間に MP 通信が発生した場合に不正な処理が起こる可能性がありましたが、これを修正しました。</P>
<P>　なお、WM_EndDataSharing( ) 関数とWM_StartDataSharing( ) 関数をこの順に連続して呼び出すと不具合が起こることがありますので、ご注意ください。</P>
<HR>
<H3><A name="note19-06" id="note19-06">Note 19-06: (WM) データシェアリングにおけるデータサイズ上限変更</A></H3>
<P>　RC1 以前のライブラリのデータシェアリングにおいて、共有サイズ×共有台数の上限は 252 バイトでしたが、これを 508 バイトに拡張しました。それにともない WMDataSharingInfo の構造体サイズが 1K バイト増えています。以前の状態に戻したい場合は wm.h の WM_DS_DATA_SIZE_252 を #define してください。</P>
<HR>
<H3><A name="note19-07" id="note19-07">Note 19-07: (MB) MBUserInfo の nameLength が無効となる不具合を修正</A></H3>
<P>　MB_Init() の引数の MBUserInfo を設定する際に、ユーザ名の終端がNUL文字で判定され長さを示す
nameLength を変更しても子機画面に反映されないという不具合がありました。</P>
<P>　この不具合は修正されました。</P>
<HR>
<H3><A name="note19-08" id="note19-08">Note 19-08: (MB) MB_StartParentEx( ) 関数, MB_EndEx( ) 関数の追加</A></H3>
<P>　従来の MB_StartParent( ) 関数、MB_End( ) 関数と対応して、無線ライブラリが
IDLE 状態であっても呼び出すことの可能な MB_StartParentEx( ) 関数、および無線ライブラリを
IDLE 状態にして終了する MB_EndEx( ) 関数を追加しました。開始前・終了後の無線ライブラリの状態以外の点では、どちらも同じように使用することが出来ます。</P>
<HR>
<H3><A name="note19-09" id="note19-09">Note 19-09: (MB) MB_UnregisterFile( ) 関数のリファレンスに注意事項を追加</A></H3>
<P>　マルチブート親機側が MB ライブラリを起動中に MB_RegisterFile( ) 関数と
MB_UnregisterFile( ) 関数を交互に呼び出して登録プログラムを動的に変更すると、変更前後の登録プログラムの
GGID が一致している場合にIPL 側でその変更を検出できないという制約がありました。</P>
<P>　その問題を回避するための注意事項を MB_UnregisterFile( ) 関数のリファレンスに追加しました。</P>
<HR>
<H3><A name="note19-10" id="note19-10">Note 19-10: (MB) チャンネル電波使用率を検出するデモを追加</A></H3>
<P>　マルチブート使用時にMBの前処理として電波使用率を調査するデモが $NitroSDK/build/demos/mb/mbm
として追加されました。デモ中のMBM_MeasureChannel( ) は、最適なチャンネルを取得した後無線のパワーを
OFF にするため、コールバック取得後に通常通り MB_Init( ) からマルチブート処理を開始してください。</P>
<HR>
<H3><A name="note19-11" id="note19-11">Note 19-11: (MB) multiboot デモにおける tgid 値の設定手法の変更</A></H3>
<P>　multiboot サンプルデモの親機動作において、無線の接続セッションの管理を行なうための
tgid の設定値を電源 ON 毎になるべく異なった値になるように修正しました。tgid
の値として RTC から取得できる現在時刻の分と秒の値を利用しています。</P>
<HR>
<H3><A name="note19-12" id="note19-12">Note 19-12: (MB) MB_End ライブラリ終了関数の仕様を一部変更</A></H3>
<P>　MB_End( ) 関数において、ユーザーコールバックが呼び出された後にメモリの解放などのライブラリの終了処理を行っていましたが、コールバックが呼び出された時点で全ての終了処理が完了している状態になるよう修正しました。</P>
<P>　これは <A href="#note19-05">Note 19-05</A> と同様の修正で、MB_End( ) のユーザコールバック内で MB の再初期化を行なう場合に対応したもので、ドキュメントとの実動作とが一致していないという不具合の修正となります。</P>
<HR>
<H3><A name="note19-13" id="note19-13">Note 19-13: (WBT) wbt-fs サンプルデモの通信切断時エラー処理の修正</A></H3>
<P>　wbt-fs サンプルデモで子機側のファイルアクセス中に親機との通信が切断された場合、その時点以降に呼ばれたファイル操作が完了しない場合があるという不具合があり、これを修正しました。</P>
<HR>
<H3><A name="note19-14" id="note19-14">Note 19-14: (WBT) wbt-fs サンプルデモの修正</A></H3>
<P>　wbt-fs サンプルデモ内部の受信データのキャッシュ操作において、Flush すべき部分に対して
Invalidate していた個所がありました。</P>
<P>　この問題を修正しました。</P>
<HR>
<H3><A name="note19-15" id="note19-15">Note 19-15: (WBT) WBTライブラリの修正</A></H3>
<P>　WBTライブラリについて、以下の問題が修正されました。</P>
<UL>
  <LI>相手局でブロックが登録されていない状態のときに WBT_GetBlockInfo( ) 関数を呼び出した場合、コールバックで返される
  WBTBlockInfo 構造体が不定値になるという問題がありました。これを、「全てのメンバが0クリアされたデータ」を返すよう修正しました。
  <LI>WBT_GetBlockInfo( ) 関数の優先度が WBT_GetBlock( ) 関数の優先度より高いため、場合により処理が進捗しないことがあるという問題がありました。これを、WBT_GetBlockInfo(
  ) 関数の優先度を下げるよう修正しました。
</UL>
<HR>
<H3><A name="note19-16" id="note19-16">Note 19-16: (FS) FS_RegisterOverlayToDebugger( ) 関数の追加</A></H3>
<P>　オーバーレイモジュールを FS_LoadOverlay( ) などの上位関数を使用せずに、ファイルリードなどの下位関数の組み合わせでオーバーレイモジュールをロードする際に、デバッガへオーバーレイのロードを通知するための関数
FS_RegisterOverlayToDebugger( ) をFSライブラリへ追加しました。</P>
<P>　FS_GetOverlayFileID( ), FS_ReadFile( ) および FS_StartOverlay( ) の組み合わせでオーバーレイをロードする場合、この関数を
FS_StartOverlay( ) の前に呼び出すことによってデバッガ上で追跡することが出来ます。</P>
<P>　この使用方法を示すコードを、$NitroSDK/build/demos/fs/overlay に追加しました。</P>
<HR>
<H3><A name="note19-17" id="note19-17">Note 19-17: (OS) Vカウントよるアラーム処理の変更</A></H3>
<P>　Vカウントによるアラーム(VAlarm)の処理ルーチンを変更しました。これまでは割り込みによるループ最初の
VAlarm は指定のVカウントちょうどでなければハンドラの呼び出しは起こらず、これを用いている無線などのライブラリで処理の遅延が発生していました。</P>
<P>　ここで「割り込みによるループ最初のVAlarm」とは、文字通りVカウント割り込みによって呼び出されるVAlarmハンドラであり、内部ではこれが呼ばれた後に(割り込みによらず)登録されている他のアラームの呼び出しカウントを調べ、必要ならばハンドラを呼び出す、という処理を行なっています。</P>
<P>　今回の変更では、割り込みによって呼び出されるVAlarmハンドラが、指定のVカウントをある程度過ぎていても呼び出されるように、呼び出し遅れ許容Vカウント範囲(delay)を指定できるようになりました。(間に合わなかったものは次のフレームにまわされます。)</P>
<P>　そのために <FONT color="#ff0000">Vアラームの設定関数 OS_SetVAlarm() では delay の引数が増えました。</FONT></P>
<P>　従来、</P>
<BLOCKQUOTE>OS_SetVAlarm( alarm, vcount, handler, arg );</BLOCKQUOTE>
<P>　と呼び出していたものは、</P>
<BLOCKQUOTE>OS_SetVAlarm( alarm, vcount, <FONT color="#ff0000">delay,</FONT> handler, arg );</BLOCKQUOTE>
<P>　となります。詳細は <A href="os/valarm/OS_SetVAlarm.html">OS_SetVAlarm()</A> のリファレンスマニュアルを参照してください。</P>
<P>　また、周期Vアラームでは、これまでも delay 指定がありましたが、やはり割り込みで掛かるVAlarm
では delay が利いていませんでしたので正確に delay の遅れまではアラームが発生するようにしました。</P>
<P>　OS_SetVAlarm() の引数が一つ増えましたが、delay を指定しない従来の呼び出しを行ないたい場合は、引数は同じで
OS_SetVAlarm() の代わりに OS_SetOneTimeVAlarm() を呼び出して下さい。これは
delay に 10を指定したのと同様の関数となります。(従来も内部では、delay=10として扱っていました。)</P>
<P>　delay の最大値は OS_VALARM_DELAY_MAX となります。これを指定する場合、どんなに遅れても指定のVアラームハンドラが呼び出されます。</P>
<HR>
<H3><A name="note19-18" id="note19-18">Note 19-18: (OS) オーナー情報「お気に入りの色」取得関数の追加</A></H3>
<P>　以下の色情報定義と関数を追加し、リファレンスを追加しました。</P>
<UL>
  <LI>OS_GetFavoriteColor()
  <LI>OS_GetFavoriteColorTable()
  <LI>OS_FAVORITE_COLOR_ 列挙定数群
  <LI>OS_FAVORITE_COLOR_VALUE_ 色値定数群
</UL>
<HR>
<H3><A name="note19-19" id="note19-19">Note 19-19: (OS) 関数コスト計測プロファイラの修正</A></H3>
<P>　関数コスト計測プロファイラの OS_CalcThreadStatistics( ) で行うコスト計算で、カレントスレッド以外のスレッドを対象にした場合に不具合がありました。コスト計算の結果を統計バッファに反映させた後、コストバッファをクリアするのですが、対象スレッドではなくカレントスレッドのバッファをクリアしていました。これを修正しました。</P>
<HR>
<H3><A name="note19-20" id="note19-20">Note 19-20: (OS) OS_SetTick() の修正</A></H3>
<P>　チック値の設定関数(OS_SetTick( ) )に不具合があり、他の割り込み要求フラグを落としてしまうことがありました。これを修正しました。</P>
<P>　なお、アラームシステムを使用している場合はその動作に影響を及ぼす場合があるため、アプリケーションで
OS_SetTick( ) することに対しては十分な注意を払う必要があります。</P>
<HR>
<H3><A name="note19-21" id="note19-21">Note 19-21: (OS) OS_ResetSystem() の修正</A></H3>
<P>　リセット関数 OS_ResetSystem( ) はハードウェアの初期化を伴わないため、これを呼び出す前にハードウェアの機能を明示的に停止させる、または停止していることを確認する必要がありますが、安全性を高めるため、幾つかのハードウェア機能についての停止処理を関数内部に追加しました。</P>
<UL>
  <LI>カードバスがロックされているときはロックの終了を待つようにしました。(ARM9のみ)
  <LI>DMAを全て停止するようにしました。
  <LI>ARM9にリセットを通達するために使用するPXI関連の割り込み以外の割り込み要因をマスクするようにしました。
  <LI>ARM7からリセットの通達を受けるために使用するPXI関連の割り込み以外の割り込み要因をマスクするようにしました。
</UL>
<P>　また、リセット処理の一部がメインメモリ上で行なわれていたため、この部分を破壊される場合にリセット処理が正常に行なわれない不具合があったことも修正しました。</P>
<HR>
<H3><A name="note19-22" id="note19-22">Note 19-22: (OS) DTCM へのデータセクション転送処理の修正</A></H3>
<P>　DTCM へデータセクションを設置し autoload でロードしていた場合に正常な処理が行なわれませんでした。これを修正しました。</P>
<HR>
<H3><A name="note19-23" id="note19-23">Note 19-23: (CARD) CARD_GetRomHeader 関数の追加</A></H3>
<P>　ワイヤレスダウンロードによって起動されたプログラムが実際に挿入されているNITRO-CARDのROM内登録情報を取得することの出来る関数
CARD_GetRomHeader を追加しました。</P>
<HR>
<H3><A name="note19-24" id="note19-24">Note 19-24: (CARD) CARD アクセス時の自動起動 DMA チェック処理修正</A></H3>
<P>　CARDライブラリおよびその上位ライブラリ関数においてCARD-ROMへのアクセス時に他の自動起動DMAとの重複実行を判定する処理が抜けていたため、この判定処理を追加しました。</P>
<HR>
<H3><A name="note19-25" id="note19-25">Note 19-25: (ARM7) ferret へのカードとカートリッジ抜き検出機能の追加</A></H3>
<P>　ARM7 のコンポーネントとして ferret を使用した場合、カードとカートリッジの抜き検出を行なうことが出来ませんでしたが、この機能を追加し

ferret 使用時で検出が出来るようになりました。</P>
<P>　この検出機能は TS 版のライブラリでのみ有効です。</P>
<HR>
<H3><A name="note19-26" id="note19-26">Note 19-26: (PM) スリープ復帰時のLCD状態の修正</A></H3>
<P>　NITRO-SDK 2.0 RC1 の修正「Note 18-16: (PM) スリープ時の残像を避ける修正」を行なうことで次のような不具合が発生していました。残像を避けるために行なった修正により、PM_GoSleepMode(
) でスリープに入り復帰するとGXライブラリの内部状態がスリープ前と異なってしまい、LCD
が正しく復帰しない場合がある、というものです。これを修正し、スリープ後に正常に
LCD が復帰するようにしました。</P>
<HR>
<H3><A name="note19-27" id="note19-27">Note 19-27: (MI) DMA 時のアドレスチェック処理の修正</A></H3>
<P>　DEBUG 用 MI ライブラリにおいて DMA の際の転送アドレスが ITCM や DTCM
に含まれているかどうかを ASSERT チェックしています。この ITCM の開始アドレスが
0x00000000 となっていました。これを正規の値の 0x01FF8000 に変更しました。</P>
<HR>
<H3><A name="note19-28" id="note19-28">Note 19-28: (MI) MI_DmaFill*( ) の修正</A></H3>
<P>　DMAを用いてメモリを同じ値でフィルする、MI_DmaFill*( ) が関数実行途中で割り込みが発生すると、そのタイミングによっては正常に値の転送が行なえなくなっていました。これを修正し、MI_DmaFill*(
) を割り込みセーフ関数としました。</P>
<HR>
<H3><A name="note19-29" id="note19-29">Note 19-29: (GX) G3X_IsLineBufferOverflow( ), G3X_ResetLineBufferOverflow(
) の改名</A></H3>
<P>　レンダリングエンジンのラインバッファのアンダーフロー(ラインズオーバー)
フラグ関連の関数</P>
<BLOCKQUOTE>G3X_IsLineBufferOverflow()、G3X_ResetLineBufferOverflow()</BLOCKQUOTE>
<P>　を</P>

<BLOCKQUOTE>G3X_IsLineBufferUnderflow()、G3X_ResetLineBufferUnderflow()</BLOCKQUOTE>
<P>　に改名しました。</P>
<HR>
<H3><A name="note19-30" id="note19-30">Note 19-30: (GX) レジスタの定義誤りの修正</A></H3>
<P>　$NitroSDK/include/nitro/hw/ARM9内で定義されている以下の定数宣言に誤りがありました。</P>
<UL>
  <LI>REG_EDGE_COLOR_2_OFFSET
  <LI>REG_EDGE_COLOR_3_OFFSET
  <LI>REG_G3_TEXCOORD_INTEGER_SHIFT
  <LI>REG_REG_G3X_VTXRAM_COUNT_VTXCNT_SIZE
  <LI>REG_G3X_VTXRAM_COUNT_VTXCNT_MASK
</UL>
<P>　これらの不具合は修正されました。</P>
<HR>
<H3><A name="note19-31" id="note19-31">Note 19-31: (GX) G3X_InitTableのテーブルクリア不具合の修正</A></H3>
<P>　G3X_initTable関数内のテーブルを0クリアする際に、トゥーンテーブルの終わり16バイトがクリアされない不具合がありました。</P>
<P>　この不具合は修正されました。</P>
<HR>
<H3><A name="note19-32" id="note19-32">Note 19-32: (SND) サウンドライブラリの更新</A></H3>
<P>　NITRO-SDK で配布するサウンドライブラリが NITRO-SYSTEM 2004年10月12日版のものとなりました。この変更は
2.0RC1plus3 以降のパッチにも追加されいます。</P>
<HR>
<H3><A name="note19-33" id="note19-33">Note 19-33: (CTRDG) CTRDG_IsNumberID()、CTRDG_IsBitID() のリファレンス追加</A></H3>
<P>　カートリッジへ指定の周辺機器が搭載されているかを調べるための関数、CTRDG_IsNumberID()、CTRDG_IsBitID(
) のリファレンスマニュアルが追加されました。</P>
<HR>
<H3><A name="note19-34" id="note19-34">Note 19-34: (DevEnv) IPL GUI 版 mb_child, 無線接続チェック用ツール WMTestTool の収録</A></H3>
<P>　製品版 IPL を模した mb_child プログラムを $NitroSDK/bin/ARM9-TS/Rom 以下へ収録しました。以前のものは
mb_child_simple.srl と名称変更されています。</P>
<P>　また同ディレクトリに無線テスト用のツールである WMTestTool.srl を収録しました。以下のテストモードが使用できます。詳細なマニュアルは現在準備中です。</P>
<UL>
  <LI>aging test - MacAddressの取得に使えます。
  <LI>Scan test - GGIDの確認に使えます。
  <LI>ScanEx test - GGIDの確認に使えます。(普通のScanとの性能比較も)
  <LI>MeasureChannel test - MeasureChannel に使えます。
  <LI>Noise mode - ノイズを発生し通信をしにくくします。
</UL>
<HR>
<H3><A name="KnownIssues_2_00_rc2" id="KnownIssues_2_00_rc2">SDK 2.0 RC2 での既知の問題点</A></H3>
<P>　ありません。</P>
<HR>
<H2 style="line-height: 0"><A name="sdk_2_00_rc1" id="sdk_2_00_rc1">■ NITRO-SDK Version 2.0 RC1</A></H2>
<DIV style="text-align: right">
<P style="line-height: 0">(2004/10/07)</P>
</DIV>
<HR>
<H3><A name="note18-01" id="note18-01">Note 18-01: (WM) WM ライブラリの変更</A></H3>
<P><B>※2.0RC1における WM ライブラリの変更により、2.0FC までのプログラムはそのままではコンパイルに通らなくなっています。
主に修正するべき点については<A href="wm_changes_041006.txt">こちら</A>をご参照ください。 </B></P>
<P>1) TESTモード操作関数　WM_StartTestMode( ), WM_StopTestMode( ) を削除しました。</P>
<P>2) WM_GetAllowedChannel( ) は同期関数であるにも関わらず WM_PowerOn( ) を行った後の
IDLE ステートでないと有効な値を返さないという仕様でしたが、 ライブラリ使用者の混乱を招く恐れがありましたので、WM_Init(
)関数によって初期化した後であればいつでも有効な値を返すように修正しました。</P>
<P>3) 無線で通信を行いながらサウンドライブラリを使用してある程度高音程の音を鳴らすと、ノイズが乗るという不具合がありましたが、この不具合は大きく改善されました。</P>
<P>4) NintendoDS 以外の無線通信機器などの影響等により無線通信プロトコルに復旧不能な致命的なエラーが発生した場合、電波が届かなくなった場合などと同様に接続が自動的に切断される仕様となりました。アプリケーションは、通常の切断とまったく同じ通知を受け取りますので、対応コードを新たに書く必要はありません。</P>
<P>5) NintendoDS 本体ごとに無線通信時に必要な固有の設定値が内部的に保存されていますが、この設定値が何らかの理由で破壊されると正常に通信ができなくなります。このため、無線用の設定値が壊れた状態で無線通信を試みた場合は自動的にプログラムが停止するようになりました。</P>
<P>6) ゲームグループ ID について、u16[2] 型の定義と u32 型の定義が混在しており混乱を招いていた為、これをu32

型に統一しました。APIとしてインターフェースの変更が行われたものは以下の通りです。</P>
<UL>
  <LI>WMParentParam 構造体
  <LI>WM_SetGameInfo( ) 関数
  <LI>MB_Init( ) 関数
</UL>
<P>また、この変更に伴い無線通信を行うサンプルデモをそれぞれ修正しました。</P>
<P>7) WM_StartMPEx( ) に引数 ignoreFatalError が追加されました。通常使用の場合は
FALSE を与えるようにしてください。</P>
<P>8) WMParentParam で指定できる親子それぞれの最大送信可能バイト数の最大値が
508 バイトから 512 バイトに増えました。 ただし、MP通信の所要時間の 5600
μ秒の制限は変わっていませんので、 この制限内で送信バイト数を設定してください。
なお、MBライブラリのMB_COMM_PARENT_SEND_MAXの値はそのままとなっています。</P>
<P>9) WM_StartMPEx の minPollBmpMode が TRUE の状態で親子の距離を離していった場合、
WM_GetLinkLevel の返り値が最高レベルの 3 のままで切断されてしまう不具合がありましたが、
これを修正しました。 同時に、WM_GetLinkLevel で取れる電波受信強度の振る舞いが変更されました。
値が変動する頻度が緩やかになっています。</P>
<P>10) MACアドレスについて、u16[3] 型の定義と u8[6] 型の定義が混在しており混乱を招いていた為、
これを u8[6] 型に統一しました。APIとしてインターフェースの変更が行われたものは以下の通りです。</P>
<UL>
  <LI>WM_SetDCFData関数
  <LI>WMStartParentCallback構造体
  <LI>WMStartScanCallback構造体
  <LI>WMPortRecvCallback構造体
  <LI>WMScanParam構造体
</UL>
<P>また、この変更に伴い無線通信を行うサンプルデモをそれぞれ修正しました。</P>
<P>11) プログラミングガイドラインで規定されている MP 通信所要時間を上回る設定値を使用していた
全ての無線サンプルデモについて、正しく範囲内の値を使用するよう修正しました。</P>
<HR>
<H3><A name="note18-02" id="note18-02">Note 18-02: (MB) mb_child.srl プログラムが最大文字数処理で停止する問題の修正</A></H3>
<P>　mb_child.srl において親機のユーザ名が 10 文字になっている場合正常に動かないという問題がありましたが、
修正されました。</P>
<HR>
<H3><A name="note18-03" id="note18-03">Note 18-03: (MB) multiboot-Model デモのダウンロードシーケンス変更</A></H3>
<P>　IPL のダウンロード時の表示シーケンス確定に従い、 これまでデモでは親機はデータ転送後にブート準備が整うのを待っていましたが、
データ転送前に子機が揃うのを待ち一斉にデータ転送を開始するように変更しました。</P>
<HR>
<H3><A name="note18-04" id="note18-04">Note 18-04: (MB) mb_child.srl プログラムの表示文字を英語へ変更</A></H3>
<P>　マルチブートに使用する子機用プログラムの mb_child.srl は画面表示に日本語を使用していましたが、
これを英語表示へ改めました。</P>
<HR>
<H3><A name="note18-05" id="note18-05">Note 18-05: (WBT) WBT_CancelCurrentCommand 関数の追加</A></H3>
<P>　WBTにおいて、 WBT_GetBlock 関数で処理中のファイル受信操作をキャンセルするための
WBT_CancelCurrentCommand 関数が追加されました。</P>
<HR>
<H3><A name="note18-06" id="note18-06">Note 18-06: (DEMO) WMデモ ball の警告対処</A></H3>
<P>　ballデモで「Failed sound alarm OS_SendMessage」という警告が出ていましたが、対処して出ないようにしました。</P>
<P>　この警告は、ARM7のサウンド処理が正常に行われていないことを示しています。
44kHzの音を３オクターブ以上高い音で１６音同時に再生するような状況下でも、
CPU処理に高い負荷がかかるために、この警告が出る場合があります。 CPU処理に大きな負荷を与えるサウンド再生を行わないように注意してください。</P>
<HR>
<H3><A name="note18-07" id="note18-07">Note 18-07: (DEMO) multiboot デモのユーザ名処理の変更</A></H3>
<P>　mb/multiboot デモの処理で親機が使用するユーザ名を NintendoDS本体のオーナー情報から取得するよう変更しました。</P>
<P>　ただし、 <CODE>TS_VERSION &lt; 200</CODE> かつ <CODE>NVRAM_FORMAT &lt; 100</CODE> の TS や TEG など OS_GetOwnerInfo() 関数が使用できない古い環境では従来どおり固定値を使用しています。</P>
<HR>
<H3><A name="note18-08" id="note18-08">Note 18-08: (DevEnv) NITRO-SDK のバージョンの表示ツールの収録</A></H3>
<P>　ROM ファイルに組み込まれている NITRO-SDK のバージョンを表示するツール
showversion を収録しました。 NITRO-SDK 2.0FC 以降でのみ有効です。 詳しい制限事項は
<A href="tools/showversion.html">リファレンスマニュアル</A>をご覧ください。</P>
<HR>
<H3><A name="note18-09" id="note18-09">Note 18-09: (DevEnv) バナー表示ツールの最終版の収録</A></H3>
<P>　バナー表示ツールの最終版を収録しました。以前のものと比べ、使用可能フォントなどに違いがあります。</P>
<HR>
<H3><A name="note18-10" id="note18-10">Note 18-10: (DevEnv) lsf ファイルの常駐領域名称の記述とモジュール圧縮処理のリンク</A></H3>
<P>　アプリケーション独自の lsf ファイルを使用している場合、 常駐モジュールのセグメント名と
srl/nef ターゲット名が異なる設定であった場合に、 NITRO_COMPRESS 有効時のモジュール圧縮処理でエラーが発生していました。</P>
<P>　lcf テンプレートファイルを修正し、 lsf ファイルの記述より中間ファイルcomponent.files
を出力し、 compstatic でそのファイルを参照することで、 lsf ファイルの常駐領域名称の記述とモジュール圧縮処理がリンクされるように修正しました。</P>
<HR>
<H3><A name="note18-11" id="note18-11">Note 18-11: (OS) メインメモリ用プロテクションリージョン設定の変更</A></H3>
<P>　これまで、 起動時にメインメモリ用のプロテクションリージョンのサイズを常に4MBにしておき、
OS_InitArenaEx() を呼んだとき(OS_Init() 内で呼ばれます) SDK_8M が定義されていて8MBのメモリが搭載されていたときにのみ
プロテクションリージョン設定を8MBとしていました。</P>
<P>　しかし拡張メモリ領域に autoload でモジュールを転送しようとすると、 その転送は
OS_InitArenaEx() より前に行われるため、 例外発生により出来ませんでした。</P>
<P>　そこでメインメモリ用プロテクションリージョンのサイズについてのルールを次のように変更しました。</P>
<UL>
  <LI>起動時にはメインメモリ用のロテクションリージョンのサイズを8MBにします。
  <LI>OS_InitArenaEx() を呼んだときに、SDK_4M が定義されているか、 搭載メモリ量が4MBの時にはリージョンのサイズを4MBに変更します。
</UL>
<P>　この変更によって拡張メモリ領域への転送も可能となります。</P>
<HR>
<H3><A name="note18-12" id="note18-12">Note 18-12: (OS) リセット時のサウンド停止処理</A></H3>
<P>　OS_ResetSystem() の呼び出し時に、ARM7でサウンドの再生を停止する処理を行うようにしました。</P>
<HR>
<H3><A name="note18-13" id="note18-13">Note 18-13: (OS) OS_CreateThread() の修正</A></H3>
<P>　OS_CreateThread() で行っている、スレッド初期化について以下ものを追加しました。</P>
<UL>
  <LI>profilerメンバの初期化。プロファイル機能を用いる際に参照されます。
  <LI>joinQueueメンバの初期化。OS_ExitThread()、OS_JoinThread()、OS_DestroyThread()
  を使用する際に参照されます。
</UL>
<HR>
<H3><A name="note18-14" id="note18-14">Note 18-14: (OS) 関数トレースプロファイラの修正</A></H3>

<P>　プロファイル機能の一つ、 関数トレースの __PROFILE_EXIT で行っているバッファアンダーフローチェックに誤りがありました。
これを修正しました。 また、アンダーフローを検出した時のレジスタが正しく表示されていませんでしたがこちらも修正しました。</P>
<HR>
<H3><A name="note18-15" id="note18-15">Note 18-15: (PM) LCD 切り替え関数 PM_SetLCDPower() の修正</A></H3>
<P>　PM_SetLCDPower() で LCD 状態を切り替えたとき、 強制的に LED が点灯状態になっていましたが、
LED の状態を変化させないように修正しました。</P>
<HR>
<H3><A name="note18-16" id="note18-16">Note 18-16: (PM) スリープ時の残像を避ける修正</A></H3>
<P>　スリープ時、スリープ前の画面が残像として残ることがありましたが、 スリープするときに画面出力を切ってから1フレーム待つようにして残像が出るのを避けるようにしました。</P>
<HR>
<H3><A name="note18-17" id="note18-17">Note 18-17: (PM) スリープ時の IRQ マスク復帰処理の修正</A></H3>
<P>　スリープ処理を行った後、ARM7 側の IRQ マスクの復帰処理に誤りがありました。
スリープからの復帰要因によっては必要な IRQ 要因を有効にした後、 スリープから復帰してもその要因が有効になったままになっていました。具体的にはスリープ後のカード抜きチェックをカード割り込みによって行なう際に検出できなくなっていました。この不具合の修正を行いました。</P>
<HR>
<H3><A name="note18-18" id="note18-18">Note 18-18: (PM) スリープ時のコールバック呼び出し処理の追加</A></H3>
<P>　以下のようなスリープ時のコールバック呼び出し API を追加しました。 スリープモードに移行する前と、
スリープモードから復帰した後のそれぞれに対して登録することが出来ます。
またコールバックは複数のものを登録することが可能です。</P>
<UL>
  <LI>PM_AppendPreSleepCallback( )
  <LI>PM_PrependPreSleepCallback( )

  <LI>PM_AppendPostSleepCallback( )
  <LI>PM_PrependPostSleepCallback( )
</UL>
<HR>
<H3><A name="note18-19" id="note18-19">Note 18-19: (CARD) 複数回のカード初期化呼び出し処理の修正</A></H3>
<P>　CARD_Init( ) を２度読んだときに、Fifo Callback overridden 警告が出ていました。(
FS_Init( ) は CARD_Init( ) を呼び出していますので CARD_Init( ) と FS_Init(
) を呼んだときも同様。) この警告を出ないように修正しました。</P>
<HR>
<H3><A name="note18-20" id="note18-20">Note 18-20: (CTRDG) カートリッジ関数の追加</A></H3>
<P>　以下のカートリッジ関数を正式公開とし、リファレンスを追加しました。</P>
<UL>
  <LI>CTRDG_IsAgbCartridgePulledOut.html
  <LI>CTRDG_IsOptionCartridgePulledOut.html
  <LI>CTRDG_GetAgbMakerCode.html
  <LI>CTRDG_GetAgbGameCode.html
</UL>
<HR>
<H3><A name="note18-21" id="note18-21">Note 18-21: (RTC) RTC アラーム監視方式の変更</A></H3>
<P>　これまで RTC アラームが発生した場合の割り込みと IS-NITRO-EMULATOR ハードウェアの競合問題により正常に
RTC アラーム割り込みが発生しないという問題がありました。 この問題への対策として
ARM7 にて RTC アラームの状態を定期的に監視するポーリングを行う暫定対策を施していましたが、IS-NITRO-DEBUGGER
ソフトウェア Ver. 1.11 にてハードウェアの競合問題への対策が施されたことを受けて、ポーリング方式を廃止し割り込みをハンドリングする方式へ変更しました。</P>
<HR>
<H3><A name="note18-22" id="note18-22">Note 18-22: (RTC) 日付と曜日の整合性に関する修正</A></H3>
<P>　RTC_GetDate( ) 等の関数により取得できる日付構造体において、年月日に対する曜日の整合性が取れていない状態になる可能性がありました。この問題を修正しました。</P>
<HR>
<H3><A name="note18-23" id="note18-23">Note 18-23: (GX) クリアデプスイメージ単体でのクリアイメージの使用を追加</A></H3>
<P>　クリアカラーイメージスロットにVRAMを割り当てることなく、クリアデプスイメージのみを使用するために以下の設定を追加しました。</P>
<UL>
  <LI>GX_CLEARDEPTH_A
  <LI>GX_CLEARDEPTH_B
  <LI>GX_CLEARDEPTH_C
  <LI>GX_CLEARDEPTH_D
</UL>
<P>この時、クリアイメージはすべて 0x0000 でクリアされ α 値も 0 に設定されます。また、この設定の時にはテクスチャイメージスロット
2 は使用不能となりますので、このスロットに VRAM が割り振られないようにしてください。</P>
<P>また、これを使用したデモが demos/gx/ClearDepthOnly に追加されています。</P>
<HR>
<H3><A name="KnownIssues_2_00_rc1" id="KnownIssues_2_00_rc1">SDK 2.0 RC1 での既知の問題点</A></H3>
<P>　ありません。</P>
<HR>
<H2 style="line-height: 0"><A name="sdk_2_00_fc" id="sdk_2_00_fc">■ NITRO-SDK Version 2.0 FC</A></H2>
<DIV style="text-align: right">
<P style="line-height: 0">(2004/09/30)</P>
</DIV>
<HR>
<H3><A name="note17-01" id="note17-01">Note 17-01: (WBT) 無線ブロック転送ライブラリの正式公開</A></H3>
<P>　テスト公開されていた無線ブロック転送ライブラリ(WBT)が正式公開となりました。
リファレンス及びサンプル <CODE>wbt-1</CODE>, <CODE>wbt-fs</CODE> が用意されています。</P>
<HR>
<H3><A name="note17-02" id="note17-02">Note 17-02: (WM/TP) 無線処理によってタッチパネルのオートサンプリングが停止する不具合の修正</A></H3>
<P>　タッチパネルのオートサンプリング処理が、無線処理起動時に停止してしまうという不具合がありました。
これを修正しました。</P>
<HR>
<H3><A name="note17-03" id="note17-03">Note 17-03: (WM) WMライブラリの変更</A></H3>
<P>1) データシェアリング関数の排他制御が行われていない不具合を修正しました。</P>
<P>2) タッチパネルのオートサンプリングを有効にした状態で無線通信を開始すると
オートサンプリングが止まってしまう不具合がありました。これを修正しました。</P>
<P>3) 異なるスレッドで同時に無線の非同期 API を呼び出した場合に、 処理結果が不正になる不具合がありましたが、修正しました。</P>
<P>4) データシェアリングの送受信関係の排他制御に問題があり、 ごくまれにデータシェアリングが停止する不具合がありました。
これを修正しました。</P>
<P>5) データシェアリング中に送受信の回復不能なエラーが発生した場合、<CODE>WM_StepDataSharing</CODE> が <CODE>WM_ERRCODE_FAILED</CODE> を返しつづけるように仕様を変更しました。</P>
<P>6) <CODE>WM_StartScan</CODE> を行った際に子機が親機を誤認識する可能性が発見されたので対処しました。<BR>
<BR>
　具体的には、「<CODE>GameInfo</CODE> 情報の付加されていないビーコンを取得した際に、 直前の <CODE>WM_StartScan</CODE> によって取得した <CODE>GameInfo</CODE> がそのまま残っており、<CODE>gameInfoLength</CODE> を評価せずに直接 <CODE>GameInfo</CODE> を参照すると間違った親機情報が得られてしまうという」という現象となります。<BR>
<BR>
　この問題への対処として、<CODE>WM_StartScan</CODE> にて親機が発見された際に <CODE>GameInfo</CODE> の付加されていないビーコンであった場合は <CODE>GameInfo</CODE> を 0 クリアする対策を施しました。また、サンプルデモにおいて <CODE>GameInfo</CODE> が直前のスキャンの残留ではなく実際に評価に価することを確認するよう修正しました。</P>
<HR>
<H3><A name="note17-04" id="note17-04">Note 17-04: (DEMO) <CODE>multiboot-Model</CODE> デモの修正</A></H3>
<P><CODE>　multiboot-Model</CODE> のデモにおいて、子機が親機に再接続する場合に親機のチャンネルが不意に変わるために接続できない事がありました。</P>
<P>　IS-NITRO-EMULATOR ハードウェアの有線接続ではチャンネルに関係なくすべてのチャンネルに接続ができてしまうため、

実際に無線を使った時のみこの問題が発生します。</P>
<P>　この不具合を修正しました。</P>
<HR>
<H3><A name="note17-05" id="note17-05">Note 17-05: (DevEnv) <CODE>makebanner</CODE> ツールの修正</A></H3>
<P>　2.0PR6 から追加されたバナーファイル生成を行なう <CODE>makebanner</CODE>ツールに、バナースペックファイルの 1 行目の記述が無視されてしまうという問題がありました。バナースペックファイルの
1 行目がコメント行でない場合、問題が発生します。これを修正しました。</P>
<P>　またバナースペックファイルの文字コードが正しくない場合、 エラーを出さずに空ファイルを出力してしまう点を修正し、
リファレンスの文字コードについての記述を &quot;BOM 付きの UTF-16LE&quot;
に変更しました。</P>
<HR>
<H3><A name="note17-06" id="note17-06">Note 17-06: (DevEnv) <CODE>LIBSYSCALL</CODE> 処理の修正、および <CODE>libsyscall.a</CODE> の格納位置の変更</A></H3>
<P>　最終 ROM への組み込み用の <CODE>libsyscall.a</CODE> を <CODE>make</CODE> 変数 <CODE>LIBSYSCALL</CODE> で指定しているにもかかわらず、リンカのリンクオーダーの仕様によりデフォルトの
<CODE>libsyscall.a</CODE> がリンクされたままになっていました。</P>
<P>　<CODE>LIBSYSCALL</CODE> の指定において、リンクオーダー仕様への依存を回避するため、デフォルトの
<CODE>libsyscall.a</CODE> の格納位置を他の SDK ライブラリのものと分離しました。これにより <CODE>LIBSYSCALL</CODE> で指定した <CODE>libsyscall.a</CODE> がリンクオーダー仕様に依らずに優先的にリンクされるようになります。</P>
<P>　デフォルトの <CODE>libsyscall.a</CODE> は本バージョンから以下に格納されています。<CODE>libsyscall.a</CODE> は Debug/Release/Rom 版共通です。</P>
<BLOCKQUOTE><CODE>$NitroSDK/lib/ARM9-TS/etc/libsyscall.a</CODE></BLOCKQUOTE>
<P>　<FONT color="#ff0000">CodeWarrior IDE をお使いの方は、プロジェクトファイルでの <CODE>libsyscall.a</CODE> の格納位置の指定を適時修正する必要があります。</FONT></P>
<HR>
<H3><A name="note17-07" id="note17-07">Note 17-07: (DevEnv) <CODE>NITRO_COMPRESS</CODE> におけるオーバーレイの圧縮処理修正</A></H3>
<P><CODE>　compstatic</CODE> ツールにおいてオーバーレイの圧縮処理を行なう場合に問題が発生し、 正常な圧縮データを生成しない場合がありました。この不具合を修正しました。</P>
<HR>
<H3><A name="note17-08" id="note17-08">Note 17-08: (DevEnv) バナーファイルのフォントセットの変更</A></H3>
<P>　バナーファイルのフォントセットを最新のものに差し替えました。 いくつかの文字が削減されていますので、ご注意ください。</P>
<P>　またバナーファイルについての詳細は IPL バナーに関するガイドライン文書をご参照ください。</P>
<HR>
<H3><A name="note17-09" id="note17-09">Note 17-09: (DevEnv) ROM スペックファイルにおけるバナーファイルの位置制限と対策</A></H3>
<P>　ROM 内に格納されるバナーファイルの先頭が 512 バイトアラインメントされていない場合、
正常な動作が行なわれないことが分かりました。 スペックファイルで <CODE>AlignAll</CODE> コマンドにより 512 バイト未満の値を設定していた場合、 これによる問題が発生する場合があります。</P>
<P>　これを回避するために <CODE>Segment All</CODE> の動作を <CODE>AlignAll</CODE> での設定値によらず バナーファイルが 512 バイトアラインメントされるように変更しました。</P>
<P>　<CODE>AlignAll</CODE> コマンドを使用されていない場合は <CODE>BannerFile</CODE> コマンドの前に <CODE>Align 512</CODE> などを挿入していただく必要がありますのでご注意ください。</P>
<HR>
<H3><A name="note17-10" id="note17-10">Note 17-10: (GX)レジスタの定義不具合の修正</A></H3>
<P>　以下のハードウェアレジスタマップに関する定義値に誤りがありました。SDK中ではこれらの値は使用されていませんので、
これによりSDKの動作に直接の影響はありません。</P>
<BLOCKQUOTE><CODE>REG_GX_VRAMCNT_C_MST_SIZE<BR>
REG_GX_VRAMCNT_C_MST_MASK</CODE><BR>
<CODE>REG_GX_VRAMCNT_D_MST_SIZE<BR>
REG_GX_VRAMCNT_D_MST_MASK<BR>
REG_GX_VRAMCNT_E_MST_SIZE<BR>
REG_GX_VRAMCNT_E_MST_MASK</CODE></BLOCKQUOTE>
<P>　この不具合は修正されました。</P>
<HR>
<H3><A name="note17-11" id="note17-11">Note 17-11: (MI) <CODE>MI_SendGXCommandAsyncFast</CODE> の修正</A></H3>
<P>　<CODE>MI_SendGXCommandAsyncFast()</CODE> で起動したDMAのコールバックの中から別の <CODE>MI_SendGXCommandAsyncFast()</CODE> を起動できるようにしました。</P>
<HR>
<H3><A name="note17-12" id="note17-12">Note 17-12: (MI) <CODE>MI_SendGXCommand()</CODE> の修正</A></H3>
<P>　<CODE>MI_SendGXCommand()</CODE> が自動起動 DMA を使用していたため、他の自動起動DMAと衝突する可能性がありました。
そこで <CODE>MI_SendGXCommand()</CODE> は即時 DMA のループにして自動起動を排除しました。これまでの<CODE>MI_SendGXCommand()</CODE> は <CODE>MI_SendGXCommandFast()</CODE> と改名して残してありますが、 自動起動 DMA を含むので使用には十分注意して下さい。</P>
<HR>
<H3><A name="note17-13" id="note17-13">Note 17-13: (FS) <CODE>FS_GetPathName()</CODE> 呼び出し時の不具合修正</A></H3>
<P><CODE>　FS_GetPathName() </CODE>関数を呼び出した場合に、内部処理のミスで <CODE>SDK_ASSERT</CODE> により停止する可能性があるという不具合が確認されました</P>
<P>　この問題を修正しました。</P>
<HR>
<H3><A name="note17-14" id="note17-14">Note 17-14: (OS) <CODE>OS_Init()</CODE> で呼ばれる初期化関数の追加</A></H3>
<P>　ARM9側では、<CODE>OS_Init()</CODE> から <CODE>CARD_Init()</CODE> を呼ぶようにしました。</P>
<HR>
<H3><A name="note17-15" id="note17-15">Note 17-15: (CARD) カード抜き検出処理の変更</A></H3>
<P>　カード抜き検出処理を修正しました。 またこれまではスリープ中のカード抜きなど正確に動作しない個所がありました。</P>

<P>　カード抜き検出方法について、これまでは ARM9で <CODE>CARD_IREQ</CODE> 割り込みをチェックしていましたが、新しい方式では ARM7 でポーリングするようになりました。通常は
<CODE>CARD_IREQ</CODE> 割り込みの発生を調べていますが、ROM ヘッダ情報を参照してそのカードが <CODE>CARD_IREQ</CODE> 割り込みを使用する場合には カード ID の読み込みによって行います。 そして抜きを検出したら、ARM7
から ARM9 に通達します。</P>
<HR>
<H3><A name="note17-16" id="note17-16">Note 17-16: (TP) validity 条件の変更</A></H3>
<P>ペンリリース時の座標飛びの対策として、<CODE>INVALID</CODE> となる条件が変更され、以前よりも厳しく判定されるようになりました。 <CODE>INVALID</CODE> フラグが立つケースが多少増える可能性があります。</P>
<HR>
<H3><A name="KnownIssues_2_00_fc" id="KnownIssues_2_00_fc">SDK 2.0 FC での既知の問題点</A></H3>
<UL>
  <LI><CODE>make</CODE> 時に <CODE>NITRO_COMPRESS</CODE> を指定している場合、<CODE>.nef</CODE> ファイルと常駐モジュールのバイナリである<CODE>.sbin</CODE> ファイルのベース名 (ファイル名から拡張子を除いた部分) が異なっている場合にエラーが発生します。
  <LI><CODE>mb_child.srl</CODE> において親機のユーザ名が 10文字になっている場合、正常に動きません。
</UL>
<HR>
<H3><A name="Information_2_00_fc" id="Information_2_00_fc">SDK 2.0 FC での追加情報</A></H3>
<H4>カートリッジを使用する際の追加情報</H4>
<P>　カートリッジの IREQ 割り込みでスリープから復帰する場合、カートリッジが抜けた時だけでなく、
IREQ割り込みを何かの用途に使用しているカートリッジデバイスからの割り込みで復帰する可能性があります。</P>
<P>　従って、スリープ状態からカートリッジが抜けたことで復帰したい場合は、カートリッジスロットにささっているカートリッジがアプリケーション側で想定しているものであることが
確認できている場合のみ行ってください。 そうでなければ、スリープ復帰のトリガに
<CODE>PM_TRIGGER_CARTRIDGE</CODE> を指定しないで下さい。</P>

<HR>
<H2 style="line-height: 0"><A name="sdk_2_00_pr7" id="sdk_2_00_pr7">■ NITRO-SDK Version 2.0 PR7</A></H2>
<DIV style="text-align: right">
<P style="line-height: 0">(2004/09/21)</P>
</DIV>
<HR>
<H3><A name="note16-01" id="note16-01">Note 16-01: (WM) WMライブラリの変更</A></H3>
<P>1) マルチブート親機で 複数親機が同時に存在する場合に特定の親機が他の親機より見つかりにくくなる場合があるという現象がありましたが、
修正しました。<BR>
<BR>
2) 無線ライブラリとサウンドライブラリの競合問題で、 無線ライブラリの通信中にサウンドライブラリを使用して負荷の高い処理を行うと通信に異常を来たすという不具合がありました。
無線ライブラリの処理をサウンドより優先させることで対処しました。<BR>
<BR>
3) WMライブラリにおいて WM_Initialize 関数に渡すバッファへのライトがキャッシュ上でライトバックされずにダーティ状態で残っている場合に
WMライブラリの動作に支障を来たすという不具合がありましたが、修正しました。<BR>
<BR>
4) PR6 までには WM_StartMPEx の minPollBmpMode が TRUE の設定で親機が一定の時間、
特定の子機にしか通信しなかった場合に残りの子機がタイムアウトによる切断を起こしてしまう不具合がありました。
特に 8 番以上の port による Sequential 通信を利用していた場合、 一部の子機を強制切断すると、再送によって上記状態が容易に発生します。
この不具合への対処として、minPollBmpMode が TRUE の場合にのみ、 60 フレームに
1 回の間隔で、 MP 通信時に親子共に送信可能バイト数を 0 バイトに設定した
Keep Alive フレームを送信するように変更しました。<BR>
<BR>
5) WM_GetMPReceiveBufferSize および WM_MP_SIZE_PARENT_RECEIVE_BUFFER の計算式の誤りで、
必要なサイズより少ない値を返すことがあった不具合を修正しました。<BR>
<BR>
6) リファレンスに「無線通信時間計算シート」を追加しました。 親子の最大送信サイズから、MP通信の所要時間を計算することができます<BR>
<BR>
7) port受信コールバックに対するWM_STATECODE_CONNECTED, DISCONNECTEDの通知において、
aidには常に接続相手のAIDが入るようになりました。自分のAIDはmyAidに代入されます。<BR>
<BR>
8) 無線に関する簡易ドキュメントを docs/TechnicalNotes/WirelessManager.doc
に追加しました。ドラフト版の公開となります。<BR>
</P>
<HR>
<H3><A name="note16-02" id="note16-02">Note 16-02: (FS)圧縮されたオーバーレイのロード時の不具合修正</A></H3>
<P>NITRO_COMPRESS を指定してビルドしたプログラムでオーバーレイをロードする際に、
BSS 領域全体がクリアされず初期値 0 の変数が正しく初期化されないことがあるという不具合が確認され、この問題を修正しました。</P>
<HR>
<H3><A name="note16-03" id="note16-03">Note 16-03: (CTRDG) カートリッジ抜き検出APIの作成</A></H3>
<P>ゲーム中にカートリッジを抜いたことを検出してコールバックが呼び出される仕組みを作成しました。
OS_Init() から呼び出される CTRDG_Init() で カートリッジライブラリの初期化を行えば有効になります。
デフォルトでは何もしません。</P>
<HR>
<H3><A name="note16-04" id="note16-04">Note 16-04: (CARD) カード抜き検出APIの作成</A></H3>
<P>　 ゲーム中にカードを抜いたことを検出してコールバックが呼び出される仕組みを作成しました。
CARD_Init() でカードライブラリの初期化を行えば有効になり、 デフォルトでは両プロセッサをhalt状態にして停止します。</P>
<HR>
<H3><A name="note16-05" id="note16-05">Note 16-05: (GX) G3Cでのディスプレイリスト生成時の不具合修正</A></H3>
<P>G3Cでパックされたディスプレイリストを生成する際に、 ジオメトリFIFOのハードウェア不具合への対策処理で不定なデータが書き込まれてしまう場合がありました。
この不具合は修正されました。</P>
<HR>
<H3><A name="note16-06" id="note16-06">Note 16-06: (OS) RTC 割り込みの処理</A></H3>
<P>これまで IS-NITRO-DEBUGGER との競合問題により ARM7 でのポーリング処理によってエミュレートしていた
RTC 割り込みの処理を FinalRom 版ライブラリにおいてのみ変更し、 NITRO ハードウェアの
RTC 割り込みを使用するようになりました。<BR>
<BR>
Debug 版、Release 版では従来と同じようにポーリングによって RTC 割り込みをエミュレートしています。</P>
<HR>
<H3><A name="note16-07" id="note16-07">Note 16-07: (MIC) 自動サンプリング開始関数のI/F変更</A></H3>
<P>MIC_StartAutoSampling、MIC_StartAutoSamplingAsync関数において、パラメータに構造体を直接指定するI/Fでしたが、スタックの無
駄を省くため構造体へのポインタを指定するI/Fに変更しました。</P>
<HR>
<H3><A name="note16-08" id="note16-08">Note 16-08: (SND) サウンドライブラリの更新</A></H3>
<P>NITRO-SDK で配布するサウンドラインブラリが2004年9月16日版となりました。</P>
<HR>
<H3><A name="note16-09" id="note16-09">Note 16-09: (DevEnv) バナーファイルのテストビューア生成ツールの収録</A></H3>
<P>バナーファイルのテストビューア生成ツール addbanner を収録しました。 このツールは、バナー情報を
NITRO の画面上で表示するための ROM ファイルを生成します。</P>
<HR>
<H3><A name="note16-10" id="note16-10">Note 16-10: (DEMO) 最終 ROM 作成のデモの追加</A></H3>
<P>最終 ROM 作成を行なうデモを追加しました。 このデモは最終 ROM 内へ収録する必要のあるファイルを組みこむ処理の例を示しています。<BR>
<BR>
このデモで示している情報は SDK リリース時点でのものです。 リリース以降に最終
ROM 提出に関するルールが変更になっている可能性もあるため、 最新の情報については弊社サポート
WEB ページなどでご確認ください。</P>
<HR>
<H3><A name="KnownIssues_2_00_pr7" id="KnownIssues_2_00_pr7">SDK 2.0 PR7 での既知の問題点</A></H3>
<P>attachsign ツールのリファレンスが揃っていません。</P>
<HR>
<H2 style="line-height: 0"><A name="sdk_2_00_pr6" id="sdk_2_00_pr6">■ NITRO-SDK Version 2.0 PR6</A></H2>
<DIV style="text-align: right">
<P style="line-height: 0">(2004/09/13)</P>
</DIV>
<HR>
<H3><A name="note15-01" id="note15-01">Note 15-01: (OS) 本体情報を取得する関数の追加</A></H3>
<P>　ニンテンドー DS 本体内に保存されているオーナー情報などを取得する関数を追加しました。エンドユーザーが本体の
IPL プログラムによって編集したオーナー情報を取得することができます。</P>
<P>　また、本体の無線ハードウェアの MAC アドレスを取得する関数も追加されています。MAC
アドレスはハードウェア毎に異なる値が設定されており、無線機能を使用しないアプリケーションであっても利用することが可能です。</P>
<P>　新規に追加された関数は以下の 3 つです。</P>
<UL>
  <LI><CODE>OS_GetOwnerInfo()</CODE>
  <LI><CODE>OS_GetOwnerRtcOffset()</CODE>
  <LI><CODE>OS_GetMacAddress()</CODE>
</UL>
<HR>
<H3><A name="note15-02" id="note15-02">Note 15-02: (OS) ソフトリセットの実装</A></H3>
<P>　ソフトリセットを実装し、エントリポイントからプログラムを再実行することが出来るようになりました。リセット時に任意の
u32 値を与えて、再実行のモジュールにそれを渡すことも可能です。本関数はハードウェアの初期化を行ないません。このため自動起動
DMA のような処理は本関数を呼び出す前に終了させておく必要があります。</P>
<P>　ただし起動時に読み込まれたROMデータのうち、先頭 16KB はリセット時に再ロードしませんので、その部分が破壊されている場合は再実行することができません。その判定はライブラリでは行いませんのでアプリケーション側で破壊しないように注意する必要があります。</P>
<P>　マルチブートで子機として起動した場合、<CODE>OS_ResetSystem()</CODE> による再起動はできません。SDK では安全のために <CODE>OS_ResetSystem()</CODE> 内部で <CODE>OS_Panic()</CODE> を呼び出し、停止(メッセージ出力[FINALROM 版以外]後、永久ループ)します。この振る舞いに問題がある場合は、<CODE>MB_IsMultiBootChild()</CODE> でマルチブート子機かどうかを判定し、場合分けをしてください。</P>
<HR>
<H3><A name="note15-03" id="note15-03">Note 15-03: (OS) メモリ割り当てシステムを破棄する <CODE>OS_ClearAlloc()</CODE> の追加</A></H3>
<P>　<CODE>OS_InitAlloc()</CODE> でアリーナ上にメモリ割り当てシステムを構築した後、それを破棄するための関数
<CODE>OS_ClearAlloc()</CODE> を追加しました。<CODE>OS_ClearAlloc()</CODE> を呼んだ後は同じアリーナ上に新たにメモリ割り当てシステムを構築することができます。</P>
<HR>
<H3><A name="note15-04" id="note15-04">Note 15-04: (OS) アラームセット時のエラー表示の変更</A></H3>
<P>　アラーム、Vカウントアラームで使用されているアラーム構造体を用いて新たなアラームをセットしようとしたときに、ビルド方法に関係なく
<CODE>OS_Panic()</CODE> で停止するようにしました。これまではDEBUG ビルドのみ停止して、その他の場合は永久ループに入っていました。</P>
<HR>
<H3><A name="note15-05" id="note15-05">Note 15-05: (MI) DMAレジスタに関する定義の追加</A></H3>
<P>　DMAレジスタのビット定義などを <CODE>$NitroSDK/include/nitro/mi/dma.h</CODE> に追加しました。これまでこれらの定義はライブラリ構築用のツリー内のヘッダファイルで定義されていましたが、アプリケーション側からも使用できるようにとのご要望により収録位置の変更となりました。</P>
<HR>
<H3><A name="note15-06" id="note15-06">Note 15-06: (WM) 無線コントロールライブラリの修正、機能追加</A></H3>
<OL>
  <LI>ライブラリ初期化時、及び終了時の処理を細分化し、きめ細かく制御するための関数群を追加しました。追加された関数は以下の通りです。<BR>
  <BR>
  <U>初期化時</U>
  <BLOCKQUOTE>
  <DL>
    <DT><CODE>WM_Init</CODE>
    <DD>ライブラリが必要とするワークバッファを初期化する同期関数。
    <DT><CODE>WM_Enable</CODE>
    <DD>無線ハードウェアを使用許可状態にする。同時にLEDの点滅が開始される。
    <DT><CODE>WM_PowerOn</CODE>
    <DD>無線ハードウェアを起動し、必要な初期化を行う。
  </DL>
  </BLOCKQUOTE>
  <U>終了時</U>
  <BLOCKQUOTE>
  <DL>
    <DT><CODE>WM_PowerOff</CODE>
    <DD>無線ハードウェアをシャットダウンする。
    <DT><CODE>WM_Disable</CODE>
    <DD>無線ハードウェアを使用禁止状態にする。同時にLEDの点滅は停止される。
    <DT><CODE>WM_Finish</CODE>
    <DD>ライブラリを終了し、ワークバッファを解放する同期関数。
  </DL>
  </BLOCKQUOTE>
  <P>　バッテリの消耗を抑えるため、実際の無線通信が始まる直前まで無線ハードウェアの起動(<CODE>WM_PowerOn</CODE>)を行なわないように、また無線通信の必要がないときはなるべく無線ハードウェアをシャットダウン(<CODE>WM_PowerOff</CODE>)するように心がけてください。</P>
  <LI>
  <P>無線ライブラリとサウンドライブラリが使用する DMA が ARM7 において競合することにより、サウンドを動作させながらでは無線で通信できないという不具合がありました。サウンドに若干の制限が残るものの、無線通信できないという問題点は解消されました。これは
  <A href="#note15-16">Note 15-16: (WM/SND) 無線とサウンド同時使用時の不具合対処</A> においても説明されています。</P>
  <LI>
  <P>電波状態が悪い場合に、送信できていないにもかかわらず <CODE>WM_SetMPDataToPort()</CODE> のコールバックに成功値が返ることがあるというバグを修正しました。これにより、まれにデータシェアリングが停止するという問題が解決しています。</P>
  <LI>
  <P>pollBitmap (Poll マップ) が自分宛でない場合の処理に問題があり、pollBitmap
  によって通信相手の子機を切り替えている場合に不具合が生じていました。この不具合は修正されました。</P>
  <LI>
  <P>親機として通信を開始する際、一回の MP 通信で送信可能なデータ量の限界を超える値を指定すると
  WM_INVALID_PARAMETER エラーが返されるように制限を加えました。また、プログラミングガイドラインに記載されている転送データ量の推奨値を超える値を指定すると警告がデバッグ出力される機能を追加しました。</P>
  <LI>
  <P>子機側アプリケーションにおいて、従来は <CODE>WM_StartMP()</CODE> へのコールバックの引数である state 値に <CODE>WM_STATECODE_MP_IND</CODE> が設定された場合に <CODE>errcode</CODE> として <CODE>WM_ERRCODE_SUCCESS</CODE> しか渡されることはありませんでしたが、NITRO-SDK 2.0PR6 からは MP の pollBitmap
  に自分が含まれていなかった場合に <CODE>WM_ERRCODE_INVALID_POLLBITMAP</CODE> が渡されるようになりました。<BR>
  この状況は MP 通信において子機を 2 台以上接続した場合にはしばしば発生しますので、回復不能なエラーとして扱ってはいけません。</P>
  <LI>
  <P>子機側アプリケーションにおいて、従来は <CODE>WM_StartMP()</CODE> へのコールバックの引数である state 値に <CODE>WM_STATECODE_MPACK_IND</CODE> が設定された場合に <CODE>errcode</CODE> として <CODE>WM_ERRCODE_SUCCESS</CODE>, <CODE>WM_ERRCODE_TIMEOUT</CODE>, <CODE>WM_ERRCODE_FAILED</CODE> が渡されていました。これを以下のように変更しました。</P>
  <UL>
    <LI>対応する MP フレームにおいて pollBitmap に自分が含まれていなかった場合に
    <CODE>WM_ERRCODE_INVALID_POLLBITMAP</CODE> が返るように変更されました。これは MP 通信において子機を 2 台以上接続した場合にはしばしば発生しますので、回復不能なエラーとして扱ってはいけません。
    <LI>MPACK の pollBitmap に自分が含まれていた場合 (すなわち親機が自分の返信を受け取れなかった場合)
    に <CODE>WM_ERRCODE_FAILED</CODE> を返していました。これは <CODE>WM_ERRCODE_SEND_FAILED</CODE> に変更されました。<BR>
  </UL>
  <BR>
  <LI>
  <P><CODE>WM_SetMPData()</CODE> および <CODE>WM_SetMPDataToPort()</CODE> のコールバックへ渡される errcode として <CODE>WM_ERRCODE_SUCCESS</CODE>, <CODE>WM_ERRCODE_TIMEOUT</CODE>, <CODE>WM_ERRCODE_FAILED</CODE> が設定されていましたが、<CODE>WM_ERRCODE_TIMEOUT</CODE> と <CODE>WM_ERRCODE_FAILED</CODE> は <CODE>WM_ERRCODE_SEND_FAILED</CODE> に統一されました。<BR>
  また、その際の <CODE>WMPortSendCallback.destBitmap</CODE> には、送信が失敗しリトライを試みなければならない子機の aid の bitmap が収められるようになりました。（送信中に切断された子機は
  destBitmap には含まれません）</P>
  <LI>
  <P>親機側で毎MP通信の終了時に <CODE>WM_StartMP()</CODE> のコールバックの state 値として <CODE>WM_STATECODE_MPEND_IND</CODE> が設定されたときにおけるコールバック呼び出しの手順が変更になりました。従来は、</P>
  <OL>
    <LI>送信完了コールバック (<CODE>WM_SetMPDataToPort()</CODE> の callback)
    <LI><CODE>WM_STATECODE_MPEND_IND</CODE> (<CODE>WM_StartMP()</CODE> の callback)
    <LI>port 受信コールバック (<CODE>WM_SetPortCallback()</CODE> で登録した各 callback)
  </OL>
  <BR>
  という順番で callback が呼ばれていましたが、これを<BR>
  <OL>
    <LI>port 受信コールバック (<CODE>WM_SetPortCallback()</CODE> で登録した各 callback)
    <LI>送信完了コールバック (<CODE>WM_SetMPDataToPort()</CODE> の callback)
    <LI><CODE>WM_STATECODE_MPEND_IND</CODE> (<CODE>WM_StartMP() </CODE>の callback)
  </OL>
  <BR>
  という順番に変更しました。これは、<CODE>WM_SetMPDataToPort()</CODE> のコールバックで次の <CODE>WM_SetMPDataToPort()</CODE> を行なうという標準的な設計でプログラムを書いていた場合に、最新の受信データを反映したデータを直ちに送信することを可能とするためです。<BR>
  <BR>
  <LI>
  <P><CODE>WM_SetMPDataToPortEx()</CODE> 関数を新設しました。送信完了コールバックの引数にユーザ定義のデータを追加できます。</P>
  <LI>
  <P><CODE>WMParentParam</CODE> 中の子機の最大送信サイズ (<CODE>childMaxSize</CODE>) の処理において 2 bytes 分指定値より少ないサイズが設定されていた不具合が修正されました。
  <CODE>parentMaxSize, childMaxSize</CODE> はそれぞれ送信したいユーザデータの最大サイズを指定するパラメータであり、無線ライブラリ内部の制御データのサイズを考慮する必要はありません。</P>
  <LI>
  <P>NITRO-SDK 2.0PR5 では、キーシェアリングを行う場合に、最大送信バイト数にキーシェアリングが使用分の値を明示的に加えておく必要がありましたが、<CODE>WMParentParam.KS_Flag</CODE> に TRUE を設定しておくことで自動的にキーシェアリングの使用分だけ最大送信バイト数が拡張されるようになりました。</P>
  <LI>
  <P><CODE>WM_SIZE_MP_PARENT_SEND_BUFFER, WM_SIZE_MP_PARENT_RECEIVE_BUFFER, WM_SIZE_MP_CHILD_SEND_BUFFER,
  WM_SIZE_MP_CHILD_RECEIVE_BUFFER</CODE> の各関数マクロに <CODE>ksFlag</CODE> という引数が追加されました。<BR>
  キーシェアリングを行う場合のバッファサイズを算出する場合は <CODE>ksFlag </CODE>に <CODE>TRUE</CODE> を、さもなくば <CODE>FALSE </CODE>を指定してください。</P>
  <LI>
  <P>WM_Reset を呼び出した場合に正しく子機接続情報がリセットされない不具合を修正しました。</P>
  <LI>
  <P>動的に MP 通信の頻度を変更する WM_SetMPFrequency を新設しました。</P>
</OL>
<HR>
<H3><A name="note15-07" id="note15-07">Note 15-07: (WM) 無線強度のアイコンの収録</A></H3>
<P>　無線強度を表現するためのアイコンを以下に収録しました。これらの使用についての規定は、無線通信関連のガイドラインを
ご覧ください。</P>
<BLOCKQUOTE><CODE>$NitroSDK/data/wl_icons</CODE></BLOCKQUOTE>
<HR>
<H3><A name="note15-08" id="note15-08">Note 15-08: (WBT) ブロック転送ライブラリのテスト公開</A></H3>
<P>　無線ライブラリ(WM)の MP 通信を使用して親子間でブロック転送プロトコルを実現するライブラリ
WBT をテスト公開しました。</P>
<P>　現在、テスト公開のため以下の問題があります。</P>
<UL>
  <LI>WBT デモの DEBUG 版は正常に動作しません。
  <LI>WBT ライブラリについては、2.0PR6 公開時点においてリファレンスが収録されておりません。
</UL>
<HR>
<H3><A name="note15-09" id="note15-09">Note 15-09: (SND) サウンドライブラリの更新</A></H3>
<P>　NITRO-SDK で配布するサウンドラインブラリが2004年9月2日版となりました。</P>
<HR>
<H3><A name="note15-10" id="note15-10">Note 15-10: (DevEnv) 圧縮された常駐モジュールへの対応</A></H3>
<P>　IPL でロードされる常駐モジュールを圧縮するための機構を追加しました。これにより
ROM 容量および起動時の初期ロードサイズを節約できるようになりました。</P>
<P>　SDK の make システムでは、マクロ変数 NITRO_COMPRESS に何らかの値が設定されている場合この機能が自動的に有効になります。展開時間とのトレードオフをご考慮の上お使いください。</P>
<P>　SDK で圧縮が有効になると、以下のような処理が行なわれます。</P>
<OL>
  <LI><CODE>compstatic</CODE> コマンドによって、常駐モジュール実行バイナリの先頭部を除いた領域の圧縮処理を行なう。
  <LI>得られた圧縮モジュールファイルを通常のモジュールファイルと同様に <CODE>makerom</CODE> コマンド で ROM 内部に格納する。
  <LI>圧縮されたモジュールは実行後 <CODE>crt0.c</CODE> 内部で展開される。
</OL>
<P>　常駐モジュールと同様に Overlay モジュールの圧縮も行なうことが可能です。Overlay
モジュールの展開処理については、関連 API 内部に統合されているため、こうした
API 経由でアクセスを行なう場合は、特に気にする必要はありません。</P>
<P>　この処理の実装のため、以下のツール関連ファイルが NITRO-SDK 2.0PR5 のものから変更されています。独自の
rsf ファイルおよび lcf.template ファイルをお使いの場合はこれらのファイルへの修正が必要です。</P>
<BLOCKQUOTE><CODE>$NitroSDK/include/nitro/specfiles/ROM-TS.rsf<BR>
$NitroSDK/include/nitro/specfiles/ARM9-TS.lcf.template</CODE></BLOCKQUOTE>
<P>　この圧縮展開処理はマルチブートの子機へ渡される ROM ファイル内の実行モジュールに対しても適用することができます。</P>
<HR>
<H3><A name="note15-11" id="note15-11">Note 15-11: (DevEnv) make run による nitload の起動</A></H3>
<P>　make コマンドのターゲットに run を指定することで IS-NITRO-DEBUGGER パッケージに収録されているサンプルプログラムの
nitload を起動し、srl ファイルのエミュレーションを開始するよう変更しました。</P>
<HR>
<H3><A name="note15-12" id="note15-12">Note 15-12: (DevEnv) 各ハードウェアバージョンに対応する ferret コンポーネントの提供</A></H3>
<P>　IS-NITRO-EMULATOR などの各 TS 版のハードウェアバージョンに対応した ferret
(無線機能なしの ARM7 コンポーネント)を収録しました。ただし通常は mongoose
(無線機能ありの ARM7 コンポーネント) を使用することで問題はないため、TEG
環境のソースを無変更でコンパイルするなどの場合などを除き、TS 環境でferret
を使用する必要はありません。</P>
<HR>
<H3><A name="note15-13" id="note15-13">Note 15-13: (OS) OS_CheckHeap() の修正</A></H3>
<P>　OS_CheckHeap() 内でヒープのチェックを行ってチェックにひっかかった時に、割り込み禁止状態で関数を抜けていましたが、これを修正しました。</P>
<HR>
<H3><A name="note15-14" id="note15-14">Note 15-14: (MI) ntrcomp.exe のランレングス圧縮時の不具合修正</A></H3>
<P>　tools/bin/ntrcompでランレングス圧縮ルーチンに不具合があり、ファイルの終端で非圧縮データブロックサイズが129〜130バイトある場合に終端129〜130バイトが正常に展開できない事がありました。</P>
<P>　この不具合は更新されました。</P>
<HR>
<H3><A name="note15-15" id="note15-15">Note 15-15: (MI) DMA 処理の修正</A></H3>
<P>　自動起動 DMA が複数立ち上がらないようにチェックする処理で起動しているものと起動していないものを逆に取り違えていました。これを修正しチェックを正しく行うようにしました。</P>
<HR>
<H3><A name="note15-16" id="note15-16">Note 15-16: (WM/SND) 無線とサウンド同時使用時の不具合対処</A></H3>
<P>　NITRO-SDK 2.0PR5 において、無線とサウンドを同時に使用したときに無線が正常に動作しなくなる不具合がありました。これは修正されました。</P>
<P>　ただし DMA ハードウェアの仕様からサンプリングレート 44kHz の波形データを
3 オクターブ高い音程で鳴らすといったようなデータ転送負荷が非常に大きな再生を行なうと音が途切れる可能性があります。ご注意ください。</P>
<HR>
<H3><A name="note15-17" id="note15-17">Note 15-17: (MB) MB_GetSegmentLength 関数の返り値に関する不具合の修正</A></H3>
<P>　<CODE>MB_GetSegmentLength()</CODE>関数の返り値が、実際に必要とされるサイズより小さな値になるという問題が確認されました。
　この不具合は修正されました。</P>
<HR>
<H3><A name="note15-18" id="note15-18">Note 15-18: (MB) Multiboot サンプルの Debug 版における動作不具合の修正</A></H3>
<P>　NITRO-SDK 2.0PR5 の MB デモ Multiboot サンプルの Debug 版において、起動時に
GX のエラーで停止してしまうという不具合がありました。また、同じく Debug
版において、ダウンロード処理中の割り込みハンドラ内でスタック不足により異常動作してしまうという不具合がありました。
　これらの不具合は修正されました。</P>
<HR>
<H3><A name="note15-19" id="note15-19">Note 15-19: (CARD) バックアップアクセス関数の初回呼び出し時の問題の修正</A></H3>
<P>　CARD のバックアップアクセス関数を呼び出した時に、初回のみ関数が失敗することがあるという問題が確認されました。
　この不具合は修正されました。</P>
<HR>
<H3><A name="note15-20" id="note15-20">Note 15-20: (PRC) CharacterRecognition-1 デモのスタック溢れの修正</A></H3>
<P>　NITRO-SDK 2.0PR5 の CharacterRecognition-1 デモが、スタック溢れにより正常に動作していませんでした。
　これを修正しました。</P>
<HR>
<H3><A name="note15-21" id="note15-21">Note 15-21: (OS) OS_TPrintf(簡易版 printf) の追加</A></H3>
<P>OS_VSNPrintf を使用することで、スタックの消費サイズを節約したコンソール出力関数の
OS_TPrintf などを追加しました。この OS_TPrintf では使用できるフォーマット書式から浮動小数値などを除外することによって、コード使用量およびスタック使用量を節約しています。</P>
<P>使用できるフォーマット書式は OS_VSNPrintf に依存しています。詳しくは OS_VSNPrintf
のマニュアルをご覧ください。</P>
<HR>
<H3><A name="KnownIssues_2_00_pr6" id="KnownIssues_2_00_pr6">SDK 2.0 PR6 での既知の問題点</A></H3>
<P>compstatic, attachsign ツールのリファレンスが揃っていません。</P>
<HR>
<H2 style="line-height: 0"><A name="sdk_2_00_pr5" id="sdk_2_00_pr5">■ NITRO-SDK Version 2.0 PR5</A></H2>
<DIV style="text-align: right">
<P style="line-height: 0">(2004/08/30)</P>
</DIV>
<HR>
<H3><A name="note14-01" id="note14-01">Note 14-01: (WM) [重要] 無線コントロールライブラリの修正、機能追加 </A></H3>
<H4>1) 親機がブロードキャストするデータ構造の変更</H4>
<P>　システム予約領域からユーザー名、ゲーム名情報が削除され、デベロッパー領域が64バイトから最大112バイトに拡張されました。ユーザー名、ゲーム名については必要に応じてデベロッパー領域に格納して頂く仕様となりました。</P>
<H4>2) 子機が親機に接続する際に24バイトの子機情報を親機に通知する機能の追加</H4>
<P>　24 バイトの子機情報の内容についてはデベロッパーに解放されていますので、アプリケーション独自の子機情報を親機に通知することができます。
これにともない、<A href="wm/wm/WM_StartConnect.html">WM_StartConnect 関数</A>、及び <A href="wm/wm/WMStartParentCallback.html">WMStartParentCallback 構造体</A>についてインターフェースの変更が行われました。</P>
<H4>3) MP 通信をより詳細に制御する機能の追加</H4>
<P>　SDK-PR4 までは 1フレーム(1ピクチャーフレームの意)に 1 回のMP通信を行うか、フレームを無視した連続転送を行うか、の
2 つのモードのみが選択できる状態でしたが、1 フレームに複数回の MP 通信を行う機能が追加されました。</P>
<P>　これにともない、<A href="wm/wm/WM_StartMP.html">WM_StartMP 関数</A> にインターフェースの変更が行われました。また、より詳細な設定を行う <A href="wm/wm/WM_StartMPEx.html">WM_StartMPEx 関数</A> が新設されました。</P>
<H4>4) 通信中に親機がブロードキャストするデータを変更する機能の拡張</H4>
<P>　通信中にエントリー受付、マルチブート受付などの親機属性を変更する機能が追加されました。</P>
<P>　これにともない、<A href="wm/wm/WM_SetGameInfo.html">WM_SetGameInfo 関数</A> にインターフェースの変更が行われました。</P>
<H4>5) 以下の単機能APIの追加</H4>
<BLOCKQUOTE>
<DL>
  <DT>WM_DisconnectChildren
  <DD>親機が接続済みの複数の子機をまとめて切断します。<BR>
  <DT>WM_GetMPSendBufferSize
  <DD>MP通信において必要な送信バッファのサイズを計算します。<BR>
  <DT>WM_GetMPReceiveBufferSize
  <DD>MP通信において必要な受信バッファのサイズを計算します。<BR>
  <DT>WM_GetAllowedChannel
  <DD>通信時に使用を許可されたチャンネルを取得します。<BR>
  <DT>WM_SetEntry
  <DD>親機が子機の接続を受け付けるか拒否するかを切り替えます。<BR>
  <DT>WM_GetLinkLevel
  <DD>通信相手とのリンク強度を取得します。<BR>
  <DT>WM_ConvGgid*
  <DD>ゲームグループIDを変換します。<BR>
</DL>
</BLOCKQUOTE>
<H4>6) サンプルデモの修正</H4>
<P>　WMライブラリの仕様変更に伴い、それぞれのサンプルデモに修正が行われました。SDK-PR4では動作を保証していませんでしたサンプル&quot;ball&quot;についても正常に動作するよう修正されました。</P>
<H4>7) WM_Disconnect関数の不具合の修正</H4>
<P>　WM_Disconnect関数に子機から呼び出した場合に正しく親機から切断できないという不具合がありました。</P>
<P>　この不具合は修正されました。</P>
<HR>
<H3><A name="note14-02" id="note14-02">Note 14-02: (MI) [重要] 自動起動するDMAに関するハードウェア制限への対処
</A></H3>
<P>　DMA のうち、自動起動する DMA (即時処理するDMA以外で、Vブランク起動 DMA、Hブランク起動
DMA、表示同期 DMA、ワーク RAM 表示 DMA、メモリカードデータ DMA、カートリッジ
DMA、ジオメトリコマンド FIFO DMA があります) に関するハードウェアの制限に対処または警告するための処理を追加しました。</P>
<P>　上記の自動起動 DMA は同時に複数のものを起動することを出来ませんので起動時にチェックして、複数起動しようとすると
OS_Panic() で停止します。ただし、H ブランク起動 DMA と V ブランク起動 DMA
の併用は許可されています。</P>
<P>　また、ジオメトリコマンドFIFO DMA については以下の修正を行っています。</P>
<OL>
  <LI>同期版である MI_SendGXCommand() は ITCMに移されました。
  <LI>非同期版 MI_SendGXCommandAsync() を他の自動起動 DMA と併用可能にするために、ジオメトリコマンドの自動起動
  DMA を使用しないように修正しました。即時 DMA を割り込みによりソフトウェアで制御することで非同期転送を実現しています。
  <LI>自動起動 DMA を使用する SDK2.0PR4 以前の非同期版 MI_SendGXCommandAsync()
  は MI_SendGXCommandAsyncFast() と名称変更し収録されています。
</OL>
<HR>
<H3><A name="note14-03" id="note14-03">Note 14-03: (DevEnv) [重要] ハードウェアのバージョンに対応したコンポーネント・ライブラリの収録
</A></H3>
<P>　TS ハードウェアの各バージョンに対応した mongoose コンポーネントおよび
libspi.a ライブラリを収録しました。SDK の make システムにおいて、これらのコンポーネント・ライブラリを切り替えるためには
環境変数 NITRO_TS_VERSION に <A href="#note13-05">TS ボードのバージョン番号</A>を設定します。NITRO_TS_VERSION が設定されていない場合は NITRO_TS_VERSION=100(IS-NITRO-EMULATOR
ハードウェア Ver.D) が選択されます。</P>
<P>　IS-NITRO-EMULATOR ハードウェアの Ver.E に対応するアプリケーションを作成する場合には
NITRO_TS_VERSION=200 と設定する必要があります。</P>
<P>　対応するコンポネントおよびライブラリは以下にあります。</P>
<CENTER>
<TABLE border="1">
  <TBODY>
    <TR>
      <TH align="center">TS のバージョン番号</TH>
      <TH>対応する mongoose/libspi.a のファイル名 (ARM, Release 版の例)</TH>
    </TR>
    <TR>
      <TD align="center">0</TD>
      <TD>$NitroSDK/component/mongoose/ARM7-TS/Release/mongoose_sub_TS0.*<BR>
      $NitroSDK/lib/ARM9-TS/Release/libspi_TS0.a</TD>
    </TR>
    <TR>
      <TD align="center">100</TD>
      <TD>$NitroSDK/component/mongoose/ARM7-TS/Release/mongoose_sub_TS100.*<BR>
      $NitroSDK/lib/ARM9-TS/Release/libspi_TS100.a</TD>
    </TR>

    <TR>
      <TD align="center">200</TD>
      <TD>$NitroSDK/component/mongoose/ARM7-TS/Release/mongoose_sub_TS200.*<BR>
      $NitroSDK/lib/ARM9-TS/Release/libspi_TS200.a</TD>
    </TR>
  </TBODY>
</TABLE>
</CENTER>
<HR>
<H3><A name="note14-04" id="note14-04">Note 14-04: (DevEnv) mongoose の TEG 環境でのサポート停止 </A></H3>
<P>　コードサイズの増加により、無線機能対応コンポーネント mongoose の TEG
環境対応版の作成が困難になりつつあるため、このサポートを停止いたします。</P>
<HR>
<H3><A name="note14-05" id="note14-05">Note 14-05: (DevEnv) makerom の Reject 指定の初期値に <CODE>&quot;.&quot;</CODE>(ドット) で始まるファイルを追加 </A></H3>
<P>　makerom を修正し、<CODE>&quot;.&quot;</CODE>(ドット)で開始するファイル名およびディレクトリ名 (ワイルドカード表現で
<CODE>&quot;.?*&quot;</CODE>) を Reject の初期設定値に追加しました。これによりバージョン管理システム
Subversion の制御ディレクトリである <CODE>&quot;.svn&quot;</CODE> ディレクトリ内のファイルが ROM ファイルに含まれることが抑止されます。</P>
<P>　以前の makerom のように <CODE>&quot;.&quot;</CODE> で開始するファイルを ROM ファイルシステム内に追加したい場合は、以下のように
rsf ファイルの RomSpec セクションの先頭で Reject を再設定する必要があります。</P>
<BLOCKQUOTE><CODE>Reject CVS vssver.scc</CODE></BLOCKQUOTE>
<P>　既に <CODE>&quot;.&quot;</CODE> で開始するファイル名などを使用されている方は特にご注意ください。</P>
<HR>
<H3><A name="note14-06" id="note14-06">Note 14-06: (DevEnv) SDK をビルドする CodeWarrior のバージョンを 0.6.1
に変更 </A></H3>
<P>　本パッケージ内に収録されている SDK バイナリをビルドする CodeWarrior のバージョンを
0.6.1 に変更しました。</P>
<HR>
<H3><A name="note14-07" id="note14-07">Note 14-07: (DevEnv) .itcm/.dtcm セクションのコードが ITCM/DTCM へ配置されない問題の修正
</A></H3>
<P>　ARM9-TS.lcf.template ファイルにおける .itcm/.dtcm セクションの配置方法が
makelcf における想定外のものだったため .itcm/.dtcm セクションに定義されているコードが
ITCM/DTCM の autoload セクション内に配置されない場合がありました。</P>
<P>　makelcf を修正し、セクションを限定していない Object/Library 記述があったときに、その記述によって配置されるセクションをコンパイラが利用する基本セクション(.text,.rodata,.data,.sdata,...等)
に限定するように修正し、.itcm/.dtcm などの NITRO-SDK で新たに定義したセクションを含めないようにしました。</P>
<HR>
<H3><A name="note14-08" id="note14-08">Note 14-08: (GX) モザイクサイズ設定での不具合の修正 </A></H3>
<P>　モザイクサイズを設定する際に、G2*_SetBGMosaicSize()でOBJのモザイクをクリア、G2*_SetOBJMosaicSize()でBGのモザイクをクリアしてしまう不具合がありました。</P>
<P>　この不具合は修正されました。</P>
<HR>
<H3><A name="note14-09" id="note14-09">Note 14-09: (GX) gx.h の GX_InitEx() などの定義における不具合の修正 </A></H3>
<P>　$NitroSDK/include/nitro/gx.h 内で GX_InitEx(), GX_GetDefaultDMA() が
inline 宣言されていない不具合がありました。</P>
<P>　この不具合は修正されました。</P>
<HR>
<H3><A name="note14-10" id="note14-10">Note 14-10: (CARD) FLASH デバイスのサポート </A></H3>
<P>　CARDモジュールが、EEPROM デバイスに加えて FLASH デバイスへも対応しました。サブ基板とフラッシュカードにより、実機上およびデバッガ上で使用可能です。</P>
<HR>
<H3><A name="note14-11" id="note14-11">Note 14-11: (CARD) 割り込み禁止状態での CARD_Init() 呼び出し時の問題の修正
</A></H3>
<P>　割り込みが禁止されている状態でCARD_Init()を呼び出した場合に 関数から制御が戻らないという不具合がありました。</P>
<P>　この不具合は修正されました。</P>
<HR>
<H3><A name="note14-12" id="note14-12">Note 14-12: (CARD) CARD_IdentifyBackup() 呼び出し時の問題の修正 </A></H3>
<P>　CARD_IdentifyBackup()を呼び出してその処理が完了した時に、最後に実行したCARD非同期関数で指定されたコールバック関数が再度呼び出されてしまうという不具合がありました。</P>
<P>　この不具合は修正されました。</P>
<HR>
<H3><A name="note14-13" id="note14-13">Note 14-13: (MI) メインメモリ表示起動 DMA などにおけるメインメモリへのアクセス優先権
</A></H3>
<P>　メインメモリ表示起動 DMA および H ブランク DMA モードにおいて DMA 転送を行なう場合、メインメモリへのアクセス権を「ARM9
優先」にする必要があります。これは、ARM7 側からのメインメモリへのアクセスにより
DMA の自動起動タイミングの遅延が発生し、画面が崩れる可能性があるためです。アクセス権の優先の指定は
MI_SetMainMemoryPriority で行ないます。</P>
<P>　これらの DMA を使用している gx/UnitTours/2D_BmpBg_MainRam および gx/UnitTours/Window_HDMA
でアクセス権の切り替え処理を行なうように修正しました。また関連リファレンスマニュアルに上記情報を追記しました。</P>
<HR>
<H3><A name="note14-14" id="note14-14">Note 14-14: (OS) Tick 値取得関数の修正 </A></H3>
<P>　コンパイルの最適化レベルが一定以上の際にTick値を取得しようとすると Tick
値で使用しているタイマ割り込みがあるタイミングで掛かった場合に正確な値が取得出来ませんでした。</P>
<P>　この不具合は修正されました。</P>
<HR>
<H3><A name="note14-15" id="note14-15">Note 14-15: (OS) VBlank 割り込み時における割り込みチェックフラグの自動設定処理を停止
</A></H3>
<P>　NITRO-SDK 2.0PR4 において VBlank 割り込み時に割り込みチェックフラグ (IrqCheckFlag)
を自動的に ON にするように修正した部分を ARM9 側ライブラリでは取りやめ、従来どおりに戻しました。</P>
<P>　OS 内部で IrqCheckFlag をオンにするという操作について、IrqCheckFlag は複数回オンにしても問題ないため、アプリケーション側の
VBlank コールバック毎に IrqCheckFlag のオン処理を行なっておられる場合には問題はありません。しかし、秒間
30 フレームのタイミングで状態の更新を行なうために VBlank 処理内で 2 フレームに一度だけ
IrqCheckFlag をオンにするという操作を行なうアプリケーションにおいて誤動作の原因となっていました。</P>
<P>　この修正は 2.0PR4 の IrqCheckFlag パッチと同等のものです。</P>
<HR>
<H3><A name="note14-16" id="note14-16">Note 14-16: (OS) TS 環境における DTCM の位置変更 </A></H3>
<P>　Note:10-02 で変更アナウンスがあった通り、DTCMのアドレスが変更になっていますが一部変更していない個所がありました。</P>
<P>　それを修正しました。今回の変更で DTCMはどのような環境であってもデフォルトで
0x27c0000 からとなります。</P>
<HR>
<H3><A name="note14-17" id="note14-17">Note 14-17: (OS) OS_Init() 内部からの PM_Init() の呼び出し </A></H3>
<P>　ARM9側の OS_Init() 内で PM_Init() を呼ぶようにしました。</P>
<HR>
<H3><A name="note14-18" id="note14-18">Note 14-18: (OS) OS_GetConsoleType() による正確な動作環境判定 </A></H3>
<P>　IS-NITRO-DEBUGGER を使用している際に、カートリッジスロットの電源をオンにしていると
OS_GetConsoleType() で得られる動作環境として、IS-NITRO-EMULATOR である、と誤った結果を返していました。</P>
<P>　正確に IS-NITRO-DEBUGGERであることを判定できるように修正しました。</P>
<HR>
<H3><A name="note14-19" id="note14-19">Note 14-19: (TP) タッチパネル接触判定時の誤認識 </A></H3>
<P>　タッチパネルの接触判定において、接触状態から離した状態になる際に離れかけた中途半端な状態で測定した座標値が正常な計測値となる場合があるというハードウェアの問題が発見されました。</P>
<P>　この問題に対して座標値計測後一定時間待ってから再度接触判定を行うというソフト対策を施しました。</P>
<HR>
<H3><A name="note14-20" id="note14-20">Note 14-20: (PM) スリープからの復帰要因に RTC アラームをサポート </A></H3>
<P>　スリープ状態からの復帰要因に RTC アラームが使えるようになりました。</P>
<HR>
<H3><A name="note14-21" id="note14-21">Note 14-21: (RTC) RTC の 24 時制固定による運用 </A></H3>
<P>　これまで時間表記フォーマットは 12/24 時制を選択できる機能を提供していましたが、ブートメニューにおいて
24 時制を採用していることによるトラブルを避けるために 24 時制に固定する仕様へと変更されました。</P>
<P>　時間表記を選択するAPIは使用できなくなり、午前・午後を示す情報はAPIから削除され、仕様変更にともないサンプルデモ
rtc-1 も24時制表記固定の形へ変更されました。</P>
<HR>
<H3><A name="note14-22" id="note14-22">Note 14-22: (DEMO) アプリケーション起動時に A ボタンが押されている場合の対処
</A></H3>
<P>　NITRO のブートメニューにおける操作の都合上、ゲームアプリケーション起動時に
A ボタンが押されたままになっている可能性が高くなっています。A ボタンを押すことで何らかのアクションが起こるアプリケーションではこの点に注意する必要があります。</P>
<P>　いくつかのデモのボタントリガ (そのフレームにおいて新たに押下されたボタン)
の判定においてボタン状態の初期値に 0 (=何も押されていない) を使用していたのを修正し、初期値を現在の押下状態から設定するようにしました。</P>
<HR>
<H3><A name="note14-23" id="note14-23">Note 14-23: (Doc) ntrcomp などの補助ツールのリファレンスマニュアルの追加
</A></H3>
<P>　ntrcomp ツールおよび ppmconv* ツール群(ppmconv/ppmconv8/ppmconvbg) のリファレンスマニュアルを追加しました。</P>
<HR>
<H3><A name="KnownIssues_2_00_pr5" id="KnownIssues_2_00_pr5">SDK 2.0 PR5 での既知の問題点</A></H3>
<P>　以下のサンプルが正常に動作しないことが確認されています。</P>
<UL>
  <LI>characterRecognition-1
  <LI>multiboot(Debug版のみ)
</UL>
<HR>
<H2 style="line-height: 0"><A name="sdk_2_00_pr4" id="sdk_2_00_pr4">■ NITRO-SDK Version 2.0 PR4</A></H2>
<DIV style="text-align: right">
<P style="line-height: 0">(2004/08/11)</P>
</DIV>
<HR>
<H3><A name="note13-01" id="note13-01">Note 13-01: (WM) 無線コントロールライブラリの修正、機能追加</A></H3>
<P>1) ポート制御機能が追加されました。この機能により、MPプロトコル上で複数の上位プロトコルのデータ通信を
並列に行うことが可能となります。</P>
<P>2) データシェアリング機能が追加されました。複数の NITRO の間でデータシェアリングを行うサンプルを以下に用意しました。</P>
<BLOCKQUOTE><CODE>$NitroSDK/build/demos/wm/dataShare-1</CODE></BLOCKQUOTE>
<P>　また、キーシェアリング機能は、このデータシェアリング機能を内部的に利用することで実現するように実装方式が変更されました。<FONT color="#ff0000">これまでデモとして提供していました &quot;ball&quot; サンプルの動作は未検証であり、正常に動作しない可能性があります。</FONT></P>
<P>3) 内部制御用構造体の構造が大きく更新されました。これに伴い、WM ライブラリが必要とするバッファのサイズが拡張されました。</P>
<P>4) マルチポール通信中はMPパケットの転送完了のつどコールバックが発生するように変更されました。</P>
<P>5) 以下の単機能APIが追加されました。</P>
<BLOCKQUOTE><CODE>WM_SetLifeTime()</CODE><BR>
<CODE>WM_MeasureChannel()</CODE><BR>
<CODE>WM_InitWirelessCounter()</CODE><BR>
<CODE>WM_GetWirelessCounter()</CODE></BLOCKQUOTE>
<P>なお、プロック転送機能や、より機能拡張した上位レベルライブラリについては現在作成中です。</P>
<HR>
<H3><A name="note13-02" id="note13-02">Note 13-02: (MB) マルチブートライブラリの追加</A></H3>
<P>　NITRO-SDK にマルチブートライブラリ(MB ライブラリ)が追加されました。これはカードの挿入されていない
NITRO へゲームプログラムを送信するいわゆるマルチブート機能を提供するAPIです。このライブラリは内部でワイヤレスマネージャライブラリ(WM
ライブラリ)を使用します。</P>
<P>　マルチブートを実行するためのプログラム mb_child.srl (2.0PR5 において
mb_child.bin より改称) を下記のディレクトリに収録しました。これはカードの挿入されていない製品版の子機と同じ動作をするプログラムです。IPL
でマルチブート機能がサポートされるまでは、これを使って動作テストをしてください。</P>
<BLOCKQUOTE><CODE>$NitroSDK/bin/ARM9-TS/Release/mb_child.srl</CODE></BLOCKQUOTE>
<P>　同時に追加されたマルチブート機能のデモサンプルは、下記のディレクトリに収録されています。</P>
<BLOCKQUOTE><CODE>$NitroSDK/build/demos/mb/multiboot</CODE></BLOCKQUOTE>

<HR>
<H3><A name="note13-03" id="note13-03">Note 13-03: (PM) PMライブラリの追加</A></H3>
<P>　NITRO-SDK に PM ライブラリが追加されました。</P>
<P>　これはパワー制御 IC をコントロールするための API で、このライブラリを利用することで
LCD や バックライト電源を制御したり、バッテリー残量を調べたりすることなどが出来るようになります。</P>
<HR>
<H3><A name="note13-04" id="note13-04">Note 13-04: (MIC/TP) マイクのサンプリングとタッチパネルとの並行動作</A></H3>
<P>　マイクの自動サンプリング時に、タッチパネルの単発サンプリングを受け付けられるように修正しました。マイクの自動サンプリング時にタッチパネルのリクエストを受けると、次のマイクのサンプリングが終わるタイミングでタッチパネルのデータ読み取り処理が行なわれます。</P>
<P>　もし次のマイクのサンプリング時刻までにタッチパネルのサンプリングが終了していなかった場合は、マイクのデータ落ちが発生したとみなして、直前のマイクのサンプリング値と同じ値でデータ落ち部分を補間します。</P>
<P>　この機能に関するデモを下記のディレクトリに収録しました。</P>
<BLOCKQUOTE><CODE>$NitroSDK/build/demos/spi/spiMonkey2</CODE></BLOCKQUOTE>
<HR>
<H3><A name="note13-05" id="note13-05">Note 13-05: (MIC) IS-NITRO-DEBUGGER でのマイクサポートおよび前処理の追加</A></H3>
<P>　量産品の電源制御関連IC(PMIC) が実装されたハードウェアにおいて、マイクの出力値を正しく取得する為に
PMIC 内のアンプを動作させるための前準備が必要となりました。このためにPMIC
のアンプのゲイン値などのパラメータを操作する処理を mic-1, mic-2, spiMonkey
デモに追加しました。</P>
<P>　またこの前準備において PMIC のバージョンの違いを吸収するためにマクロ値
SDK_TS_VERSION を導入しました。またこの値を動的に切り替えるための環境変数
NITRO_TS_VERSION を用意しました。ビルド時に定義された NITRO_TS_VERSION
の値が SDK_TS_VERSION に渡されます。</P>
<P>　SDK_TS_VERSION および NITRO_TS_VERSION は以下のような値をとります。</P>
<CENTER>
<TABLE border="1">
  <TBODY>
    <TR>
      <TH>SDK_TS_VERSION</TH>
      <TH>機器の説明</TH>
    </TR>
    <TR>
      <TD align="center">0</TD>
      <TD>TS ブレッドボードから IS-NITRO-EMULATORハードウェア Ver.C</TD>
    </TR>
    <TR>
      <TD align="center">100</TD>
      <TD>IS-NITRO-EMULATORハードウェア Ver.D (PR4 でのデフォルト)</TD>
    </TR>
    <TR>
      <TD align="center">200</TD>
      <TD>次のバージョンの PMIC が搭載された機器</TD>
    </TR>
  </TBODY>
</TABLE>
</CENTER>
<P>　IS-NITRO-EMULATORハードウェア Ver.D の PMIC では、LCD のバックライトが点灯しているとマイクデバイスに大きなノイズが載ってしまいます。このハードウェアの問題は修正される予定ですが、それまでは
mic-1 デモマイクを使用するときは LCD を OFF にしてご利用ください。</P>
<HR>
<H3><A name="note13-06" id="note13-06">Note 13-06: (MIC) mic2wav ツールの修正</A></H3>
<P>　mic2wav が出力ファイルをテキストファイルとしてオープンしておりデータを正しく変換できていませんでした。これを修正しました。</P>
<HR>
<H3><A name="note13-07" id="note13-07">Note 13-07: (GX) LCDパワー制御関数の変更</A></H3>
<P>　LCDのパワー制御用関数が PM_SetLCDPower へ変更されました。これに伴い、以下の関数・列挙型の定義を削除しました。</P>
<DL>
  <DT>- 関数
  <DD>GX_PowerLCD(), GX_PowerLCDTop(), GX_PowerLCDBot()
  <DT>- 列挙型 GXPower の定義値
  <DD>GX_POWER_LCD, GX_POWER_LCDTOP, GX_POWER_LCDBOT
</DL>
<HR>
<H3><A name="note13-08" id="note13-08">Note 13-08: (GX) G3*_MultTransMtx33の追加</A></H3>
<P>　ジオメトリエンジンの実行時間短縮のため、G3*_MultMtx33 と G3*_Translate
を一つの行列にパックして乗算する関数 G3*_MultTransMtx33 を追加しました。</P>
<HR>
<H3><A name="note13-09" id="note13-09">Note 13-09: (GX) GXの使用するDMA番号を設定する関数の追加</A></H3>
<P>　GXが使用するDMA番号を設定・取得するための関数として、GX_InitEx(), GX_SetDefaultDMA(),
GX_GetDefaultDMA()を追加しました。DMA番号にGX_DMA_NOT_USEを指定することで、DMAを使用しないように設定することもできます。</P>
<HR>
<H3><A name="note13-10" id="note13-10">Note 13-10: (GX) GX_PowerGeometry()／GX_Power3D()の不具合修正</A></H3>
<P>　GX_PowerGeometry(), GX_Power3D()において、ジオメトリエンジンの電源がOFFにならない不具合がありました。この不具合は修正されました。</P>
<HR>
<H3><A name="note13-11" id="note13-11">Note 13-11: (GX) GX_SetGraphicsMode() のレジスタへの書き込み制限変更</A></H3>
<P>　表示モードに限らず常にBGモード、BG0 2D/3D選択フラグをレジスタへ反映するように変更しました。この値はグラフィックス表示モード以外の場合にも、表示キャプチャを使用する際に参照されます。</P>
<HR>
<H3><A name="note13-12" id="note13-12">Note 13-12: (CARD) NITRO-CARDアクセスAPIの正式公開</A></H3>
<P>　NITRO-CARD上のデバイスにアクセスするための関数群を公開しました。サブ基板とフラッシュカードにより、実機上で使用可能です。</P>
<HR>
<H3><A name="note13-13" id="note13-13">Note 13-13: (FS) FS_ReadDir関数で得られるファイルIDがずれる不具合の修正</A></H3>
<P>　FS_ReadDir関数でディレクトリエントリを列挙する際に、ファイルエントリ同士の間にディレクトリエントリが存在すると得られるファイルIDが実際のものとずれるという不具合がありました。この不具合を修正しました。</P>
<HR>
<H3><A name="note13-14" id="note13-14">Note 13-14: (DevEnv) makelcf/makerom の変数展開時における不具合と変数定義ファイルサポート</A></H3>
<P>　makelcf/makerom において、-D オプションで指定できる変数に1000文字を超えるような長い文字列を設定し、テンプレートファイル内でこれを展開すると、エラーを出力して停止する場合がありました。これを修正しました。</P>
<P>　またコマンドラインを使った変数の受け渡し処理は、各コマンドライン処理系で設定されたコマンドラインの最大長の制限を受けることになります。これを防ぐために変数定義を外部ファイル経由で指定できるようにしました。これにより
[変数名=値] の記述からなるファイルを -M オプションにより makelcf/makerom
に与えることで コマンドラインのコマンド長の制限を気にせずに変数の定義を行なうことが出来ます。</P>
<HR>
<H3><A name="note13-15" id="note13-15">Note 13-15: (DevEnv) autoload モジュールの情報をオーバーレイネームファイルへ出力</A></H3>
<P>　autoload されたコードをデバッガで追跡するための追加情報をオーバーレイネームファイルに出力するように修正しました。具体的には
$NitroSDK/include/nitro/specfiles 以下の *.lcf.template ファイルのオーバーレイネームファイルの定義部分に変更が加えられています。</P>
<P>　この追加情報を利用することで autoload モジュールのデバッグが可能となります。各デバッガシステムのこの機能の対応予定については各デバッガのリリースノートやサポートサイトなどでご確認ください。</P>
<HR>
<H3><A name="note13-16" id="note13-16">Note 13-16: (DevEnv) mingw 環境での C++ ライブラリのリネームに失敗していた点の修正</A></H3>
<P>　mingw 環境において C++ ライブラリを CXX にリネームする処理が失敗するという問題がありました。これを修正しました。</P>
<HR>
<H3><A name="note13-17" id="note13-17">Note 13-17: (OS) Vブランクカウンタの設置</A></H3>
<P>　V ブランクカウンタを設置し、値を取得する関数 OS_GetVBlankCount() を用意しました。</P>
<HR>
<H3><A name="note13-18" id="note13-18">Note 13-18: (PAD) PAD_SetIrq(), PAD_ClearIrq() の廃止</A></H3>
<P>　ハードウェアの制限によってキー割り込みが使用できなくなりましたので PAD_SetIrq()
と PAD_ClearIrq() を廃止しました。 ただしスリープモードからの復帰においてはキー割り込みを使用しても構いません。その場合は
PM_GoSleepMode() で条件を指定します。</P>
<HR>
<H3><A name="note13-19" id="note13-19">Note 13-19: (MI) 同期DMA後の DMAビジーウェイトの追加</A></H3>
<P>　同期DMAで、DMA の後に DMA ビジーの間待つという処理を入れました。</P>
<P>　TCM 上にこれらの同期 DMA API が置かれている場合、DMA を起動しても ARM9
はその終了を待たずに API から返っていました。これを修正し転送位置に関係なく同期DMAでは確実に終了を待つという仕様に修正しました。DMA
の明示的な終了待ち処理を行なう必要がない場合は、非同期 DMA API をお使いください。</P>
<P>　変更された命令は以下のものです。</P>
<UL>
  <LI>MI_DmaCopy16/32
  <LI>MI_DmaFill16/32
  <LI>MI_DmaSend16/32
  <LI>MI_DmaClear16/32
  <LI>MI_VBlankDmaCopy16/32
</UL>
<HR>
<H3><A name="note13-20" id="note13-20">Note 13-20: (SND) サウンドライブラリの更新</A></H3>
<P>　NITRO-SDK で配布するサウンドライブラリを 2004年8月10日版にしました。</P>
<HR>
<H3><A name="note13-21" id="note13-21">Note 13-21: (Demo) GX デモ 3D_BoxTest の修正</A></H3>
<P>　GXデモ3D_BoxTestで、PolygonAttrのFARクリップフラグ、及び1ドットポリゴン表示フラグに1をセットせずにBoxTestを実行していたため、ハードの仕様上、正常な結果が得られない場合がありました。BoxTestの直前にこれらのフラグをセットするように修正しました。</P>
<HR>
<H3><A name="note13-22" id="note13-22">Note 13-22: (Demo) GX デモ LinesOver の修正</A></H3>
<P>　デモ LinesOver で、ジオメトリエンジンがまだビジー中に G3X_GetPolygonListRamCount(),
G3X_GetVtxListRamCount() がコールされ、描画途中の値を取得していましたので直前にジオメトリエンジンの処理終了待ち処理を追加しました。</P>
<P>　また、レンダリングが終わる前に G3X_GetRenderedLineCount(), G3X_IsLineBufferOverflow()がコールされていましたので、VBlank
の後に移動しました。</P>
<HR>
<H3><A name="note13-23" id="note13-23">Note 13-23: (Demo) SPI デモ spiMonkey の出力画面の修正</A></H3>
<P>　SPI デモ spiMonkey の出力画面をタッチパネル側画面になるように修正しました。</P>
<HR>
<H3><A name="note13-24" id="note13-24">Note 13-24: (DevEnv) char 型の符号設定の変更</A></H3>
<P>　従来 NITROSDK_LANG の値で signed/unsigned を切り替えていた char 型ですが(jp
の時 unsigned)、これを signed に統一しました。この変更は NITRO-SDK 2.0PR1
から導入されています。</P>
<HR>
<H3><A name="KnownIssues_2_00_pr4" id="KnownIssues_2_00_pr4">SDK 2.0 PR4 での既知の問題点</A></H3>
<UL>
  <LI>PM_GoSleepMode() のスリープモードからの復帰要因として RTC アラーム、カートリッジ、カードの割り込みにはまだ対応していません。
  <LI>無線コントロールライブラリについては、より機能拡張した上位レベルライブラリを作成中です。
  <LI>マルチブート動作において複数のダウンロード対象がある場合の動作に不具合があります。これは現在調査中です。
  <LI>マイクのサンプリングと無線通信の同時使用については充分な検証が行なわれていません。
  <LI>IS-NITRO-DEBUGGER で「カートリッジスロットの電源を ON にする」を有効にすると
  OS_GetConsoleType() が誤まった結果(IS-CGB-EMULATOR)を返します。
</UL>
<HR>
<H2 style="line-height: 0"><A name="sdk_2_00_pr3_plus" id="sdk_2_00_pr3_plus">■ NITRO-SDK Version 2.0 PR3plus</A></H2>
<DIV style="text-align: right">
<P style="line-height: 0">(2004/07/29)</P>
</DIV>
<HR>
<H3><A name="note12-01" id="note12-01">Note 12-01: (DOC) WM ライブラリリファレンスマニュアルの加筆、修正</A></H3>
<P>　リファレンスマニュアルにおいて WM ライブラリに関する部分を加筆、修正しました。</P>
<HR>
<H3><A name="KnownIssues_2_00_pr3_plus" id="KnownIssues_2_00_pr3_plus">SDK 2.0 PR3plus での既知の問題点</A></H3>
SDK 2.0 PR3plus のライブラリ本体およびライブラリヘッダファイルは SDK 2.0
PR3 から変更ありません。
<UL>
  <LI>WM ライブラリの幾つかの変数型が SDK 標準の命名規則に則っていません。(例：WMindCallback)
  これは SDK 2.0 PR2 から継続している問題点で、将来、互換性を保ちながら修正される予定となっています。
  <LI>IS-NITRO-EMULATORハードウェア（Ver.D以降を含む）上ではマイクAPIが正常に動作しません。
  現在原因を調査中です。
</UL>
<HR>
<H2 style="line-height: 0"><A name="sdk_2_00_pr3" id="sdk_2_00_pr3">■ NITRO-SDK Version 2.0 PR3</A></H2>
<DIV style="text-align: right">
<P style="line-height: 0">(2004/07/27)</P>
</DIV>
<HR>
<H3><A name="note11-01" id="note11-01">Note 11-01: (OS) システム共有領域の定義ミスの修正</A></H3>
<P>メモリマップの定義において、システム共有領域の定義マクロとシステム領域構造体の定義が一致していませんでした。これは
NITRO-SDK 2.0PR2 における修正によって混入した不具合です。</P>
<P>この不具合を修正しました。</P>
<HR>
<H3><A name="note11-02" id="note11-02">Note 11-02: (DevEnv) 構造体のパディング警告設定の修正</A></H3>
<P>NITRO-SDK のライブラリヘッダファイル内で、構造体のパディング警告のスイッチを
OFF に切り替えた後、元に戻していませんでした。このため、これまではパディング警告スイッチが
OFF になったままになっていました。これは意図したものではありません。</P>
<P>これを修正しました。これによって NITRO-SDK を使用しておられる、プログラムのコンパイル時に今まで発生していなかったパディング警告が出現する可能性があります。これを抑制するためには、以下のような方法があります。</P>
<H4>(1) コンパイルオプションによる抑制</H4>
<P>コンパイル時にパディング警告の抑制に関するコンパイラオプションを追加するという方法です。</P>
<P>IDE をお使いの方はパネルから設定できます。make システムをお使いの方は以下の
make 変数 CCFLAGS_WARNING に警告関連オプションを設定してください。以下はパディング警告を抑制し、その他の警告を表示するための指定をコマンドラインから与える場合の例です。無論
CCFLAGS_WARNING の設定を Makefile 内に記述することでも同様の効果があります。</P>
<BLOCKQUOTE>make CCFLAGS_WARNING='-w all,nopadding'</BLOCKQUOTE>
<H4>(2) pragma によるソース内での指定</H4>
<P>警告箇所の前後に pragma 指定を行なうことでパディング警告を抑制するという方法です。具体的には以下のようになります。</P>
<BLOCKQUOTE>
<PRE>// パディング警告の抑制
#pragma  warn_padding off
struct padded
{
    u16     leng;
    // ここに 2 bytes のパディングが挿入される 
    s32     data[4];
};
// パディング警告状態の復帰
#pragma  warn_padding reset</PRE>
</BLOCKQUOTE>
<P>ソースファイル全域に対して、パディングの警告を抑制したい場合は、#pragma
warn_padding off をソースの先頭に記述することになります。</P>
<HR>
<H3><A name="KnownIssues_2_00_pr3" id="KnownIssues_2_00_pr3">SDK 2.0 PR3 での既知の問題点</A></H3>
今回のリリースは緊急リリースのため、<A href="#KnownIssues_2_00_pr2">SDK 2.0 PR2 と同様の問題</A>が残っています。
<P><BR>
</P>
<HR>
<H2 style="line-height: 0"><A name="sdk_2_00_pr2" id="sdk_2_00_pr2">■ NITRO-SDK Version 2.0 PR2</A></H2>
<DIV style="text-align: right">
<P style="line-height: 0">(2004/07/26)</P>
</DIV>
<HR>
<H3><A name="note10-01" id="note10-01">Note 10-01: (WM)無線コントロールライブラリの追加</A></H3>
<P>無線デバイスをドライブするための下位レベルライブラリとして、WM (Wireless
Manager)を公開しました。</P>
<BLOCKQUOTE>$NitroSDK/build/demos/wm</BLOCKQUOTE>
<P>以下に単機能サンプルを用意しました。 現状ではターゲットがTSの場合のみ動作します。
ターゲットがTEGの場合、及びensataでの動作は保証しません。</P>
<P><FONT color="#ff3300">なお、ワイヤレスマルチブートやブロック転送等、今回未サポートの通信機能や、</FONT>より機能拡張した上位レベルライブラリについては現在作成中です。</P>
<HR>
<H3><A name="note10-02" id="note10-02">Note 10-02: (DevEnv) メモリマップの変更(DTCMのアドレス変更) (TSのみ)</A></H3>
<P><FONT color="#ff3300">(この項はTS環境にのみ該当します。TEG環境の場合はメモリマップの変更はありません。)</FONT><BR>
<BR>
メモリマップの見直しを行い、デフォルトでARM9に割り当てるMainRAM領域の大きさを増やしました。</P>
<P>具体的には、これまで0x2380000からの領域に配置していたDTCMを、0x27C0000
からとしました。あわせて、ARM9に割り当てられる MainRAM領域は 0x2000000〜0x237FFFF
から 0x2000000〜0x23BFFFF となります。(256KByte 増加したことになります。)
また、ARM7に割り当てられるMainRAM 領域は 0x37C0000〜0x37FEFFF となります。</P>
<HR>
<H3><A name="note10-03" id="note10-03">Note 10-03: (DevEnv) DTCMの違いを吸収するパラメータの追加</A></H3>
<P>No. 10-02 で TS 環境のみ、DTCMの配置アドレスが変更になっていることが書かれていますが、TEG
と TS における DTCM の配置アドレスの違いを lsf ファイルに通知するために、makelcf
の起動時パラメータ ADDRESS_DTCM を追加しました。これは、NITRO_PLATFORM
が TEG である場合には 0x02380000 が、TS である場合には 0x027c0000 (8MB
メインメモリ対応のため +0x400000 されています) が設定されます。TEG と TS
で lsf ファイルを共用したい場合にはこの変数を利用してください。</P>
<P>(例)</P>
<BLOCKQUOTE>Autoload DTCM<BR>
{<BR>
　　Address $(ADDRESS_DTCM)<BR>
　　Object * (.dtcm)<BR>
}</BLOCKQUOTE>
<HR>
<H3><A name="note10-04" id="note10-04">Note 10-04: (DevEnv) C++ 例外テーブルのリンクでエラー発生していたことの対処</A></H3>
<P>C++ の例外を使用したコードを作成したときに例外テーブルのラベルが定義されていなかったことによるリンクエラーが発生していました。これを修正しました。</P>
<HR>
<H3><A name="note10-05" id="note10-05">Note 10-05: (SVC) SVCライブラリ更新とリファレンスの追加</A></H3>
<P>システムコール SVCライブラリが更新され、以下の関数が追加されました。また、追加されたものについてリファレンスマニュアルを更新しました。<BR>
<BR>
今回追加された関数<BR>
<CODE>　SVC_Div()<BR>
　SVC_DivRem()<BR>
　SVC_GetCrc16()<BR>
　SVC_Halt()<BR>
　SVC_IsMmemExpanded()<BR>
　SVC_Sleep()<BR>
　SVC_Sqrt()<BR>
　SVC_UncompressHuffman.html()<BR>
　SVC_UncompressLZ.html()<BR>
　SVC_UncompressRL.html()<BR>
　SVC_UnpackBits.html()</CODE></P>
<HR>
<H3><A name="note10-06" id="note10-06">Note 10-06: (OS) ロック関数の整備(1) ロックIDの型統一</A></H3>
<P>OSのロック関連の関数で用いるロックID(u16)が、関数の引数でu16 としてだけでなく、u32として宣言されている個所があったのでu16に統一しました。但しロックIDまたはエラーを返すという関数の返り値がs32であるのはこれまでの通りです。<BR>
<BR>
引数のlockID の型がu32 から u16 に変わったもの<BR>
<CODE>　OS_LockByWord(), OS_LockCartridge(), OS_LockCard()<BR>
　OS_UnlockByWord(), OS_UnlockCartridge(), OS_UnlockCard()<BR>
　OS_TryLockByWord(), OS_TryLockCartridge(), OS_TryeUnLockCard()</CODE><BR>
<BR>
返り値が s32 から u16 に変わったもの<BR>
<CODE>　OS_ReadOwnerOfLockWord()</CODE><BR>
<BR>
返り値が s32 であることの注意をマニュアルに入れたもの<BR>
<CODE>　OS_GetLockID()</CODE></P>
<HR>
<H3><A name="note10-07" id="note10-07">Note 10-07: (OS) ロック関数の整備(2) アンロック関数の名称変更</A></H3>
<P>OS のロック関連の関数のうち、以下のアンロック関数について、関数名の 'UnLock'
部分を 'Unlock' と変更しました。<BR>
<BR>
<CODE>OS_UnLockByWord(), OS_UnLockCartridge(), OS_UnLockCard() </CODE></P>
<HR>
<H3><A name="note10-08" id="note108-xx">Note 10-08: (MI) MI_GetCartridgeRomCycle* 関数の名称の変更 (再掲)</A></H3>
<P>(この変更は Note 9-23 にある通り、2.0PR1に入る予定でしたが、手違いにより今回の変更となりました)<BR>
<BR>
MI_GetCartridgeRomCycle* 関数の名称を整理して1stと2ndで統一しました。あわせて、列挙型名
MICartridgeRomCycle1, MICartridgeRomCycle2 を MICartridgeRomCycle1st,MICartridgeRomCycle2nd
に変更しました。</P>
<HR>
<H3><A name="KnownIssues_2_00_pr2" id="KnownIssues_2_00_pr2">SDK 2.0 PR2 での既知の問題点</A></H3>
(次回以降のリリースで修正される予定です)
<UL>
  <LI>CARDライブラリについては、TS環境のみ使用可能です。現バージョンではTEG、ensata、実機での動作は保証されません。
  <LI>無線コントロールライブラリについては、より機能拡張した上位レベルライブラリを作成中です。
</UL>
<HR>
<H2 style="line-height: 0"><A name="sdk_2_00_pr1" id="sdk_2_00_pr1">■ NITRO-SDK Version 2.0 PR1</A></H2>
<DIV style="text-align: right">
<P style="line-height: 0">(2004/07/20)</P>
</DIV>
<HR>
<H3><A name="note9-01" id="note9-01">Note 9-01: (DevEnv) TS 版のライブラリサポートとデフォルトターゲット変更</A></H3>
<P><FONT color="#ff3300">(注意：このNote Note. 9-01 内の赤字部分については 2004/07/26 に追記されたものです。)</FONT></P>
<P><FONT color="#ff3300">IS-NITRO-DEBUGGER 及び </FONT>NintendoDS ソフトウェア開発用ボード NITRO-TS に対応し、デフォルトのターゲットを
TEG から TS へ変更しました。<FONT color="#ff3300">(以降、特に断りがない限り、IS-NITRO-DEBUGGER と NITRO-TS は同一の物を指します)</FONT></P>
<P>環境変数または <CODE>make</CODE> コマンドのマクロ変数の <CODE>NITRO_PLATFORM</CODE> を定義しない、あるいはこの変数に <CODE>&quot;TS&quot;</CODE> という値を設定することで、TS 用のモジュールを作成します。以下は一例です。</P>
<BLOCKQUOTE>　　% make NITRO_PLATFORM=TS</BLOCKQUOTE>
<P>通常、<CODE>make</CODE> を実行したディレクトリ下の <CODE>bin, lib, obj</CODE> サブディレクトリ以下に <CODE>ARM9-TS</CODE> または <CODE>ARM9-TS.thumb</CODE> というディレクトリを作成し、その内部に TS 用の各モジュールが生成されます。</P>
<P>また、従来の TEG ターゲット版のコンパイルを行うには</P>
<BLOCKQUOTE>　　% make NITRO_PLATFORM=TEG</BLOCKQUOTE>
<P>と明示的に指定する必要があります。<BR>
<FONT color="#ff3300">なお、TEGターゲットのサポートは今後も(少なくとも2004年中は)継続して行う予定です。</FONT></P>
<HR>
<H3><A name="note9-02" id="note9-02">Note 9-02: (DevEnv) ROM バイナリファイルの拡張子の変更</A></H3>
<P>ROM イメージの製造フォーマット仕様と一致するように makerom を修正しました。また製造検査工程との整合性を取る為
ROM バイナリファイルの拡張子を .bin から .srl と変更しました。</P>
<P>ただし <CODE>Makefile</CODE> の記述における ROM イメージのターゲット変数名は <CODE>TARGET_BIN</CODE> のままになっています。</P>
<HR>
<H3><A name="note9-03" id="note9-03">Note 9-03: (DevEnv) オーバーレイ手法の変更</A></H3>
<P>オーバーレイ関連のリンク手法が変更になりました。</P>
<UL>
  <LI>Link スペックファイル(LSF) の記述方法が変更されました。従来の LSF ファイルではそのまま使用できない場合が多いので<FONT color="#ff0000">独自の LSF ファイルを作成し使用されている方はそれらの修正が必要</FONT>です。(詳しくは makelcf のリファレンスをご覧ください。)
  <LI>リンカへオーバーレイグループ情報を渡すため、レスポンスファイルを makelcf
  で生成するようになりました。
</UL>
<HR>
<H3><A name="note9-04" id="note9-04">Note 9-04: (DevEnv) LCFファイル記述の変更</A></H3>
<P>LCFファイルでファイル指定に &quot;*&quot; を使用しないように変更しました。
<BR>
<BR>
LCFファイル中ではすべてのライブラリを列挙していますが、ライブラリ名に &quot;+&quot;
記号が使用できない制限のため、メトロワークス社のc++ランタイムライブラリを
MSL_C++_NITRO_Ai_LE_strb.a → MSL_CXX_NITRO_Ai_LE_strb.a と 名前を変更してコピーし、そちらを参照するようにしています。</P>
<HR>
<H3><A name="note9-05" id="note9-05">Note 9-05: (DevEnv) makeルールの変更</A></H3>
<P>複数のサブディレクトリでソースファイルをそれぞれコンパイルし、親ディレクトリで、それらをリンクするという処理のサンプルデモを次のディレクトリ以下に用意しました。</P>
<BLOCKQUOTE>$NitroSDK/build/demos/tips/MultiLink</BLOCKQUOTE>
<HR>
<H3><A name="note9-06" id="note9-06">Note 9-06: (DevEnv) nef,srl ファイルの生成規則の修正</A></H3>
<P><CODE>nef</CODE>, <CODE>bin</CODE> ファイルの依存ファイルを <CODE>LDEPENDS_NEF</CODE>, <CODE>LDEPENDS_BIN</CODE> への指定によって追加できるようになりました。</P>
<HR>
<H3><A name="note9-07" id="note9-07">Note 9-07: (DevEnv) コンパイルスイッチ NITRO_CODEGEN_ALL の追加</A></H3>
<P>コンパイルスイッチ NITRO_CODEGEN_ALL を追加しました。これは ARM/THUMB 版の両方のライブラリを生成するためのもので</P>
<BLOCKQUOTE>% make NITRO_CODEGEN=ARM<BR>
% make NITRO_CODEGEN=THUMB<BR>
</BLOCKQUOTE>
<P>という2回のコンパイルを行うことを意味します。(コンパイルは NITRO_CODEGEN
で指定された方から順に行ないます)</P>
<HR>
<H3><A name="note9-08" id="note9-08">Note 9-08: (SND) サウンドライブラリの更新</A></H3>
<P>NITRO-SDK で配布するサウンドラインブラリが2004年6月22日版となりました。</P>
<HR>
<H3><A name="note9-09" id="note9-09">Note 9-09: (FS) FS_RegisterArchiveName関数の不具合修正</A></H3>
<P>FS_RegisterArchiveName関数の内部処理の問題により登録したアーカイブを解放する際に状態不整合が起こるという不具合がありましたが、修正されました。</P>
<HR>
<H3><A name="note9-10" id="note9-10">Note 9-10: (FS) async デモのスレッド内デバッグ表示の不具合の修正</A></H3>
<P>async デモにおいて、スレッド内でデバッグ出力を行っている最中に割り込みが発生してスレッドが切り替わることにより誤った文字列が出力される場合がありました。この不具合を修正しました。</P>
<HR>
<H3><A name="note9-11" id="note9-11">Note 9-11: (FS) FS_WaitAsync 関数が未完了で制御を返す不具合の修正</A></H3>
<P>FS の非同期関数を FS_WaitAsync 関数で待機しているスレッドに対してOS_WakeupThreadDirect()
関数を呼び出した場合に、実際は処理が完了していないのに関数から戻ってくるという不具合がありましたが、修正されました。</P>
<HR>
<H3><A name="note9-12" id="note9-12">Note 9-12: (GX) GX_SetBankForTex(), GX_LoadTexEx(), GX_LoadTex() の修正</A></H3>
<P>非連続VRAMバンクを扱う関数でデータ転送に不具合があり、正確に転送できていませんでしたが、修正されました。</P>
<HR>
<H3><A name="note9-13" id="note9-13">Note 9-13: (GX) GXデモ中のクリアカラーα値のデフォルト変更</A></H3>
<P>GXデモのDEMOLib の中で、クリアカラーのα値のデフォルト値をこれまでの 0
から 31 に変更しました。</P>
<HR>
<H3><A name="note9-14" id="note9-14">Note 9-14: (FX) FX_AtanIdx(), FX_Atan2Idx() の追加</A></H3>
<P>u16 型の範囲で逆正接を返す関数 FX_AtanIdx(), FX_Atan2Idx() を追加しました。これまではラジアン単位で逆正接を返す
FX_Atan(), FX_Atan2() のみが存在していました。</P>
<HR>
<H3><A name="note9-15" id="note9-15">Note 9-15: (FX) ジオメトリエンジンへ値を送らない行列計算APIの追加</A></H3>
<P>データをジオメトリエンジンへ設定せず値の計算のみをするAPIとして以下の関数を追加しました。<BR>
<BR>
　　MTX_FrustumW(), MTX_PerspectiveW(), MTX_OrthoW(), MTX_LookAt() <BR>
<BR>
これらの関数からは、G3_FrustumW(), G3_PerspectiveW(), G3_OrthoW(), G3_LookAt()で設定されるものと同じ行列が得られます。</P>
<HR>
<H3><A name="note9-16" id="note9-16">Note 9-16: (OS) NITRO_MEMSIZE=8M 時のアリーナ設定</A>の修正</H3>
<P>make 時に NITRO_MEMSIZE=8M の指定をつけてコンパイルしたものをメインメモリ8MB搭載の開発機材で実行した場合に、拡張メインメモリアリーナをきちんと設定するようにしました。これまではプロテクションリージョンの設定が適切ではなくアプリケーション側で設定する必要がありました。</P>
<HR>
<H3><A name="note9-17" id="note9-17">Note 9-17: (OS) alloc, free などメモリ割り当て関連関数のスレッドセーフ化</A></H3>
<P>OS_Alloc*(), OS_Free*() 等のメモリ操作関数でクリティカルセクションを割り込み禁止とし、スレッドセーフにしました。</P>
<HR>
<H3><A name="note9-18" id="note9-18">Note 9-18: (OS) OS_JoinThread(), OS_IsThreadTerminated() の作成</A></H3>
<P>スレッドを結合し指定のスレッドの終了を待つ OS_JoinThread()、スレッドの終了を調べる
OS_IsThreadTerminated() を作成しました。</P>
<HR>
<H3><A name="note9-19" id="note9-19">Note 9-19: (OS) DMAのアドレスチェックASSERTの修正</A></H3>
<P>デバッグビルドでは DMA時に TCMアドレスに重なっているかどうかをASSERTでチェックしていますが、境界条件に誤りがありました。これを修正しました。</P>
<HR>
<H3><A name="note9-20" id="note9-20">Note 9-20: (OS) OS_SetProtectionRegion() の動作変更</A></H3>
<P>OS_SetProtectionRegion() で、プロテクションリージョンの設定を行うとともにリージョンの有効化を行うようにしました。これまでは有効化はしていませんでした。</P>
<HR>
<H3><A name="note9-21" id="note9-21">Note 9-21: (OS) 関数コスト計測プロファイラの変更</A></H3>
<P>プロファイラ内部で扱う時刻情報をu16からu32にしてより長い時間を要する関数の計測が可能になりました。また、集計の所要時間計算に誤りがありましたが修正されました。</P>
<HR>
<H3><A name="note9-22" id="note9-22">Note 9-22: (MI) 圧縮データの圧縮タイプ・展開後サイズ取得関数の追加</A></H3>
<P>メモリ上の圧縮データから、圧縮タイプと展開後のサイズを取得する関数を作成しました。圧縮タイプの取得はMI_GetCompressionType()
、展開後のサイズの取得は MI_GetUncompressedSize() となります。</P>
<HR>
<H3><A name="note9-23" id="note9-23">Note 9-23: (MI) MI_GetCartridgeRomCycle* 関数の名称の変更</A></H3>
<P>MI_GetCartridgeRomCycle* 関数の名称を整理して1stと2ndで統一しました。あわせて、列挙型名
MICartridgeRomCycle1, MICartridgeRomCycle2 を MICartridgeRomCycle1st,MICartridgeRomCycle2nd
に変更しました。</P>
<HR>
<H3><A name="note9-24" id="note9-24">Note 9-24: (MI) MI_CpuCopyFast() のASSERTの修正</A></H3>
<P>MI_CpuCopyFast() のデバッグビルド時のASSERTで転送サイズが32バイトの倍数であることが必要条件となっていました。これを4バイトの倍数に修正しました。</P>
<HR>
<H3><A name="note9-25" id="note9-25">Note 9-25: (MI) DMA パラメータ設定と停止処理の変更</A></H3>
<P>DMAのパラメータ設定処理 (内部関数 MIi_DmaParams*() )と停止処理 MI_StopDma()を割り込み禁止状態で行うようにしました。</P>
<HR>
<H3><A name="note9-26" id="note9-26">Note 9-26: (CP) 除算器の除数セット方法の変更</A></H3>
<P>除算器に 32bit の除数をセットする際、除算器の除数レジスタの上位 32bit に
0 を入れるようにしました。これは除数 32bit の除算モードであっても、除数レジスタ
64bit 全てが 0 のときのみコントロールレジスタの 0 割りエラーフラグが立つためです。</P>
<HR>
<H3><A name="note9-27" id="note9-27">Note 9-27: (MIC) サンプリング種別の拡張</A></H3>
<P>マイクによるサンプリングを行う関数において指定可能なサンプリング種別が拡張され、
符号付きデータ形式での出力を指定することが可能となりました。</P>
<HR>
<H3><A name="note9-28" id="note9-28">Note 9-28: (PRC) 図形認識API の追加(テスト公開)</A></H3>
<P>タッチパネルによる描画データ等の図形認識を行う PRC ライブラリをテスト公開しました。<BR>
<BR>
　　$NitroSDK/build/demos/prc <BR>
<BR>
以下にデモを用意しました。<BR>
<BR>
詳しくはドキュメント<BR>
<BR>
　　$NitroSDK/docs/TechnicalNotes/PatternRecognition.doc<BR>
<BR>
を参照してください。</P>
<HR>
<H3><A name="note9-29" id="note9-29">Note 9-29: (TP)タッチパネルの取得データ精度の変更</A></H3>
<P>タッチパネルデバイスからの取得値精度を12bitから9bit に変更しました。ARM7側で下位3bitをマスクしています。これは将来の互換のためです。</P>
<HR>
<H3><A name="KnownIssues_2_00_pr1" id="KnownIssues_2_00_pr1">SDK 2.0 PR1 での既知の問題点</A></H3>
(次回以降のリリースで修正される予定です)
<UL>
  <LI>無線ライブラリについては作成中です。
  <LI>CARDライブラリについては作成中です。
  <LI>ARM9でシステムスタック領域をDTCM全域にしている場合、DTCMアリーナ領域はないということになるのですが、この時にDTCMアリーナに関係する関数を呼ぶとDEBUGビルドされたライブラリではASSERTで停止します。(システムスタック領域の大きさをLSFファイルで指定している場合は正常動作しますので、必要な場合、そのようにして回避してください。また、DEBUGビルドでない場合はASSERTで停止しないだけで、正常な値が返りません)　これが原因で、OSデモのarena-1
  はDEBUGビルドでは ASSERTで停止します。
</UL>
<HR>
<H2 style="line-height: 0"><A name="sdk_1_02_rc2" id="sdk_1_02_rc2">■ NITRO-SDK Version 1.2</A></H2>
<DIV style="text-align: right">
<P style="line-height: 0">(2004/6/16)</P>
</DIV>
<HR>
<H3><A name="note8-01" id="note8-01">Note 8-01: (CP) IRQハンドラ内でのCPコンテキスト切り替え処理の追加</A></H3>
<P>IRQハンドラ内でスレッドが切り替わるときに、除算器、平方根演算器の コンテキストを保存していませんでした。これを修正してコンテキストが
適切に切り替わるようにしました。</P>
<HR>
<H3><A name="note8-02" id="note8-02">Note 8-02: (FX) 定数定義の修正と追加</A></H3>
<P>FX_F32_TO_FX32()で負の数の場合の丸め処理が誤っていたのを修正し、FX32_CONST()をFX_F32_TO_FX32()の別名としました。
また、FX16_CONST(), FX64_CONST(), FX64C_CONST()をマクロとして追加しました。</P>
<HR>
<H3><A name="note8-03" id="note8-03">Note 8-03: (OS) アイドルスレッド処理の修正</A></H3>
<P>$NitroSDK/build/libraries/os/common/src/os_thread.c の中で、idleスレッドの実行関数である
OSi_IdleThreadProc() のループ部分にテストコードが混入していたのを修正しました。</P>
<HR>
<H3><A name="note8-04" id="note8-04">Note 8-04: (SPI) spiMonkeyデモの修正</A></H3>
<P>spiMonkeyデモをDebug版でビルドすると、動作はするが画面更新速度が 非常に遅いという不具合がありました。これを修正しました。</P>
<HR>
<H3><A name="note8-05" id="note8-05">Note 8-05: (DevEnv) makerom/makelcf 変数値読み込みバグの修正</A></H3>
<P>makerom/makelcf で変数値の取り扱いにバグがあり、正常に動作しない場合がありました。これを修正しました。</P>
<HR>
<H3><A name="KnownIssues_1_02_rc2" id="KnownIssues_1_02_rc2">SDK 1.2 での既知の問題点</A></H3>
(次回以降のリリースで修正される予定です)
<UL>
  <LI>ファイルシステムのうち、アーカイブシステム部分については試用版となっています。
</UL>
<HR>
<H2 style="line-height: 0"><A name="sdk_1_02_rc1" id="sdk_1_02_rc1">■ NITRO-SDK Version 1.2 RC1</A></H2>
<DIV style="text-align: right">
<P style="line-height: 0">(2004/6/10)</P>
</DIV>
<HR>
<H3><A name="note7-01" id="note7-01">Note 7-01: (GX) メイン LCD とサブ LCD 出力先切り替えの設定フラグの変更</A></H3>
<P>パワーコントロールレジスタの &quot;LCD出力先切り換えフラグ&quot; の設定フラグの
GX_DISP_SELECT_*** を最終実機と一致するように定義値を入れ替え (0,1 の論理反転)ました。</P>
<P>同様の修正は、ensata でも行なわれています。1.2 または 1.2RC1 以降の SDK
で作成したアプリケーションを ensata 上で実行される場合は、ensata がこの修正に対応したバージョンであるかどうかご確認ください。</P>
<HR>
<H3><A name="note7-02" id="note7-02">Note 7-02: (MIC) マイクAPIの追加</A></H3>
<P>マイクデバイスを操作する為のAPI、及びこれを使用したデモを追加しました。
また、MICライブラリとタッチパネルやサウンドのライブラリを同時に使用するサンプルとして、
&quot;spiMonkey&quot;デモを追加しました。</P>
<HR>
<H3><A name="note7-03" id="note7-03">Note 7-03: (TP) 最大サンプリングレートの変更</A></H3>
<P>オートサンプリングで指定できる最大サンプリング回数を4回/フレームに変更しました。
これは将来的なハードウェアのコストダウンの際に、これ以上のサンプリング回数を保証
できないことが予測されているためです。</P>
<HR>
<H3><A name="note7-04" id="note7-04">Note 7-04: (TP) タッチパネルコマンド送信直後に割り込みが発生した場合の不具合修正</A></H3>
<P>ARM7へタッチパネル制御コマンドを送信した直後に割り込みがかかった場合に、
ARM7からの応答待ちから復帰できないことがある不具合があり、これを修正しました。</P>
<HR>
<H3><A name="note7-05" id="note7-05">Note 7-05: (TP) オートサンプリングインターフェイスの変更</A></H3>
<P>TP_RequestAutoSamplingStart()において、 バッファのサイズを指定できるよう引数を追加しました。
これによって、サンプリング回数よりも大きなサイズのバッファを指定できるようになり、
新規データによる上書きの対策が可能となりました。</P>
<HR>
<H3><A name="note7-06" id="note7-06">Note 7-06: (TP) TP_SetCallback()の引数の型変更</A></H3>
<P>TP_SetCallback()の引数が関数ポインタの更にポインタとなっていたため、 関数ポインタを直接引数として渡せるように変更しました。</P>
<HR>
<H3><A name="note7-07" id="note7-07">Note 7-07: (FS) async デモの全読み込み完了サイズ表示の不具合の修正</A></H3>
<P>async デモにおいて、全スレッドでの読み込み完了サイズの合計を total ****
byte と表示する部分において、 サイズ加算の処理に不具合があり正確に表示されていませんでした。
これを修正しました。</P>
<HR>
<H3><A name="note7-08" id="note7-08">Note 7-08: (FS) オーバーレイのデータキャッシュが更新されない不具合の修正</A></H3>
<P>オーバーレイモジュールを操作する各関数において、 データキャッシュの更新処理が正しく行われないという不具合を修正しました。</P>
<HR>
<H3><A name="note7-09" id="note7-09">Note 7-09: (FS) FS_SetDefaultDMA()関数の不具合の修正</A></H3>
<P>NITRO-CARDを使用する環境での実行時にFS_SetDefaultDMA()でDMA設定を変更すると、
ファイル読み込みが異常動作することがあるという不具合がありました。これを修正しました。</P>
<HR>
<H3><A name="note7-10" id="note7-10">Note 7-10: (OS) IRQハンドラの仕様変更</A></H3>
<P>IRQハンドラの先頭で IE と IF の論理積が 0 のときに何もせずに抜けるようにしました。
これはIEの設定中に割り込みが掛かった時に永久ループに陥ることがあった不具合の修正となります。</P>
<HR>
<H3><A name="note7-11" id="note7-11">Note 7-11: (OS) デフォルトの最大スレッド数の変更</A></H3>
<P>スレッドシステムで作成できる最大スレッド数を8から16に変更しました。</P>
<HR>
<H3><A name="note7-12" id="note7-12">Note 7-12: (OS) OS_GetNumberOfThread() の作成</A></H3>
<P>現在作成されているスレッド数を取得する関数 OS_GetNumberOfThread() を作成しました。</P>
<HR>
<H3><A name="note7-13" id="note7-13">Note 7-13: (OS) アリーナ設定の変更</A></H3>
<P>これまで、ARM7用のアリーナの範囲を設定する際に固定の値を用いていましたが、
共用WRAMとARM7専用WRAMにARM7プログラムを格納した後の空き領域を考慮し、
それに対してARM7用共用WRAM アリーナと ARM7専用WRAMアリーナを設定するように変更しました。</P>
<P>また、これに伴い、OS_InitArena() でアリーナ設定をする際に lcf ファイルから定義される値を受け取る都合上、
上の２つのアリーナはARM7で、 残りのアリーナをARM9で設定するようにしました。</P>
<HR>
<H3><A name="note7-14" id="note7-14">Note 7-14: (OS) プロテクションリージョン関数の変更</A></H3>
<P>以前のバージョンまでの OS_SetProtectionRegion() を OS_SetProtectionReginParam()
に改名し、より直感的にアドレスやサイズを設定できる関数を用意してそちらを
OS_SetProtectionRegion() にしました。</P>
<P>OS_GetProtectionRegion() はその機能別に、OS_GetProtectionRegionParam()
と OS_GetProtectionRegionAddress() と OS_GetProtectionRegionSize() とに分割しました。</P>
<HR>
<H3><A name="note7-15" id="note7-15">Note 7-15: (OS) Profile 機能のOSライブラリからの分割</A></H3>
<P>OSライブラリのうちProfile機能を分割して独立したライブラリとしました。 これによって、Profile機能を利用するときにOSライブラリを再コンパイルする必要がなくなりました。</P>
<P>関数コールトレースを有効にする場合は</P>
<BLOCKQUOTE><CODE>NITRO_PROFILE_TYPE=CALLTRACE</CODE></BLOCKQUOTE>
<P>を指定し、 関数コスト計測を有効にする場合は</P>
<BLOCKQUOTE><CODE>NITRO_PROFILE_TYPE=FUNCTIONCOST</CODE></BLOCKQUOTE>
<P>を指定することで必要なライブラリがリンクされます。</P>
<HR>
<H3><A name="note7-16" id="note7-16">Note 7-16: (OS) 関数コールトレース表示の修正</A></H3>
<P>関数コールトレースで、4レベル以上のインデント表示に不具合があり、修正されました。</P>
<HR>
<H3><A name="note7-17" id="note7-17">Note 7-17: (OS) OS_GetConsoleType() の作成</A></H3>
<P>現在の動作環境を取得する関数 OS_GetConsoleType() を作成しました。 取得出来る値には、ROMデータの読み出しデバイスやメインメモリサイズについての情報も含みます。</P>
<HR>
<H3><A name="note7-18" id="note7-18">Note 7-18: (OS) OS_Printf()等デバッグ用関数のFINALROMビルドでの扱い変更</A></H3>
<P>FINALROM ビルドでの OS_Printf() 等の表示関数の扱いを変更しました。 これまでは
OS_Printf() を呼び出して何もせず戻る関数となっていましたが、 呼び出し自体もしなくなりました。
また、OS_Panic() では表示なしで停止するようになりました。</P>
<HR>
<H3><A name="note7-19" id="note7-19">Note 7-19: (OS) TCM関数名の変更</A></H3>
<P>他の関数名仕様とあわせるために以下のTCM関数名を変更しました。 左が変更前、右が変更後です。</P>
<BLOCKQUOTE>
<PRE><CODE>OS_SetParamITCM() → OS_SetITCMParam()
OS_SetParamDTCM() → OS_SetDTCMParam()
OS_GetParamITCM() → OS_GetITCMParam()
OS_GetParamDTCM() → OS_GetDTCMParam()</CODE></PRE>
</BLOCKQUOTE>
<HR>
<H3><A name="note7-20" id="note7-20">Note 7-20: (OS) OS デモ構成の変更</A></H3>
<P>profile 関連の機能を別ライブラリに分離したことで、OSライブラリをコンパイル
しなおさなくてよくなったことに伴い、これまでOSデモのMakefileに含めて いなかった
callTrace-1 callTrace-2 exceptionDisplay-3 functionCost-1 functionCost-2
functionCost-3 のコンパイルを含めるようにしました。</P>
<HR>
<H3><A name="note7-21" id="note7-21">Note 7-21: (GX) GXデモの修正</A></H3>
<P>デモAntiAlias で、ClearColorが設定されて いなかったために背景色とブレンドされずアンチエイリアスが
かかっていませんでした。これを修正しました。</P>
<P>デモ2D_Oam_5 と Sub_Oam_5 で、データキャッシュの Flush をしてなかったためにFINALROMビルドで正常動作していませんでした。
これを修正しました。</P>
<HR>
<H3><A name="note7-22" id="note7-22">Note 7-22: (GX) Ensataバージョンアップによるデモの制限解除</A></H3>
<P>Ensataのバージョンアップにより、Ensataでの動作時のみおこなっていた AntiAlias,
PosVecTest, CurrentMtxの動作制限を解除しました。</P>
<HR>
<H3><A name="note7-23" id="note7-23">Note 7-23: (GX) 拡張パレット用VRAM設定名称の変更</A></H3>
<P>GXVRamBGExtPltt, GXVRamOBJExtPltt, GXVRamSubBGExtPltt, GXVRamSubOBJExtPltt
で定義されている拡張パレット用のVRAM設定名称をスロット番号を含む表記へ統一しました。
過去の名称はマニュアルには記載されませんが別名として残されます。</P>
<HR>
<H3><A name="note7-24" id="note7-24">Note 7-24: (GX) GX_Initの複数呼び出しの対策</A></H3>
<P>GX_Init() を複数回呼び出すと、内部でstaticに持っているVアラーム構造体を
その都度初期化に行ってそこで停止していました。 これを、GX_Init() を複数回呼び出してもVアラーム構造体の初期化は一度しか行われないようにしました。</P>
<HR>
<H3><A name="note7-25" id="note7-25">Note 7-25: (GX) GX_GetObj_* の作成</A></H3>
<P>以下の関数をインライン関数として用意しました。</P>
<BLOCKQUOTE>
<PRE><CODE>G2_GetOBJCharName()
G2_GetOBJColorMode()
G2_GetOBJEffect()
G2_GetOBJColorParam()
G2_GetOBJMode()
G2_GetOBJPosition()
G2_GetOBJPriority()
G2_GetOBJShape()</CODE></PRE>
</BLOCKQUOTE>
<HR>
<H3><A name="note7-26" id="note7-26">Note 7-26: (FX) FX32_CONST()マクロの作成</A></H3>
<P>fx32 形式の定数を定義する FX_CONST() マクロを作成しました。</P>
<HR>
<H3><A name="note7-27" id="note7-27">Note 7-27: (MI) MI_UncompressRL8() の修正</A></H3>
<P>ランレングス圧縮データを8bit単位で展開する関数 MI_UncompressRL8() に不具合があり、正確に展開出来ませんでした。これを修正しました。</P>
<HR>
<H3><A name="note7-28" id="note7-28">Note 7-28: (DevEnv) makerom, makelcf の解説の追加</A></H3>
<P>リファレンスマニュアルに「ツール」の項目を追加し、makerom makelcf に 関する説明を追加しました。</P>
<HR>
<H3><A name="note7-29" id="note7-29">Note 7-29: (DevEnv) 本体 NVRAM に保持されるデータの書き換えツール</A></H3>
<P>ブートメニューによって設定される各種情報を書き換えるための簡易ツールを
収録しました。タッチパネルのキャリブレーション設定ツールとしてお使いください。</P>
<BLOCKQUOTE><CODE>$NitroSDK/bin/ARM9-TEG/Release/BootMenu.srl</CODE></BLOCKQUOTE>
<P>が実行ファイルです(2.0PR5 において BootMenu.bin より改称)。これを TEG で実行することで、簡易メニューが起動します。タッチパネル以外の設定項目については最終品と異なる可能性があるため、現状では参考資料であるとお考えください。</P>
<HR>
<H3><A name="note7-30" id="note7-30">Note 7-30: (DevEnv)</A> コンパイル時-gオプションの扱いの変更</H3>
<P>SDK で提供している CodeWarrior の make によるビルド環境において FINALROM
バージョンのビルド時にも &quot;-g&quot; オプションをつけて コンパイル、リンクを行なうように変更しました。</P>
<P>CodeWarrior では -g オプションで NEF ファイルへデバッグ情報が 追加されるだけで、ROMイメージのバイナリに違いはありません。</P>
<P>また逆に -g オプションを外してコンパイル、リンクを行なうための スイッチとして
NITRO_NO_OPT_G を用意しました。</P>
<BLOCKQUOTE><CODE>make NITRO_NO_OPT_G=1</CODE></BLOCKQUOTE>
<P>とすれば -g オプションを外したビルドが行なわれます。</P>
<HR>
<H3><A name="note7-31" id="note7-31">Note 7-31: (DevEnv) makerom で誤まったエラーメッセージが出力される不具合の修正</A></H3>
<P>makerom 実行時、環境によっては、実際にはエラーは発生していないにも 関わらず
&quot;Error: Wrong format list file&quot; というエラーメッセージが出力され、makerom
の実行が停止してしまうバグがありました。 これを修正しました。</P>
<HR>
<H3><A name="KnownIssues_1_02_rc1" id="KnownIssues_1_02_rc1">SDK 1.2 RC1 での既知の問題点</A></H3>
(次回以降のリリースで修正される予定です)
<UL>
  <LI>ファイルシステムのうち、アーカイブシステム部分については試用版となっています。
  <LI>SPI デモの spiMonkey を Debug コンパイルしたものは正常に動作しません。
</UL>
<HR>
<H2 style="line-height: 0"><A name="sdk_1_02_pr1" id="sdk_1_02_pr1">■ NITRO-SDK Version 1.2 PR1</A></H2>
<DIV style="text-align: right">
<P style="line-height: 0">(2004/5/24)</P>
</DIV>
<HR>
<H3><A name="note6-01" id="note6-01">Note 6-01: (DevEnv) CodeWarrior NITRO V0.5 への対応</A></H3>
<P>CodeWarrior NITRO V0.5 に対応しました。ライブラリファイル名の変更および
LCF ファイルの変更に対応しています。</P>
<HR>
<H3><A name="note6-02" id="note6-02">Note 6-02: (DevEnv) ROM バイナリ作成ツールを elftobin から makerom へ変更</A></H3>
<P>ROM バイナリ作成ツールを elftobin から makerom に変更しました。 これによりファイルシステムおよびオーバーレイがサポートされます。</P>
<HR>
<H3><A name="note6-03" id="note6-03">Note 6-03: (DevEnv) lcf の ALIGN(32) 追加</A></H3>
<P>オーバーレイにおけるキャッシュラインに関連する問題回避のためオーバーレイセグメントの先頭と最後尾で
32 バイトアラインメントを保つように lcf 関連ファイルを修正しました。</P>
<HR>
<H3><A name="note6-04" id="note6-04">Note 6-04: (DevEnv) 実行バイナリ生成規則の依存ファイルの追加手段のサポート</A></H3>
<P>.nef と .bin の生成規則の依存ファイルに $(LDEPENDS_NEF) と $(LDEPENDS_BIN)
を それぞれ追加しました。具体的には以下のようになります。</P>
<PRE><CODE>
$NitroSDK/build/buildtools/modulerule.cctype.CW:

  $(BINDIR)/%.nef: $(OBJS) $(LCFILE) $(MAKEFILE) $(LDEPENDS_NEF)

$NitroSDK/build/buildtools/modulerule:

  $(BINDIR)/%.bin: $(BINDIR)/%.nef $(MAKEROM_ARM7) $(ROM_SPEC) $(LDEPENDS_BIN)
</CODE></PRE>
<HR>
<H3><A name="note6-05" id="note6-05">Note 6-05: (DevEnv) CodeWarrior以外のコンパイラからのヘッダインクルードへの対応</A></H3>
<P>Windows 上において NITRO 関連ツール等を作成する際に CodeWarrior以外のCコンパイラからNitroSDKのヘッダファイルをインクルードしたい場合があります。しかしながら
Visual C++ などの処理系においては、可変引数のマクロがサポートされていないなどの理由で
nitro.h のインクルードがエラーとなります。 これに対処したいというご要望から
$NitroSDK/include/nitro_win32.h を用意しました。</P>
<P>nitro_win32.h の内部で、以下の２つのdefine値を定義することで、gx.h, memorymap.h,
type.h などのヘッダファイルのインクルードが可能となっています。</P>
<PRE> <CODE>#define SDK_FROM_TOOL
 #define SDK_HAS_NO_LONG_LONG_INT_</CODE></PRE>
<P>ただし、<CODE>SDK_HAS_NO_LONG_LONG_INT_</CODE> の <CODE>#define</CODE> については「64ビット整数を<CODE>long long int</CODE>から、<CODE>__int64</CODE>に置き換える」という指定なので、gcc等 <CODE>long long int</CODE> という定義が有効な環境ではこの定義は必要ありません。</P>
<HR>
<H3><A name="note6-06" id="note6-06">Note 6-06: (DevEnv) IDE デモサンプルの配布終了</A></H3>
<P>CodeWarrior を使用するための IDE デモサンプルプログラムの配布を打ち切ることにしました。
既に CodeWarrior for NITRO において NITRO 用ステーショナリファイルが用意されているため
IDE サンプルはその役目を終えたと考えたからです。</P>
<HR>
<H3><A name="note6-07" id="note6-07">Note 6-07: (ARM7) 統合コンポーネントferretの追加</A></H3>
<P>様々なデバイスを処理する統合コンポーネントferret を追加しました。特に指定しない場合、このコンポーネントがデフォルトで結合されます。</P>
<P>コンポーネントのパスは $NitroSDK/components/ferret/ARM7-TEG/(ターゲット)
以下になります。( Thumb コンポーネントの場合は ARM7-TEG の部分が ARM7-TEG.thumb
となります。)</P>
<HR>
<H3><A name="note6-08" id="note6-08">Note 6-08: (FS) ファイルシステム、オーバーレイのサポート</A></H3>
<P>makerom によって生成したアプリケーション内で ROM ファイルシステムを使用するためのライブラリを追加しました。ディレクトリの列挙/検索、ファイルの同期/非同期リード、オーバーレイなどが可能になります。</P>
<P>FS ライブラリでは、NITRO の標準のソフト供給媒体である NITRO-CARD へリードアクセスする処理がサポートされています。FS
ライブラリは TEG ボードのデバイス接続状況に応じて、ファイルシステムとして、カートリッジのイメージを使用するか
NITRO-CARD のイメージを使用するかどうかを内部で切り替えます。</P>
<P>これに伴い SVC_ReadCard() が廃止されています。</P>
<HR>
<H3><A name="note6-09" id="note6-09">Note 6-09: (TP) タッチパネル関数のサポート</A></H3>
<P>タッチパネル制御関連 API がサポートされました。</P>
<P>ARM7 側と ARM9 側との処理分担の変更にともない、今まで別パッケージで配布していた
TP ライブラリと API が変更されていますので、ご注意ください。また、この変更により、タッチパネルのキャリブレーションパラメータが変更になっているため、もう一度タッチパネルのキャリブレーション処理を行なってください。</P>
<P>新しいタッチパッドのキャリブレーションバイナリは、$NitroSDK/bin/ARM9-TEG/Release/BootMenu.srl (2.0PR5 において BootMenu.bin より改称)
となります。バイナリ起動後、画面のメニューから TOUCH PANEL を選び、キャリブレーション処理を行なってください。</P>
<HR>
<H3><A name="note6-10" id="note6-10">Note 6-10: (CP) 除算器、平方根演算器の割り込み、マルチスレッドへの対応</A></H3>
<P>除算器および平方根演算器を割り込み処理のコールバック内で安全に使用できるように、
除算器、平方根演算器の現在の状態を保存、復帰するための API (CP_SaveContext,
CP_RestoreContext) を用意しました。</P>
<P>また除算器および平方根演算器がマルチスレッドに対応になりました。</P>
<HR>
<H3><A name="note6-11" id="note6-11">Note 6-11: (GX) MtxFx22 用の API 作成</A></H3>
<P>2x2 行列の MtxFx22 型変数を操作するための API が用意されました。</P>
<PRE><CODE>
        MTX_Identity22()
        MTX_Concat22()
        MTX_Inverse22()
        MTX_Transpose22()
        MTX_Rot22()
        MTX_Scale22()
</CODE></PRE>
<HR>
<H3><A name="note6-12" id="note6-12">Note 6-12: (GX) TEG ボードにおけるコマンド FIFO の動作不良の対策</A></H3>
<P>TEG ボードにおけるコマンド FIFO 溢れ処理のハードの不具合により GX_LoadMtx44
などの処理が正常に行なわれないことがありました。これを、ライブラリ側で対策しました。このハードの不具合は製品版では修正されます。</P>
<HR>
<H3><A name="note6-13" id="note6-13">Note 6-13: (GX) GX_SetBankForARM7() への GX_VRAM_ARM7_128_C の追加 </A></H3>
<P>GX_SetBankForARM7() がサポートする引数として GX_VRAM_ARM7_128_C が追加されました。</P>
<HR>
<H3><A name="note6-14" id="note6-14">Note 6-14: (GX) BG拡張パレットへの GX_VRAM_BGEXTPLTT_01_F の指定時の不具合の修正</A></H3>
<P>API GX_SetBankForBGExtPltt において引数に GX_VRAM_BGEXTPLTT_01_F を設定したときに
正しく設定されていない不具合を修正しました。</P>
<HR>
<H3><A name="note6-15" id="note6-15">Note 6-15: (GX) ジオメトリエンジンの Swapbuffer 処理と同期を取るための手法のデモを追加</A></H3>
<P>3D エンジンの演算が処理落ちしたかどうかを判定するためにポリゴンカウンタを使用する
手法のデモが以下に追加されました。</P>
<P>　　　<CODE> $NitroSDK/build/demos/tips/SwapCrossOver</CODE></P>
<P>3D 画面演算の処理落ちのために 2D 画面とずれが生じるような場合には、 このポリゴンカウンタを使用した同期取りの手法も検討してください。</P>
<HR>
<H3><A name="note6-16" id="note6-16">Note 6-16: (GX) scaleW を調整できる透視変換行列関連 API 作成</A></H3>
<P>scaleW の値を任意に設定できる以下のような透視変換関連 API を作成しました。</P>
<P><CODE>　　　G3_FrustumW(), G3_PerspectiveW(), G3_OrthoW()</CODE></P>
<P>またジオメトリエンジンへ送らずに行列作成のみを行なう、 MTX_Frustum(), MTX_Perspective(),
MTX_Ortho() も別途用意しました。</P>
<HR>
<H3><A name="note6-17" id="note6-17">Note 6-17: (GX) GX_Init 関数によるコマンド FIFO リセット処理の変更</A></H3>
<P>コマンド FIFO リセット処理の実装を変更しました。内部処理として NOP を 128
個送った後 G3_End() を発行しています。</P>
<HR>
<H3><A name="note6-18" id="note6-18">Note 6-18: (GX) フォグモードの制御の不具合の修正</A></H3>
<P>G3X_SetFog において fogMode を 1 から 0 に戻せない不具合がありました。これを修正しました。</P>
<HR>
<H3><A name="note6-19" id="note6-19">Note 6-19: (OS)スレッドシステムの扱いの変更</A></H3>
<P>将来接続される様々なデバイスの制御を考慮し、スレッドシステムの初期化をデフォルトで行なうように変更しました。OS_Init()
で OS_InitThread() を呼んでいます。</P>
<P>スレッドシステムを使用しないライブラリを作成する場合は、NITRO_NO_THREADを
定義してコンパイルしてください。</P>
<HR>
<H3><A name="note6-20" id="note6-20">Note 6-20: (OS) OS_SPrintf() の追加</A></H3>
<P>浮動小数点値など一部の出力対応を省くことにより、標準関数 sprintf() よりも
コードサイズ面で軽量な書式文字列関数 OS_SPrintf() とその系列を追加しました。
これは、主に ARM7 プロセッサ側での文字列処理に使用されています。</P>
<HR>
<H3><A name="note6-21" id="note6-21">Note 6-21: (OS) TEG ボードメモリバイトアクセス対策</A></H3>
<P>TEG 版でのプログラム作成の利便性を考慮し、メモリバイトアクセス対策の MI_ReadByte()、MI_WriteByte()
が用意されました。これらは、製品版ライブラリにおいては単純なバイトアクセス命令に変換されます。</P>
<HR>
<H3><A name="note6-22" id="note6-22">Note 6-22: (OS) OS_WaitIrq()、OS_WaitAnyIrq()、OS_WaitInterrupt() の作成</A></H3>
<P>指定の IRQ を待つ関数 OS_WaitIrq() と OS_WaitAnyIrq()、OS_WaitInterrupt()
を作成しました。OS_WaitIrq()とOS_WaitAnyIrq() はIRQを待つ間、他のスレッドに処理を譲ります。</P>
<P>OS_WaitInterrupt() はOS_Halt() にて待機しますのでスレッドの移動はありません。
これはこれまでのSVC_WaitIntr() と同じ動作を行うという位置付けで用意されています。</P>
<HR>
<H3><A name="note6-23" id="note6-23">Note 6-23: (OS) ATTRIBUTE_ALIGN(x) の作成</A></H3>
<P>変数定義の際に、配置のアラインメントを指定する ATTRIBUTE_ALIGN() マクロを作成しました。このマクロ名は
NINTENDO GAMECUBE SDK の定義に合わせたものとなっています。</P>
<HR>
<H3><A name="note6-24" id="note6-24">Note 6-24: (OS) IDLEスレッドスタックの拡張</A></H3>
<P>Thread システム起動時に作成される最低優先度のアイドルスレッドのスタックサイズを、
SVC用にARM9で128バイト、ARM7で64バイトとしました。</P>
<HR>
<H3><A name="note6-25" id="note6-25">Note 6-25: (OS) OS_GetLockID(), OS_ReleaseLockID() の作成</A></H3>
<P>OS の SpinLock で使用されるロックIDを管理する機構として OS_GetLockID(),
OS_ReleaseLockID() を作成しました。</P>
<HR>
<H3><A name="note6-26" id="note6-26">Note 6-26: (OS) OS_SetSwitchThreadCallback() の作成</A></H3>
<P>スレッド切り替え時のコールバック機能を追加しました。コールバックの登録は
OS_SetSwitchThreadCallback() で行います。</P>
<HR>
<H3><A name="note6-27" id="note6-27">Note 6-27: (OS) OS_ExitThread() 時の Mutex 開放</A></H3>
<P>OS_ExitThread() でスレッドを終了するときに、そのスレッドがロックしている
Mutexを開放するようにしました。</P>
<HR>
<H3><A name="note6-28" id="note6-28">Note 6-28: (OS) ARM7 コンポーネントのループ処理の変更</A></H3>
<P>ARM7 コンポーネントのメインループ処理を OS_Halt() ループにしました。</P>
<HR>
<H3><A name="note6-29" id="note6-29">Note 6-29: (OS) OS_SetProtectionRegion7(), OS_SetProtectionRegion7 の修正</A></H3>
<P>OS_SetProtectionRegion7(), OS_SetProtectionRegion7 が、 リージョン 6 に対する操作になっていたのをリージョン
7 への操作に修正しました。</P>
<HR>
<H3><A name="note6-30" id="note6-30">Note 6-30: (OS) システムクロックの定義</A></H3>
<P>各プロセッサの CPU クロック値 HW_CPU_CLOCK_ARM7,HW_CPU_CLOCK_ARM9 および
現在のコンパイルターゲットプロセッサの CPU クロック値 HW_CPU_CLOCK を定義しました。</P>
<HR>
<H3><A name="note6-31" id="note6-31">Note 6-31: (OS) OS_Panic() の停止動作変更</A></H3>
<P>OS_Panic() の停止動作を OS_Halt ではなく、OS_Terminate() としました。</P>
<HR>
<H3><A name="note6-32" id="note6-32">Note 6-32: (OS) OSのデモ構成の変更</A></H3>
<P>OSのデモ構成を変更しました。これにより waitIrq-1, waitIrq-2 が追加されました。</P>
<P>またMakefile に入れないデモとして callTrace-1 callTrace-2 exceptionDisplay-3
functionCost-1 functionCost-2 functionCost-3 を用意しました。Makefile に含めていないのは、OSライブラリを特定のオプションでコンパイルする必要があるためです。</P>
<HR>
<H3><A name="note6-33" id="note6-33">Note 6-33: (OS) IRQハンドラの変更</A></H3>
<P>ハードの仕様上、割り込みの許可や禁止と実際のIRQの発生のタイミングの問題で
IRQが発生したときにIME=0である場合がありましたが、この時何もせずに抜けるようにしました。</P>
<HR>
<H3><A name="note6-34" id="note6-34">Note 6-34: (OS) 関数コールトレース、関数コスト計測機構の作成</A></H3>
<P>CodeWarriorのprofile機能を利用した関数コールトレースと、関数コスト計測の機構を追加しました。</P>
<P>NITRO-SDK における profile 機能のサポートについての解説は</P>
<BLOCKQUOTE><CODE>$NitroSDK/docs/TechnicalNotes/MechanismOfProfiler.doc</CODE></BLOCKQUOTE>
<P>をご覧ください。</P>
<HR>
<H3><A name="note6-35" id="note6-35">Note 6-35: (OS) アプリケーション向けの割り込みチェックフラグの追加</A></H3>
<P>SDKの割り込み要因と同様にアプリケーションで自由に使用できるチェックフラグ
OS_IE_USER_FLAG0, OS_IE_USER_FLAG1 を用意しました。</P>
<HR>
<H3><A name="note6-36" id="note6-36">Note 6-36: (SND) サウンドライブラリの更新</A></H3>
<P>NITRO-SDK で配布するサウンドラインブラリが2004年4月12日版となりました。</P>
<HR>
<H3><A name="KnownIssues_1_02_pr1" id="KnownIssues_1_02_pr1">SDK 1.2 PR1 での既知の問題点</A></H3>
(次回以降のリリースで修正される予定です)
<UL>
  <LI>ファイルシステムのうち、アーカイブシステム部分については試用版となっています。
  <LI>SDK 1.2 PR1 は CodeWarrior-0.5 以降の使用が前提となっています。このため以前のバージョンでは正常に動作しない可能性があります。
  <LI>makerom/makelcf のドキュメントが用意されていません。
  <LI>FINALROM 版のバイナリは 2004/03/30 版の ensata 上で動作しません。
</UL>
<HR>
<H2 style="line-height: 0"><A name="sdk_1_00_rc2" id="sdk_1_00_rc2">■ NITRO-SDK Ver 1.0</A></H2>
<DIV style="text-align: right">
<P style="line-height: 0">(2004/4/5)</P>
</DIV>
<HR>
<H3><A name="note5-01" id="note5-01">Note 5-01: CodeWarrior NITRO V0.4 への対応</A></H3>
<P>CodeWarrior NITRO V0.4 に対応しました。これにより CodeWarrior のバージョンに対応してコンパイラ起動時のオプション
-avoid_strb ⇔ -avoid_byte が切り替わります。</P>
<P>コンパイラのバージョン情報は $NitroSDK/build/buildtools 以下の verinfo.cw.cc
と verinfo.cw.ld に保存されます。これらのファイルは CodeWarrior を 0.3
→ 0.4 にアップグレードしたときにも自動的に更新されますが、0.4 → 0.3 へダウングレードさせた場合には更新されず不具合が起こります。CodeWarrior
のダウングレード時には $NitroSDK/build/buildtools/verinfo.cw.* ファイルを手動で消していただくか、もしくはコマンドラインから
make clean-verinfo と入力していただく必要があります。</P>
<HR>
<H3><A name="note5-02" id="note5-02">Note 5-02: GX_HBlankOBJProc() / GXS_HBlankOBJProc() の修正</A></H3>
<P>GX_HBlankOBJProc() および GXS_HBlankOBJProc() においてパラメータ proc の値と実際の動作が逆になっていました。</P>
<P>この不具合は修正されました。</P>
<HR>
<H3><A name="note5-03" id="note5-03">Note 5-03: G2_SetOBJAttr() / G2S_SetOBJAttr() の修正</A></H3>
<P>G2_SetOBJAttr() および G2S_SetOBJAttr() において GX_OAM_MODE_BITMAPOBJ
モードに対して GX_OAM_EFFECT_AFFINEを使った時に rsParam パラメータの指定が
OAM に反映されませんでした。</P>
<P>この不具合は修正されました。</P>
<HR>
<H3><A name="note5-04" id="note5-04">Note 5-04: GX_DisableBankFor*() の修正</A></H3>
<P>GX_DisableBankFor*() において内部動作に誤りがあり、正しく動作していませんでした。</P>
<P>この不具合は修正されました。</P>
<HR>
<H3><A name="note5-05" id="note5-05">Note 5-05: NitroPostLinker.bat の修正</A></H3>
<P>NitroPostLinker.bat ファイルが、環境変数 CWFOLDER_IRIS を参照していました。</P>
<P>環境変数 CWFOLDER_NITRO を参照するように修正されました。</P>
<HR>
<H3><A name="note5-06" id="note5-06">Note 5-06: fs/file-1 デモのリンク不具合の修正</A></H3>
<P>fs/file-1 デモにおいてリンク手順に不具合があり、NitroStartUp() を追加しても
NitroStartUp() がリンクされませんでした。</P>
<P>これは修正されました。</P>
<HR>
<H3><A name="note5-07" id="note5-07">Note 5-07: makerom (β版)の修正</A></H3>
<P>現在、ツール評価版として付属している makerom ツールにおいて ARM9 の常駐モジュールのサイズが小さい場合エラーが発生していました。</P>
<P>これは修正されました。</P>
<HR>
<H3><A name="note5-08" id="note5-08">Note 5-08: makelcf (β版) 用 lcf テンプレートの修正</A></H3>
<P>現在、ツール評価版として付属している makelcf ツールにおける lcf テンプレートファイルにおいてモジュールサイズの計算の一部に誤りがありました。</P>
<P>これは修正されました。</P>
<HR>
<H3><A name="KnownIssues_1_00_rc2" id="KnownIssues_1_00_rc2">NITRO-SDK Ver 1.0 の既知の問題点</A></H3>
<UL>
  <LI>新しく追加されたデモについての解説がオンラインマニュアルに一部追加されていません。
  <LI>ROM ファイルシステム関数、オーバーレイはさらに持ち越しとなります。
</UL>
<HR>
<H2 style="line-height: 0"><A name="sdk_1_00_rc1" id="sdk_1_00_rc1">■ NITRO-SDK Ver 1.0 RC1</A></H2>
<DIV style="text-align: right">
<P style="line-height: 0">(2004/3/30)</P>
</DIV>
<HR>
<H3><A name="note4-01" id="note4-01">Note 4-01: G3_Frustum() の不具合修正</A></H3>
<P>$NitroSDK/build/libraty/gx/src/g3_util.c 内に不備があり、G3_Frustum() の行列が正しく設定出来ませんでした。<BR>
この不具合は修正されました。</P>
<HR>
<H3><A name="note4-02" id="note4-02">Note 4-02: GX_LoadTex() での転送エラー修正</A></H3>
<P>VRAM_A に テクスチャイメージのスロット０を確保してGX_LoadTex()でイメージを転送するとエラーが出て止まってしまう不具合を修正しました。</P>
<HR>
<H3><A name="note4-03" id="note4-03">Note 4-03: GX_RegionCheck_OBJ() の修正</A></H3>
<P>OBJにVRAM_Bを割り当てた状態で Textureロードなどを実行した場合、ASSERTで停止していました。<BR>
この不具合は修正されました。</P>
<HR>
<H3><A name="note4-04" id="note4-04">Note 4-04: G3X_GetCommandFifoStatus() の修正</A></H3>
<P>G3X_GetCommandFifoStatus() からの返り値が正確ではありませんでした。<BR>
この不具合は修正されました。</P>
<HR>
<H3><A name="note4-05" id="note4-05">Note 4-05: DTCM の位置変更のサポート</A></H3>
<P>DTCMの位置を変更出来るようになりました。<BR>
$NitroSDK/include/nitro/hw/common/mmap_global.h のHW_DTCM の値を変更することで可能です。<BR>
ただし、変更後にライブラリを full make する必要があります。</P>
<HR>
<H3><A name="note4-06" id="note4-06">Note 4-06: codereset.h の修正</A></H3>
<P>$NitroSDK/include/nitro/codereset.h に不備があり、常に thumb に切り替わるようになっていました。<BR>
この不具合は修正されました。</P>
<HR>
<H3><A name="note4-07" id="note4-07">Note 4-07: 例外ベクタ設定不具合</A></H3>
<P>デバッガが例外ベクタを使用している時に、NITRO-SDK での設定との共存のために例外ベクタをフックする処理が間違っており、正確な動作が出来ませんでした。<BR>
この不具合は修正されました。</P>
<HR>
<H3><A name="note4-08" id="note4-08">Note 4-08: 周期アラームのハンドル内自己キャンセル追加</A></H3>
<P>これまでは周期アラームのハンドル内で、そのアラーム自身をキャンセルすることが出来ませんでしたが、可能になりました。</P>
<HR>
<H3><A name="note4-09" id="note4-09">Note 4-09: OS_IsThreadAvailable() の追加</A></H3>
<P>スレッドシステムが初期化され、使用可能な状態かどうかを調べる関数 OS_IsThreadAvailable()
が追加されました。</P>
<HR>
<H3><A name="note4-10" id="note4-10">Note 4-10: 定数やアドレス代入アセンブラ表記の統一</A></H3>
<P>定数やアドレスを代入するアセンブラ表記において、ldconst や lda を止め、ldr
を用いた表記へ統一しました。<BR>
<BR>
　(変更前)　　　　　　　　　　　　　　　(変更後)<BR>
ldconst r0, #CONSTANT → ldr r0, =CONSTANT<BR>
lda r0, Address 　　　　　　→ ldr r0, =Address<BR>
</P>
<HR>
<H3><A name="note4-11" id="note4-11">Note 4-11: G2_SetBG3ControlDCBmp() 不具合の修正</A></H3>
<P>$NitroSDK/include/nitro/gx/gx_bgcnt.h の assert 判定に誤りがありました。<BR>
この不具合は修正されました。</P>
<HR>
<H3><A name="note4-12" id="note4-12">Note 4-12: 固定小数定義の追加</A></H3>
<P>0.5を表す小数定義を $NitroSDK/include/nitro/fx/fx_const.h に追加しました。fx16型、fx32型、fx64型それぞれの固定小数が、FX16_HALF
、FX32_HALF 、 FX64_HALF として定義されます。</P>
<HR>
<H3><A name="note4-13" id="note4-13">Note 4-13: マクロ FX_MUL32x64C とインライン関数 FX_Mul32x64c の丸め処理の統一</A></H3>
<P>FX_MUL32x64C と FX_Mul32x64c の丸め処理を統一しました。</P>
<HR>
<H3><A name="KnownIssues_1_00_rc1" id="KnownIssues_1_00_rc1">NITRO-SDK Ver 1.0 RC1 の既知の問題点</A></H3>
<UL>
  <LI>ROM ファイルシステム関数、オーバーレイはさらに持ち越しとなります。
</UL>
<HR>
<H2 style="line-height: 0"><A name="sdk_1_00_pr2" id="sdk_1_00_pr2">■ NITRO-SDK Ver 1.0 PR2</A></H2>
<DIV style="text-align: right">
<P style="line-height: 0">(2004/3/17)</P>
</DIV>
<HR>
<H3><A name="note3-01" id="note3-01">Note 3-01: PXI ライブラリの追加</A></H3>
<P>ARM9-ARM7間の通信を行う PXIライブラリを追加しました。</P>
<HR>
<H3><A name="note3-02" id="note3-02">Note 3-02: グラフィックサンプルの追加</A></H3>

<P>以下のグラフィックスサンプルが追加されました。<BR>
</P>
<TABLE cellpadding="2">
  <TBODY>
    <TR>
      <TD>2D_CharBg_256_16</TD>
      <TD>アフィン拡張・256色×16拡張パレットキャラクタＢＧを表示</TD>
    </TR>
    <TR>
      <TD>2D_CharBg_256BMP</TD>
      <TD>アフィン拡張・256色ビットマップＢＧを表示</TD>
    </TR>
    <TR>
      <TD>2D_CharBg_Direct</TD>
      <TD>アフィン拡張・ダイレクトカラービットマップＢＧを表示</TD>
    </TR>
    <TR>
      <TD>2D_Oam_256_16</TD>
      <TD>アフィン拡張・256色×16拡張パレットＯＢＪを表示</TD>
    </TR>
    <TR>
      <TD>2D_Oam_Bmp1D</TD>
      <TD>１次元マッピング・ビットマップＯＢＪの表示</TD>
    </TR>
    <TR>
      <TD>2D_Oam_Char1D</TD>
      <TD>１次元マッピング・キャラクタＯＢＪの表示</TD>
    </TR>
    <TR>
      <TD>2D_Oam_Direct</TD>
      <TD>２次元マッピング・ビットマップＯＢＪの表示</TD>
    </TR>
    <TR>
      <TD>2D_Oam_OBJWindow</TD>
      <TD>ＯＢＪウィンドウの表示</TD>
    </TR>
    <TR>
      <TD>2D_Oam_Translucent</TD>
      <TD>半透明ＯＢＪの表示</TD>
    </TR>
    <TR>
      <TD>3D_BoxTest</TD>
      <TD>ボックステストを行う</TD>
    </TR>
    <TR>
      <TD>3D_PolAttr_1Dot</TD>
      <TD>G3_PolygonAttr() の GX_POLYGON_ATTR_MISC_DISP_1DOT 設定</TD>
    </TR>
    <TR>
      <TD>3D_PolAttr_DpthTest</TD>
      <TD>G3_PolygonAttr() の GX_POLYGON_ATTR_MISC_DEPTHTEST_DECAL 設定</TD>
    </TR>
    <TR>
      <TD>3D_PolAttr_DpthUpdate</TD>
      <TD>G3_PolygonAttr() の GX_POLYGON_ATTR_MISC_XLU_DEPTH_UPDATE 設定</TD>
    </TR>
    <TR>
      <TD>3D_PolAttr_FARClip</TD>
      <TD>G3_PolygonAttr() の GX_POLYGON_ATTR_MISC_FAR_CLIPPING 設定</TD>
    </TR>
    <TR>
      <TD>3D_Pol_Vertex_Source</TD>
      <TD>G3_TexImageParam() の GX_TEXGEN_VERTEX 設定</TD>
    </TR>
    <TR>
      <TD>3D_Shadow_Pol</TD>
      <TD>シャドウポリゴンを使用して影を表示</TD>
    </TR>
    <TR>
      <TD>AntiAlias</TD>
      <TD>アンチエイリアシングを見る</TD>
    </TR>
    <TR>
      <TD>Capture</TD>
      <TD>キャプチャーを利用したモーションブラー効果</TD>
    </TR>
    <TR>
      <TD>ClearColor</TD>
      <TD>クリアカラーを設定</TD>
    </TR>
    <TR>
      <TD>ClearImage</TD>
      <TD>クリアイメージを設定</TD>
    </TR>
    <TR>
      <TD>CurrentMtx</TD>
      <TD>カレントのクリップ座標行列、方向ベクトル座標行列を出力</TD>
    </TR>
    <TR>
      <TD>FlipRepeat</TD>
      <TD>テクスチャのフリップ・リピートを変更</TD>
    </TR>
    <TR>
      <TD>LinesOver</TD>
      <TD>ポリゴンのラインオーバー表示</TD>
    </TR>
    <TR>
      <TD>Master_Bright</TD>
      <TD>マスター輝度の調整</TD>
    </TR>
    <TR>
      <TD>PosVecTest</TD>
      <TD>G3_VectorTest(), G3_PositionTest()の結果を出力</TD>
    </TR>
    <TR>
      <TD>RamOverFlow</TD>
      <TD>ポリゴンリストRAM・頂点RAMをオーバーフロー</TD>
    </TR>
    <TR>
      <TD>VCount</TD>
      <TD>Ｖカウンタ取得および変更</TD>
    </TR>
    <TR>
      <TD>ViewPort</TD>
      <TD>ビューポートの設定変更</TD>
    </TR>
    <TR>
      <TD>Window</TD>
      <TD>Ｈブランク期間中の操作によるウィンドウ変形</TD>
    </TR>
    <TR>
      <TD>Window_HDMA</TD>
      <TD>ＨブランクＤＭＡを使ってのウィンドウ変形</TD>
    </TR>
    <TR>
      <TD>DEMOLib</TD>
      <TD>共通処理</TD>
    </TR>
  </TBODY>
</TABLE>
<HR>
<H3><A name="note3-03" id="note3-03">Note 3-03: MIのファイル展開APIに対応する圧縮ツールの追加</A></H3>
<P>データ圧縮ツール ntrcomp を追加しました。<BR>
場所は $NitroSDK/build/tools/ntrcomp/ です。</P>
<HR>
<H3><A name="note3-04" id="note3-04">Note 3-04: NITRO-SDK と AGBSDK 両環境の共存についてのドキュメント追加</A></H3>
<P>NITRO-SDK と AGBSDK の両方をインストールして共存させる方法についてのドキュメントを
$NitroSDK/docs/HowToJoinAGBDevEnv.txt に追加しました。</P>
<HR>
<H3><A name="note3-05" id="note3-05">Note 3-05: OBJ と BG のバンク EFG の設定</A></H3>
<P>VRAMのバンク組み合わせの設定に, 80_EF, 80_EGのエントリを追加しました。<BR>
VRAMをEF, EGの組み合わせでBGまたはOBJに配置できるようしました。</P>
<P>また、SDKにてサポートされていない組み合わせでVRAMを配置したいという要求に対応するため、SDKのソース改編によるエントリの追加方法をドキュメンとしてまとめ$NitroSDK\docs\SDKHowTo/HowToMakeMyVRamBankType.txtに追加しました。</P>
<HR>
<H3><A name="note3-06" id="note3-06">Note 3-06: G3X_InitMtxStack() の問題の修正</A></H3>
<P>行列スタックの初期化の際、元の PROJECTION 行列のスタックレベルが0の場合に、スタックアンダーフローを起こしていました。<BR>
この不具合は修正されました。</P>
<HR>
<H3><A name="note3-07" id="note3-07">Note 3-07: man のジオメトリコマンドサイクルの一覧のリンク追加</A></H3>
<P>ジオメトリコマンドサイクルの一覧に、マニュアル左ウィンドウの3Dジオメトリ(G3*)から移れるようにリンクを張りました。</P>
<HR>
<H3><A name="note3-08" id="note3-08">Note 3-08: OS_Sleep() の作成</A></H3>
<P>指定の時間だけスレッドを休止させる関数 OS_Sleep() を追加しました。</P>
<HR>
<H3><A name="note3-09" id="note3-09">Note 3-09: スレッド切り替えに関する不具合修正</A></H3>
<P>IRQハンドラ内でスレッドを切り替える際に、スレッドリストの参照個所を間違い、本来起動すべきでないスレッドを起動することがありました。<BR>
この不具合は修正されました。</P>
<HR>
<H3><A name="note3-10" id="note3-10">Note 3-10: OS_ReadMessage() の作成</A></H3>
<P>メッセージキューの最初のメッセージを参照してコピーするだけの関数 OS_ReadMessage()
を作成しました。OS_ReadMessage() は、OS_ReceiveMessage() と違い、メッセージを送ろうとしてブロックされているスレッドを復帰させることはありません。また、メッセージキューの内容を変えることもありません。</P>
<HR>
<H3><A name="note3-11" id="note3-11">Note 3-11: IRQチェックフラグセットに関する修正</A></H3>
<P>IRQ割り込みのチェックフラグのセットで、タイマー割り込みの場合に誤ったビットにアクセスしてセットしていました。<BR>
この不具合は修正されました。</P>
<HR>
<H3><A name="note3-12" id="note3-12">Note 3-12: 複数のVカウントアラームに関する修正</A></H3>
<P>Vカウントアラームに、起動時間の近い複数の周期関数を登録した場合に最初の関数しか起動されない不具合を修正しました。<BR>
またこの修正に伴い、Vカウントアラーム周期関数の起動時間に遅延許容カウントを指定できるようになりました。</P>
<HR>
<H3><A name="note3-13" id="note3-13">Note 3-13: チックの不具合修正</A></H3>
<P>チックシステムに不具合があり、ある桁以上にカウントアップしないように なっていました。<BR>
この不具合は修正され、64ビットフルに値を取れるようにしました。</P>
<HR>
<H3><A name="note3-14" id="note3-14">Note 3-14: 時間とチックの変換マクロ追加</A></H3>
<P>秒、ミリ秒、マイクロ秒で指定された時間と、OS_Sleep() や OS_SetAlarm() で使用されるシステムクロックを元にしたチックカウント値との変換マクロを追加しました。<BR>
以下がそのマクロです。</P>
<P>OS_MicroSecondsToTicks( usec )<BR>
OS_MilliSecondsToTicks( msec )<BR>
OS_SecondsToTicks( sec )<BR>
OS_TicksToMicroSeconds( tick )<BR>

OS_TicksToMilliSeconds( tick )<BR>
OS_TicksToSeconds( tick )</P>
<HR>
<H3><A name="note3-15" id="note3-15">Note 3-15: タイマー割り込みコールバックからの復帰時の不具合修正</A></H3>
<P>OS_SetIrqFunction() でタイマー割り込みコールバックを設定し、タイマー割り込みを開始し、コールバックが呼び出されると、そこでタイマー割り込みを再設定してもコールバックから戻るときにクリアしていました。<BR>
この不具合は修正されました。</P>
<HR>
<H3><A name="note3-16" id="note3-16">Note 3-16: OS_DisableInterrupts() 等における FIQの扱いの変更</A></H3>
<P>OS_DisableInterrupts() で、IRQ、FIQの両方を停止していましたが、 デバッガとの兼ね合いのために
IRQ のみを停止するように変更しました。<BR>
但し ADバスのロック／アンロック、コンテキストスイッチ部分は IRQ と FIQ
の両方を停止させています。</P>
<HR>
<H3><A name="note3-17" id="note3-17">Note 3-17: デバッガの例外ハンドラ呼び出しに関する仕様変更</A></H3>
<P>ユーザの例外ハンドラを呼ぶ前に、あればデバッガの例外ハンドラを呼ぶように仕様を変更しました。</P>
<HR>
<H3><A name="note3-18" id="note3-18">Note 3-18: ARM7 のレジスタ名の変更</A></H3>
<P>reg_DISP_DISPSTAT、reg_DISP_VCOUNT レジスタは所属カテゴリをGX に移し、reg_GX_DISPSTAT、reg_GX_VCOUNTに改名しました。<BR>
reg_OS_POWCNT は所属カテゴリをSND に移し、reg_SND_POWCNT に改名しました。</P>
<HR>
<H3><A name="note3-19" id="note3-19">Note 3-19: レジスタ表の修正</A></H3>
<P>ARM9、ARM7 のレジスタ表 $NitroSDK/build/buildsetup/ioreg/io_reg_list*、$NitroSDK/build/buildsetup/ioreg_sp/io_reg_list*
が加筆修正され、ほぼ現仕様の全てを網羅したものになりました。これまでに無かった部分の追加分は主に
EXI、PXI カテゴリです。</P>
<HR>
<H3><A name="note3-20" id="note3-20">Note 3-20: マニュアルの修正</A></H3>
<P>リファレンスマニュアルの誤記をいくつか修正しています。 その中の一つ、MI_SetWRAMBank()
という表記は MI_SetWramBank() が正しいものです。 修正に伴い、MI_SetWramBank()
のマニュアルの html ファイルを MI_SetWRAMBank.html から MI_SetWramBank.html
に変更していますのでご注意下さい。</P>
<HR>
<H3><A name="note3-21" id="note3-21">Note 3-21: IRQテーブルの修正</A></H3>
<P>OS内部のことになりますが、IRQハンドラのテーブルに誤りがありました。IEレジスタの各ビットに割り当てられている割り込み要因は、すべてのビットが順番にならんでいるわけでなく未使用の個所もあります。それを考慮せずテーブルを作成していたので、未使用の個所以降の割り込みがテーブルを参照する際にずれた個所をアクセスしていました。これを修正しました。<BR>
なお、未使用の個所もテーブルの一要因に割り当てたため、ARM9で2つ、ARM7で3つの配列要素が増えて使用メモリが微増しました。</P>
<HR>
<H3><A name="KnownIssues_1_00_pr2" id="KnownIssues_1_00_pr2">NITRO-SDK Ver 1.0 PR2 の既知の問題点</A></H3>
<UL>
  <LI>ROM ファイルシステム関数、オーバーレイはさらに持ち越しとなります。
</UL>
<HR>
<H2 style="line-height: 0"><A name="sdk_1_00_pr1" id="sdk_1_00_pr1">■ NITRO-SDK Ver 1.0 PR1</A></H2>
<DIV style="text-align: right">
<P style="line-height: 0">(2004/2/27)</P>
</DIV>
<HR>
<H3><A name="note2-01" id="note2-01">Note 2-01: NITRO-SDK への改称</A></H3>
<P>irisSDK を NITRO ハードウェアに対応させました。同時に SDK 名称を NITRO-SDK
と改めました。<BR>
この改称により NITRO-SDK には irisSDK から以下のような変更が行なわれております。ご注意ください。</P>
<OL>
  <LI><CODE>iris.h</CODE> の <CODE>nitro.h</CODE> への変更。
  <LI>ディレクトリ <CODE>include/iris</CODE> の <CODE>include/nitro</CODE> への変更。
  <LI>メイン関数 <CODE>IrisMain</CODE> が <CODE>NitroMain</CODE> に変更。
  <LI>環境変数 <CODE>IRISSDK_ROOT</CODE> の<CODE> NITROSDK_ROOT</CODE> への変更。
  <LI>コンパイルスイッチ <CODE>IRIS_DEBUG</CODE> のように <CODE>IRIS_</CODE>で始まるスイッチの <CODE>NITRO_DEBUG</CODE> などへの変更。
  <LI>ドキュメント類で使用されている IRIS という語句を NITRO へ変更。
  <LI>IDE における NITRO 用の PostLinker として $NitroSDK/tools/elftobin/NitroPostLinker.bat
  を用意。
</OL>
<HR>
<H3><A name="note2-02" id="note2-02">Note 2-02: ソースのプロセッサ別の分類</A></H3>
<P>ライブラリのソースファイル、ヘッダファイルの一部をプロセッサ別に分類し、それそれ
ARM9/ARM7/common というサブディレクトリに格納しました。</P>
<P>このため今まで OS などのヘッダファイルのインクルード時に iris.h や os.h
を通さず直接 #include &lt;iris/os/alloc.h&gt; と指定されていた方は #include
&lt;nitro/os/common/alloc.h&gt; という修正が必要となります。</P>
<HR>
<H3><A name="note2-03" id="note2-03">Note 2-03: サブ LCD 対応 API およびデモの追加</A></H3>
<P>サブ LCD 対応の API (GXS 関数群) を用意しました。 またその API を使用したデモプログラムも追加されています。
$NitroSDK/build/demos/gx/UnitTours 以下の Sub_ で始まるディレクトリをご参照
ください。</P>
<HR>
<H3><A name="note2-04" id="note2-04">Note 2-04: ELF ファイルの拡張子の変更</A></H3>
<P>ELF ファイルの拡張子を .nef に変更しました。 NITRO 開発関連ツールも .nef
への対応が予定されています。</P>
<HR>
<H3><A name="note2-05" id="note2-05">Note 2-05: サンプルコードのディレクトリの移動および自動テスト用コードの追加</A></H3>
<P>サンプルコードが収録されているディレクトリを $NitroSDK/build/tests から
$NitroSDK/build/demos に変更しました。</P>
<P>また SDK ライブラリのテスト処理のため、いくつかのファイルで自動テスト制御用のコードが埋め込まれました。具体的には#ifdef
SDK_AUTOTEST 〜 #endif で囲まれた部分です。これは弊社内部で使用する部分ですので、サンプルコードをコピーしてご使用される場合は、削除していただいて結構です。</P>
<HR>
<H3><A name="note2-06" id="note2-06">Note 2-06: SDK の Thumb コードコンパイル</A></H3>
<P>Thumb コード版のライブラリが生成ができるようになりました。 make コマンド起動時の変数または環境変数の
NITRO_CODEGEN で切り替えます。</P>
<P>コマンド例</P>
<TABLE border="0">
  <TBODY>
    <TR>
      <TD>THUMB 版コードの生成</TD>
      <TD></TD>
      <TD><CODE>make NITRO_CODEGEN=THUMB</CODE></TD>
    </TR>
    <TR>
      <TD>ARM 版コードの生成</TD>
      <TD></TD>
      <TD><CODE>make NITRO_CODEGEN=ARM</CODE></TD>
    </TR>
  </TBODY>
</TABLE>
<P>NITRO_CODEGEN を省略すると現在 ARM コード版のライブラリを生成します。</P>
<HR>
<H3><A name="note2-07" id="note2-07">Note 2-07: 関数単位で ARM コード/ Thumb コード生成の切替手段の提供</A></H3>
<P>関数毎に ARM コード/ Thumb コードの生成を切り替え、また初期設定に戻すためのインクルードファイルを用意しました。</P>
<TABLE border="0">
  <TBODY>
    <TR>
      <TD>ARM コード生成を指示</TD>
      <TD></TD>
      <TD><CODE>$NitroSDK/include/nitro/code32.h</CODE></TD>
    </TR>
    <TR>
      <TD>Thumb コード生成を指示</TD>
      <TD></TD>
      <TD><CODE>$NitroSDK/include/nitro/code16.h</CODE></TD>
    </TR>
    <TR>
      <TD>初期指定に戻す</TD>
      <TD></TD>
      <TD><CODE>$NitroSDK/include/nitro/codereset.h</CODE></TD>
    </TR>
  </TBODY>
</TABLE>
<P>(例)<BR>
関数 void A(void) を Thumb コードで生成するように指定する場合</P>
<PRE><CODE>#include &lt;nitro/code16.h&gt;
void A(void)
{
      ....
}
#include &lt;nitro/code32.h&gt;</CODE></PRE>
<P>CodeWarrior においては pragma で出力コードを直接変更できますが、コンパイラ毎の違いなどを本ファイルでなるべく吸収する方針としておりますので、これらのご使用をお勧めいたします。</P>
<HR>
<H3><A name="note2-08" id="note2-08">Note 2-08: SDK ライブラリでの C++ サポート</A></H3>
<P>C++ でのコード作成をサポートするために以下を追加および修正しました。</P>
<UL>
  <LI>NitroMain() を呼び出す前に NitroStartUp() 関数とスタティックコンストラクタを呼び出す処理を追加
  <LI>C++ での使用に不具合のあったヘッダファイルの修正
  <LI>C++ サンプルコードの収録 ($Nitro/build/demos/os/cplusplus-1)
</UL>
アプリケーション側で NitroStartUp() 関数を用意されていた場合、SDK は NitroStartUp()
関数をスタティックコンストラクタ処理前に呼び出します。 この NitroStartUp()
内でメモリ管理機構の初期化処理を行なうことにより、スタティックコンストラクタ処理内で
new() 関数を使用することができます。
<HR>
<H3><A name="note2-09" id="note2-09">Note 2-09: X,Y ボタンのサポート</A></H3>
<P>PAD_Read() 関数において X, Y ボタンの読み取りをサポートしました。</P>
<P>ハードウェアの仕様上、X, Y ボタン入力による割り込み発生(PAD_SetIrq() 参照)がサポートされていないことにご注意ください。</P>
<HR>
<H3><A name="note2-10" id="note2-10">Note 2-10: make 関連ファイルに関する修正</A></H3>
<P>make 関連ファイル($NitroSDK/build/buildtools の commondefs, modulerules
など) を修正しました。</P>
<P>これにより以下が実装、修正されました。</P>
<UL>
  <LI>ソースファイルの依存情報ファイルの出力とその参照処理の実装
  <LI>make -f オプション使用時にうまく動作しなかった点の修正
  <LI>大量のソースファイルを SRCS に指定したときに make が起動しない点の修正
</UL>
<HR>
<H3><A name="note2-11" id="note2-11">Note 2-11: マクロの複文表記の修正</A></H3>
<P>マクロ定義で、複文 (中カッコで複数の文が囲まれているだけのもの) の記述をなくしました。</P>
<HR>
<H3><A name="note2-12" id="note2-12">Note 2-12: ヘッダファイル内のインラインアセンブラ関数を C ソースへ移動</A></H3>
<P>ARM/Thumb コード出力の切り替えにおいて不都合となるため ヘッダファイル内でのインラインアセンブラ関数
(static inline asm による) を C ソース内に移動させました。</P>
<HR>
<H3><A name="note2-13" id="note2-13">Note 2-13: マクロ CODEGEN_PROC を NITRO_PROC へ名称変更</A></H3>
<P>ARM9/ARM7 用の出力コードの切り替えに使用する、Makefile 内のマクロ変数 CODEGEN_PROC
を NITRO_PROC へ名称変更いたしました。</P>
<HR>
<H3><A name="note2-14" id="note2-14">Note 2-14: elftobin での結合用 ARM7 バイナリの変更</A></H3>
<P>バイナリファイル作成時にデフォルトで ARM9 用実行ファイルと結合する ARM7
用実行ファイルを新規に作成しました。これには、X,Y ボタンの読み取り処理が含まれます。ファイル本体は
$NitroSDK/build/components/idle/ARM7 以下に収録されています。</P>
<P>以前の SDK に含まれる ARM7 用実行ファイルと本リリースの SDK によって作成された
ARM9 実行ファイルとを結合すると PAD_Read() 関数が正常に動作しません。ARM7
の実行ファイルを Makefile で明示的に指定しておられる方はこの点にご注意ください。</P>
<HR>
<H3><A name="note2-15" id="note2-15">Note 2-15: IRQ スタックサイズ設定機構の追加</A></H3>
<P>IRQスタックのサイズをLCFファイルに記述することで設定出来るようにしました。</P>
<HR>
<H3><A name="note2-16" id="note2-16">Note 2-16: 例外発生時のコンテキスト表示機構の追加</A></H3>
<P>例外発生時(IRQ例外、FIQ例外、SWI例外を除く)に、例外発生時点のコンテキストを表示する機能を追加しました。また、ユーザのコールバックルーチンも呼ばせることが出来ます。</P>
<HR>
<H3><A name="note2-17" id="note2-17">Note 2-17: MI_Dma*Async() での NULL コールバック設定時の不具合修正</A></H3>
<P>コールバックとして NULL が指定された場合、コールバックをセットせず進むよう
にしました。バスのアクセス競合によるストールが発生しない場合、DMA コマンドを
送信後、ウェイトせずに関数から戻ります。</P>
<HR>
<H3><A name="note2-18" id="note2-18">Note 2-18: TCM 領域にかかる DMA の警告の追加</A></H3>
<P>ITCM 及び DTCMを含む領域を DMA の転送先及び転送元に指定したときに、 DEBUG
ライブラリでは警告を出すようにしました。</P>
<HR>
<H3><A name="note2-19" id="note2-19">Note 2-19: 起動時のメモリクリア処理の追加</A></H3>
<P>crt0.c 内で、DTCM をクリアするようにしました。 これによって、スタック領域がクリアされるようになりました。
また、BG/OBJパレット、OAMもクリアするようにしました。</P>
<HR>
<H3><A name="note2-20" id="note2-20">Note 2-20: キャッシュ関連の関数の引数のアドレス丸め</A></H3>
<P>DC_StoreRange(), DC_FlushRange(), DC_TouchRange(), IC_InvalidateRange()
で、 開始アドレスの下位方向への32バイト境界丸めが実装されていませんでした。
これを実装しました。</P>
<HR>
<H3><A name="note2-21" id="note2-21">Note 2-21: OS_CreateThread() の引数追加、スレッド優先制御の自由度向上</A></H3>
<P>スレッド機構に関して以下の変更を加えました。</P>
<UL>
  <LI>OS_CreateThread() に引数が追加され、実行開始関数に引数を渡すことができるようになりました。
  <LI>スレッドの優先度が 0 〜 31 で指定できるようになりました。これに伴い、OS_InitThread()
  を呼び出した直後のスレッドの優先度を 16 に変更しました。
  <LI>スレッド優先度を取得、変更する API (OS_SetThreadPriority(),OS_GetThreadPriority())
  を実装しました。
</UL>
<HR>
<H3><A name="note2-22" id="note2-22">Note 2-22: スレッドのスタック溢れのチェック機構のサポート</A></H3>
<P>スレッドにおけるスタック溢れをチェックする関数 OS_CheckStack() を用意しま
した。</P>
<HR>
<H3><A name="note2-23" id="note2-23">Note 2-23: アラームおよび 64bit 計時カウンタの実装</A></H3>
<P>16 bit タイマーを 2 つ使用することで、64 bit 値をもつ時刻カウンタと、 指定時刻にコールバック関数を呼び出すアラーム機構を実装しました。
これはタイマー割り込みを多重化させることで、ハードウェアのタイマーの数より
も多いコールバック関数を登録できます。 これらの機能はオプションとなっており、使用する使用しないを選択することができ
ます。</P>
<HR>
<H3><A name="note2-24" id="note2-24">Note 2-24: V カウントアラームの実装</A></H3>
<P>V カウント割り込みを多重化し複数のコールバック関数を登録できるようになり
ました。詳しくは OS の V カウント関連関数のリファレンスマニュアルをご覧く
ださい。</P>
<HR>
<H3><A name="note2-25" id="note2-25">Note 2-25: MI_DmaSend*() , MI_CpuSend*() の追加</A></H3>
<P>MI_DmaSend*, MI_CpuSend* API が追加されました。</P>
<HR>
<H3><A name="note2-26" id="note2-26">Note 2-26: OS_StartTimer*() のアサート判定の修正</A></H3>
<P>DEBUG 版ライブラリにおいて OS_StartTimer32() の id に OS_TIMER32_23 また
OS_StartTimer48() における id にOS_TIMER48_123 を設定するとアサートが発生して
いたのを修正しました。</P>
<HR>
<H3><A name="note2-27" id="note2-27">Note 2-27: CPU メモリ関数の追加</A></H3>
<P>メモリインターフェイスに MI_CpuClear() 等の DMA ではなく CPU によるメモリ操作関数を用意し、
UTL ライブラリを廃止しました。</P>
<HR>
<H3><A name="note2-28" id="note2-28">Note 2-28: TEG ボードの VBLANK 中のメインバスへのアクセスに伴うハードバグ対策</A></H3>
<P>TEG ボードにおいて、VBLANK 期間の初期にメインプロセッサのバスへ特定パターンのデータが出力されたときにポリゴンの表示が乱れるというハードウェアバグがあります。
この対策をライブラリ内で行ないました。</P>
<P>実際の対処コードは GX_Init() に埋め込まれています。対策の詳細は、$NitroSDK/build/libraries/gx/src/gx.c
の #ifdef SDK_TEG_WA_VBLANK 〜 #endif で囲まれた部分を参照してください。</P>
<P>またこの対処コードは V カウントアラームを使用していますので、この処理を有効にしておきたい場合は
V カウントアラームを停止しないでください。</P>
<HR>
<H3><A name="note2-29" id="note2-29">Note 2-29: Light パラメータの調整</A></H3>
<P>Light 処理を行なうデモにおいて、ライトカラーなどのパラメータの総和が かなり大きく、適切な値ではありませんでした。このため、ポリゴン面が少しでも
ライトの方向を向いただけで、ライトの強さが MAX値になっていました。 これを調整しました。</P>
<P>また DEMOLib においてスペキュラライトに関するパラメータテーブルの定義を見直し、コサインの
n 乗を近似するようにしました。gx/UnitTours/3D_Shininess デモでパラメータテーブルの違いによる変化を見ることができます。</P>
<HR>
<H3><A name="note2-30" id="note2-30">Note 2-30: 動的 DL 作成関数群のオーバーフローチェックの実装</A></H3>
<P>動的 DL 作成関数 G3* に DL バッファオーバーフローチェックが追加されました。
これは DEBUG 版のライブラリをリンクした場合のみ有効になります。</P>
<HR>
<H3><A name="note2-31" id="note2-31">Note 2-31: G3_Ortho() のバグ修正</A></H3>
<P>G3_Ortho() の実装誤りが修正されました。</P>
<HR>
<H3><A name="note2-32" id="note2-32">Note 2-32: G3_EndMakeDL() が正しいサイズを返さないバグの修正</A></H3>
<P>G3_EndMakeDL() が正しいサイズを返さないバグがありました。 これを修正しました。</P>
<HR>
<H3><A name="note2-33" id="note2-33">Note 2-33: G2_SetBG*Control256x16Pltt() の引数の追加</A></H3>
<P>G2_SetBG*Control256x16Pltt() にキャラクタベースブロックを指定するための引数を追加しました。</P>
<HR>
<H3><A name="note2-34" id="note2-34">Note 2-34: G3CS_LoadTexMtxEnv(), G3CS_LoadTexMtxTexCoord() の不具合修正</A></H3>
<P>G3CS_LoadTexMtxEnv(), G3CS_LoadTexMtxTexCoord() で生成されるディスプレイリストに問題がありました。これを修正しました。</P>
<HR>
<H3><A name="note2-35" id="note2-35">Note 2-35: 追加された半透明テクスチャの API サポート</A></H3>
<P>A3I5 テクスチャを API に対応させました。このテクスチャが実際に表示できるかどうかはエミュレータの仕様をご確認ください。</P>
<HR>
<H3><A name="note2-36" id="note2-36">Note 2-36: VecFx16 型と関連 API のサポート</A></H3>
<P>Fx16 を要素とする 3D のベクトル型 VecFx16 をサポートし、それを取扱う算術関数
VEC_Fx16* シリーズを用意しました。</P>
<HR>
<H3><A name="note2-37" id="note2-37">Note 2-37: DEMO ライブラリのヘッダファイルに C のリンケージ指定追加</A></H3>
<P>$NitroSDK/build/demos/gx/UnitTours/DEMOLib のヘッダファイルに C のリンケージ指定である
extern &quot;C&quot; { の記述を追加しました。</P>
<P>この DEMO ライブラリは UnitTours の実装を簡単にするということを主眼において作成されています。このため仕様の変更についてご要望に副えない場合があります。非常に申し訳ございませんが、この
DEMOLib をアプリケーションでご使用になられる場合は、その点ご了承ください。</P>
<HR>
<H3><A name="KnownIssues_1_00" id="KnownIssues_1_00">SDK 1.0 での既知の問題点</A></H3>
<UL>
  <LI>ROM ファイルシステム関数、オーバーレイの実装が持ち越しになりました。
</UL>
<HR>
<H2 style="line-height: 0"><A name="20040120p1" id="20040120p1">■2004年1月20日 irisSDK snapshot patch1</A></H2>
<DIV style="text-align: right">
<P style="line-height: 0">(2004/2/4)</P>
</DIV>
<HR>
<H3><A name="note1-01" id="note1-01">Note 1-01: 3D 関連の test コードの実行速度が遅いことの修正</A></H3>
<P>メインループ内における</P>
<P><CODE>SVC_WaitVBlankIntr();<BR>
G3_SwapBuffers(GX_SORTMODE_AUTO, GX_BUFFERMODE_W);</CODE></P>
<P>上記の API の出現位置が逆になっており、必要のない V-BLANK 待ちが発生していました。入れ替えると問題は解消されます。</P>
<P>問題が発生する 3D グラフィクスの test コードは、修正されました。</P>
<HR>
<H3><A name="note1-02" id="note1-02">Note 1-02: VEC Mag のオーバーフロー対策</A></H3>
<P>VEC_Magに大きなベクトルを入れたときに内部計算でオーバーフローが発生し、結果がおかしくなります。</P>
<P>上記バグは、修正されました。</P>
<HR>
<H3><A name="note1-03" id="note1-03">Note 1-03: MTX_Concat43() の修正</A></H3>
<P>fx_mtx43.c において行列 b の平行移動要素が無視されてしまいます。</P>
<P>上記バグは、修正されました。</P>
<HR>
<H3><A name="note1-04" id="note1-04">Note 1-04: G2_SetBGxControl() 系の関数の定義修正</A></H3>
<P>G2ライブラリの G2_SetBGxControl() 系の関数内での設定が正しくありません。</P>
<P>上記バグは、修正されました。</P>
<HR>
<H3><A name="note1-05" id="note1-05">Note 1-05: MTX_Inverse43() の平行移動計算の修正</A></H3>
<P>MTX_Inverse43() において、得られた逆行列の平行移動成分に誤りがありました。</P>
<P>上記バグは、修正されました。</P>
<HR>
<H3><A name="note1-06" id="note1-06">Note 1-06: GX_SetOBJVRamModeBmp() の定義修正</A></H3>
<P>GX_SetOBJVRamModeBmp() の定義誤りがありました。</P>
<P>修正されました。</P>
<HR>
<H3><A name="note1-07" id="note1-07">Note 1-07: バイトアクセス対策版ライブラリへの対応</A></H3>
<P>IDE サンプルプロジェクトファイルでバイトアクセス対策版ライブラリへの対応ができていませんでした。これと同じくコマンドライン環境で使用していたライブラリもバイトアクセス版へ完全に移行させました。</P>
<P>IDE のサンプルプロジェクトファイルを修正版と差し替えました。</P>
<HR>
<H3><A name="note1-08" id="note1-08">Note 1-08: G2_SetBG3Priority() の定義修正</A></H3>
<P>G2_SetBG3Priority の定義誤りがありました。</P>
<P>上記バグは、修正されました。</P>
<HR>
<H3><A name="note1-09" id="note1-09">Note 1-09: マクロ GX_FX16PAIR の定義修正</A></H3>
<P>g3.h のマクロ GX_FX16PAIR で符号拡張の取り扱いに問題がありました。このマクロは
SDK の他の個所では使用されていなかったのでSDK自体には影響がありません。</P>
<P>上記バグは、修正されました。</P>
<HR>
<H3><A name="note1-10" id="note1-10">Note 1-10: パッケージ収録のライブラリファイルの IS_IRIS_EMULATOR 対応</A></H3>
<P>パッケージにはビルド済みのライブラリファイルが収録されていますが、そのライブラリの
libos.a をそのまま使うと OS_Printf で IS-IRIS-EMULATOR への出力を行いませんでした。IS-IRIS-EMULATOR
インストール済みの環境でライブラリを再ビルドされるとこの問題は解消します。</P>
<P>パッチに修正されたライブラリファイルを収録しました。</P>
<HR>
<H3><A name="note1-11" id="note1-11">Note 1-11: ARM7 版の libstubsisd.a ファイルの追加収録</A></H3>
<P>ARM7 側のプログラムをリンクする時、環境変数“IS_IRIS_DIR”が定義されていない場合は、libstubsisd.a
をリンクしようとしますが、このファイルが無いためエラーとなります。</P>
<P>ARM7 版 libstubsisd.a ファイルとそのソースファイルを追加収録しました。</P>
<HR>
<H3><A name="note1-12" id="note1-12">Note 1-12: システム予約領域のサイズの定義修正</A></H3>
<P>システム予約領域のサイズが、新しい BOOT ROM では変更(32bytes-&gt;64bytes)になっていることに対応していませんでした。</P>
<P>上記バグは、修正されました。 これに伴いシステムモードのスタック領域の大きさも
32bytes 小さくなっています。</P>
<HR>
<H3><A name="note1-13" id="note1-13">Note 1-13: GX サンプルプログラムにおける G3_LightVector() 設定のコマンド位置の修正</A></H3>
<P>G3_LightVector コマンドは発行直後に方向ベクトル行列による座標変換を行うので、G3_LightVector()
は、カメラ行列の設定後に処理されなければなりません。</P>
<P>G3_LightVectorを使う全てのサンプルが修正されました。</P>
<HR>
<H3><A name="note1-14" id="note1-14">Note 1-14: MI_DmaCopy16Async でコールバックが呼ばれない不具合の修正</A></H3>
<P>MI_DmaCopy16ASync() は内部でDMA終了割り込みを発生させておらずコールバックが呼ばれませんでした。</P>
<P>上記バグは、修正されました。</P>
<HR>
<H3><A name="20040120p1_KnownIssues" id="20040120p1_KnownIssues">snapshot 20040120+Path1 の既知の問題点</A></H3>
(次回以降のリリースで修正される予定です)
<OL>
  <LI>Light 処理を行なう test コードにおいて、ライトカラーなどのパラメータが適切な値でない。このため、ポリゴン面が少しでもライトの方向を向いただけで、ライトの強さが
  MAX 値になる。
  <LI>G2_SetBG*Control256x16Pltt() においてキャラクタベースブロックの指定する方法がない。
  <LI>DEBUG 版ライブラリにおいて OS_StartTimer32 の id に OS_TIMER32_23 また
  OS_StartTimer48() において id に OS_TIMER48_123 を設定するとアサートが発生する。
</OL>
<HR>
<P style="text-align: right">NINTENDO Technical Support Center</P>
</BODY>
</HTML>